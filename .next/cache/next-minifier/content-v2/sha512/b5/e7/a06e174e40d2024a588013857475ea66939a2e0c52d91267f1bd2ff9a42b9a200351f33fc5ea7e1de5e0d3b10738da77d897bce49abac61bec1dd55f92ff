{"code":"_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[31],{D85t:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/projects\",function(){return a(\"RHEb\")}])},QX5T:function(e,t,a){\"use strict\";var l=a(\"q1tI\"),n=a.n(l),o=a(\"vOnD\"),i=a(\"VX74\"),r=a(\"7Cbv\"),c=a(\"8CDE\"),s=a(\"ZwIX\"),d=a(\"wZgm\"),u=a(\"auMy\"),m=a(\"QclZ\");const E=({callbackOnTop:e,callbackOnBottom:t,offset:a=50})=>{const[n,o]=Object(l.useState)(0);Object(l.useEffect)((()=>{const l=document.documentElement,i=()=>{if(!l)return;const i=l.scrollTop-n;t&&i>0&&l.scrollTop+l.clientHeight>=l.scrollHeight-a&&t(l.scrollTop,l.scrollHeight),e&&i<0&&l.scrollTop<=a&&e(l.scrollTop,l.scrollHeight),o(l.scrollTop)};return l&&window.addEventListener(\"scroll\",i),()=>{l&&window.removeEventListener(\"scroll\",i)}}),[e,t,a])};var p=a(\"X+Rt\"),f=a(\"p9yE\"),b=a(\"RoTl\"),v=a(\"EYtC\"),h=a(\"coMr\"),j=a(\"586Q\");const O=Object(o.c)(c.a).withConfig({displayName:\"content__Wrap\",componentId:\"sc-1afm75p-0\"})([\"margin-top:120px;margin-bottom:80px;\",\" @media only screen and (max-width:480px){margin-top:0;}\"],(({clear:e})=>e&&Object(o.b)([\"margin:0;\"])));t.a=({title:e,store:t,query:a,handle:o,filters:c,options:g,research:y,scaffold:w,dashboard:_,variables:C={},limit:T=6,startOffset:S=6,initialize:P,children:k})=>{const D=_?f.a:p.a,[R,x]=Object(l.useState)(),[A,L]=Object(l.useState)(),[I,N]=Object(l.useState)(null),[q,Q]=Object(l.useState)(!1),[X,F]=Object(l.useState)(!1),[H,J]=Object(l.useState)(S),[M,G]=Object(l.useState)((null===t||void 0===t?void 0:t.documents)||[]),[U,{data:V,loading:z,error:B,refetch:K}]=Object(i.useLazyQuery)(a),[W,{data:Z,loading:Y,error:$,refetch:ee}]=Object(i.useLazyQuery)(a),te=e=>{if(G([]),e)N(e),U({variables:{...C,search:e,offset:0,limit:S}});else{const e={...C,offset:0,limit:T};N(null),ee?ee(e):W({variables:e})}J(0)};return E({callbackOnBottom:async()=>{if(!Y&&!q){Q(!0);const e={...C,offset:H,limit:T};I?await K(C):ee?(await ee(e),J((e=>e+T))):await W({variables:e}),Q(!1)}},offset:850}),Object(l.useEffect)((()=>{P&&W({variables:{offset:H,limit:T}})}),[P]),Object(l.useEffect)((()=>{y&&te(y)}),[y]),Object(l.useEffect)((()=>{const e=!I&&!Y&&Z||I&&!z&&V;e&&G((t=>[...t,...e[Object.keys(e)[0]]]))}),[I,Y,z,Z,V]),n.a.createElement(D,{title:e,scaffold:w},n.a.createElement(O,{clear:w||_},!w&&!_&&n.a.createElement(v.a,{onChangeFilter:()=>F(!X),onSubmit:te}),_&&o&&n.a.createElement(h.a,{title:e,icon:o.icon,buttonCreateText:o.buttonCreateText,onCreate:o.onCreate,onChangeVisibleFilter:()=>F(!X),onChangeDisplayMethod:o.onChangeDisplayMethod}),(c||g)&&n.a.createElement(b.a,{isOpen:X,filters:c.map((e=>{switch(e.type){case\"DATEPICKER\":return n.a.createElement(d.a,{key:Object(r.a)(),value:R,placeholder:e.placeholder||\"\\u0414\\u0430\\u0442\\u0430 \\u043f\\u0443\\u0431\\u043b\\u0438\\u043a\\u0430\\u0446\\u0438\\u0438\",onChange:x,withNavigate:!0});case\"SELECT\":return n.a.createElement(m.a,{key:Object(r.a)(),options:e.options,placeholder:e.placeholder||\"\\u0420\\u0430\\u0437\\u0434\\u0435\\u043b\",selected:A,onChange:e=>L(e)});default:return null}})),options:g}),n.a.createElement(k,{documents:M}),I&&!z&&0===M.length&&n.a.createElement(s.a,{style:{width:\"100%\",textAlign:\"center\"}},\"\\u041f\\u043e \\u0432\\u0430\\u0448\\u0435\\u043c\\u0443 \\u0437\\u0430\\u043f\\u0440\\u043e\\u0441\\u0443 \\u043d\\u0438\\u0447\\u0435\\u0433\\u043e \\u043d\\u0435 \\u043d\\u0430\\u0439\\u0434\\u0435\\u043d\\u043e\"),(I&&B||!I&&$)&&n.a.createElement(s.a,{appearance:\"error\",style:{width:\"100%\",textAlign:\"center\"}},\"\\u041d\\u0435 \\u0443\\u0434\\u0430\\u043b\\u043e\\u0441\\u044c \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044c \\u0434\\u0430\\u043d\\u043d\\u044b\\u0435\"),(q||!$&&Y||I&&!B&&z)&&n.a.createElement(j.d,null,n.a.createElement(u.a,null)),!I&&!Y&&!z&&!B&&0===M.length&&n.a.createElement(s.a,{style:{width:\"100%\",textAlign:\"center\"}},\"\\u0414\\u0430\\u043d\\u043d\\u044b\\u0445 \\u043d\\u0435\\u0442\")))}},RHEb:function(e,t,a){\"use strict\";a.r(t),a.d(t,\"__N_SSP\",(function(){return u}));var l=a(\"q1tI\"),n=a.n(l),o=a(\"20a2\"),i=a(\"NWnW\"),r=a(\"QX5T\"),c=a(\"586Q\"),s=a(\"qF4B\"),d=a(\"u2Cb\");var u=!0;t.default=({store:e})=>{const t=Object(o.useRouter)();return n.a.createElement(r.a,{title:\"\\u041f\\u0440\\u043e\\u0435\\u043a\\u0442\\u044b\",filters:[{type:\"DATEPICKER\"},{type:\"SELECT\",options:null===e||void 0===e?void 0:e.categories.map((e=>({value:e.id,label:Object(i.d)(e.name)})))}],options:[{label:\"\\u041a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u044f\",value:\"company\"},{label:\"\\u0423\\u0447\\u0430\\u0441\\u0442\\u043d\\u0438\\u043a\\u0438\",value:\"members\"},{label:\"\\u0414\\u0430\\u0442\\u0430 \\u043f\\u0443\\u0431\\u043b\\u0438\\u043a\\u0430\\u0446\\u0438\\u0438\",value:\"createdAt\"}],query:d.a.GET_PROJECTS,variables:{category:t.query.category,status:\"PUBLISHED\"},store:{documents:null===e||void 0===e?void 0:e.projects}},(({documents:e})=>n.a.createElement(c.b,null,n.a.createElement(s.a,{initialList:e,layout:!0}))))}},qF4B:function(e,t,a){\"use strict\";var l=a(\"q1tI\"),n=a.n(l),o=a(\"vOnD\"),i=a(\"VX74\"),r=a(\"/MKj\"),c=a(\"ZwIX\"),s=a(\"auMy\"),d=a(\"586Q\"),u=a(\"VP1n\"),m=a(\"1zqG\"),E=a(\"ApjV\"),p=a(\"lphG\"),f=a(\"8ihE\"),b=a(\"rP4V\"),v=a(\"IxyI\"),h=a(\"u2Cb\");const j=o.c.div.withConfig({displayName:\"ProjectList__Wrap\",componentId:\"zcwfmw-0\"})([\"display:grid;grid-template-columns:repeat(auto-fit,minmax(442px,1fr));grid-gap:var(--default-gap);grid-auto-rows:max-content;@media only screen and (max-width:768px){grid-template-columns:repeat(auto-fit,minmax(285px,1fr));}\"]);t.a=({variables:e,layout:t,initialList:a})=>{const o=Object(E.b)(),O=Object(p.a)(),g=Object(r.c)((e=>e.user)),[y,w]=Object(l.useState)(a||[]),_=Object(r.b)(),{data:C,loading:T,error:S}=a?{data:null,loading:!1,error:!1}:Object(i.useQuery)(h.a.GET_PROJECTS,{variables:e});return Object(l.useEffect)((()=>{!T&&C&&w(C.getProjects)}),[C,T]),Object(l.useEffect)((()=>{(null===a||void 0===a?void 0:a.length)>0&&w(a)}),[a]),n.a.createElement(j,null,!T&&C||y.length>0?y.map((e=>{var a,l,i;const r=null===g||void 0===g||null===(a=g.projects)||void 0===a?void 0:a.find((t=>t.id===e.id));return n.a.createElement(u.a,{key:e.id},n.a.createElement(m.c,{project:e,layout:t||\"column\",owned:r,added:!(null===g||void 0===g||null===(l=g.folders)||void 0===l||!l.find((t=>!(null===t||void 0===t||!t.projects.find((t=>t.id===e.id)))))),liked:!!((null===g||void 0===g?void 0:g.likedProjects)||[]).find((t=>t.id===e.id)),onLink:o(v.e,{id:e.id,auth:null===g||void 0===g?void 0:g.email,liked:!!((null===g||void 0===g?void 0:g.likedProjects)||[]).find((t=>t.id===e.id)),onLike:g.email&&O(h.a.LIKE_PROJECT,{id:e.id},(e=>_(Object(f.e)(e.data.likeProject)))),onAdd:g.email&&o(v.a,{id:e.id,folders:null===g||void 0===g?void 0:g.folders,mutations:{addProject:h.a.ADD_USER_PROJECT,createFolder:h.a.ADD_USER_FOLDER}}),owned:r}),onLike:g.email&&O(h.a.LIKE_PROJECT,{id:e.id},(e=>_(Object(f.e)(e.data.likeProject)))),onAdd:g.email&&o(v.a,{id:e.id,folders:null===g||void 0===g?void 0:g.folders,mutations:{addProject:h.a.ADD_USER_PROJECT,createFolder:h.a.ADD_USER_FOLDER}}),onAboutMore:o(b.a,{user:e}),onCompanyLink:o(b.i,{id:null===(i=e.company)||void 0===i?void 0:i.email,auth:null===g||void 0===g?void 0:g.email,recipient:e.author,query:h.a.GET_USER_CHATS,mutation:h.a.SEND_MESSAGE}),onScreenshotClick:(t,a)=>o(v.f,{screenshots:[e.preview,...e.screenshots],key:a})()}))})):S?n.a.createElement(c.a,{appearance:\"error\",style:{width:\"100%\",textAlign:\"center\"}},\"\\u041d\\u0435 \\u0443\\u0434\\u0430\\u043b\\u043e\\u0441\\u044c \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044c \\u0434\\u0430\\u043d\\u043d\\u044b\\u0435\"):T?n.a.createElement(d.c,null,n.a.createElement(s.a,null)):n.a.createElement(c.a,{style:{width:\"100%\",textAlign:\"center\"}},\"\\u041f\\u0440\\u043e\\u0435\\u043a\\u0442\\u043e\\u0432 \\u043d\\u0435\\u0442\"))}}},[[\"D85t\",0,2,1,3,4,5,6,7]]]);","map":{"version":3,"sources":["static/chunks/pages/projects-5a0b7519ca19fed3a177.js"],"names":["_N_E","window","push","D85t","module","exports","__webpack_require__","__NEXT_P","QX5T","__webpack_exports__","react","react_default","n","styled_components_browser_esm","client","v4","Column","Alert","DatePicker","Spinner","Select","useInfiniteScroll","callbackOnTop","callbackOnBottom","offset","lastScrollTop","setLastScrollTop","Object","scrollElement","document","documentElement","onScroll","dir","scrollTop","clientHeight","scrollHeight","addEventListener","removeEventListener","layouts_default","layouts_dashboard","FilterBar","SearchBar","HandleBar","Styled","Wrap","withConfig","displayName","componentId","clear","title","store","query","handle","filters","options","research","scaffold","dashboard","variables","limit","startOffset","initialize","children","Layout","date","onChangeDate","select","onChangeSelect","search","setSearch","isFetching","setFetching","visibleFilter","setVisibleFilter","setOffset","documents","setDocuments","loadDocumentsBySearch","data","dataBySearch","loading","loadingBySearch","error","errorBySearch","refetch","refetchBySearch","loadDocuments","onSearch","value","result","async","prev","keys","a","createElement","onChangeFilter","onSubmit","icon","buttonCreateText","onCreate","onChangeVisibleFilter","onChangeDisplayMethod","isOpen","map","filter","type","key","placeholder","onChange","withNavigate","selected","item","length","style","width","textAlign","appearance","RHEb","r","d","__N_SSP","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","next_router__WEBPACK_IMPORTED_MODULE_1__","_atomic_ui_utils_functions__WEBPACK_IMPORTED_MODULE_2__","_layouts_content__WEBPACK_IMPORTED_MODULE_3__","_components_Styled__WEBPACK_IMPORTED_MODULE_4__","_components_ProjectList__WEBPACK_IMPORTED_MODULE_5__","_graphql_queries__WEBPACK_IMPORTED_MODULE_6__","router","categories","category","id","label","name","GET_PROJECTS","status","projects","initialList","layout","qF4B","styled_components__WEBPACK_IMPORTED_MODULE_1__","_apollo_react_hooks__WEBPACK_IMPORTED_MODULE_2__","react_redux__WEBPACK_IMPORTED_MODULE_3__","_atomic_ui_components_Alert__WEBPACK_IMPORTED_MODULE_4__","_atomic_ui_components_Spinner__WEBPACK_IMPORTED_MODULE_5__","_Styled__WEBPACK_IMPORTED_MODULE_6__","_LazyLoad__WEBPACK_IMPORTED_MODULE_7__","_ProjectCard__WEBPACK_IMPORTED_MODULE_8__","_hooks_useHelper__WEBPACK_IMPORTED_MODULE_9__","_hooks_useMutate__WEBPACK_IMPORTED_MODULE_10__","_store_actions_user__WEBPACK_IMPORTED_MODULE_11__","_store_helpers_user__WEBPACK_IMPORTED_MODULE_12__","_store_helpers_project__WEBPACK_IMPORTED_MODULE_13__","_graphql_queries__WEBPACK_IMPORTED_MODULE_14__","div","recall","mutate","user","state","setProjects","dispatch","getProjects","project","_user$projects","_user$folders","_project$company","owned","find","candidate","added","folders","folder","liked","likedProjects","onLink","auth","email","onLike","LIKE_PROJECT","response","likeProject","onAdd","mutations","addProject","ADD_USER_PROJECT","createFolder","ADD_USER_FOLDER","onAboutMore","onCompanyLink","company","recipient","author","GET_USER_CHATS","mutation","SEND_MESSAGE","onScreenshotClick","_","screenshots","preview"],"mappings":"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"},"name":"static/chunks/pages/projects-5a0b7519ca19fed3a177.js","input":"_N_E =\n(window[\"webpackJsonp_N_E\"] = window[\"webpackJsonp_N_E\"] || []).push([[31],{\n\n/***/ \"D85t\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\n      (window.__NEXT_P = window.__NEXT_P || []).push([\n        \"/projects\",\n        function () {\n          return __webpack_require__(\"RHEb\");\n        }\n      ]);\n    \n\n/***/ }),\n\n/***/ \"QX5T\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(\"q1tI\");\nvar react_default = /*#__PURE__*/__webpack_require__.n(react);\n\n// EXTERNAL MODULE: ./node_modules/styled-components/dist/styled-components.browser.esm.js\nvar styled_components_browser_esm = __webpack_require__(\"vOnD\");\n\n// EXTERNAL MODULE: ./node_modules/@apollo/client/index.js\nvar client = __webpack_require__(\"VX74\");\n\n// EXTERNAL MODULE: ./node_modules/uuid/dist/esm-browser/v4.js + 4 modules\nvar v4 = __webpack_require__(\"7Cbv\");\n\n// EXTERNAL MODULE: ./atomic-ui/components/Column/index.js\nvar Column = __webpack_require__(\"8CDE\");\n\n// EXTERNAL MODULE: ./atomic-ui/components/Alert/index.js\nvar Alert = __webpack_require__(\"ZwIX\");\n\n// EXTERNAL MODULE: ./atomic-ui/components/DatePicker/index.js + 5 modules\nvar DatePicker = __webpack_require__(\"wZgm\");\n\n// EXTERNAL MODULE: ./atomic-ui/components/Spinner/index.js\nvar Spinner = __webpack_require__(\"auMy\");\n\n// EXTERNAL MODULE: ./atomic-ui/components/Select/index.js + 22 modules\nvar Select = __webpack_require__(\"QclZ\");\n\n// CONCATENATED MODULE: ./hooks/useInfiniteScroll.js\n\nconst useInfiniteScroll = ({\n  callbackOnTop,\n  callbackOnBottom,\n  offset = 50\n}) => {\n  const [lastScrollTop, setLastScrollTop] = Object(react[\"useState\"])(0);\n  Object(react[\"useEffect\"])(() => {\n    const scrollElement = document.documentElement;\n\n    const onScroll = () => {\n      if (!scrollElement) return;\n      const dir = scrollElement.scrollTop - lastScrollTop;\n\n      if (callbackOnBottom && dir > 0 && scrollElement.scrollTop + scrollElement.clientHeight >= scrollElement.scrollHeight - offset) {\n        callbackOnBottom(scrollElement.scrollTop, scrollElement.scrollHeight);\n      }\n\n      if (callbackOnTop && dir < 0 && scrollElement.scrollTop <= offset) {\n        callbackOnTop(scrollElement.scrollTop, scrollElement.scrollHeight);\n      }\n\n      setLastScrollTop(scrollElement.scrollTop);\n    };\n\n    if (scrollElement) {\n      window.addEventListener('scroll', onScroll);\n    }\n\n    return () => {\n      if (scrollElement) {\n        window.removeEventListener('scroll', onScroll);\n      }\n    };\n  }, [callbackOnTop, callbackOnBottom, offset]);\n};\n/* harmony default export */ var hooks_useInfiniteScroll = (useInfiniteScroll);\n// EXTERNAL MODULE: ./layouts/default.js + 3 modules\nvar layouts_default = __webpack_require__(\"X+Rt\");\n\n// EXTERNAL MODULE: ./layouts/dashboard/index.js + 2 modules\nvar layouts_dashboard = __webpack_require__(\"p9yE\");\n\n// EXTERNAL MODULE: ./components/FilterBar/index.js\nvar FilterBar = __webpack_require__(\"RoTl\");\n\n// EXTERNAL MODULE: ./components/SearchBar/index.js\nvar SearchBar = __webpack_require__(\"EYtC\");\n\n// EXTERNAL MODULE: ./components/HandleBar/index.js\nvar HandleBar = __webpack_require__(\"coMr\");\n\n// EXTERNAL MODULE: ./components/Styled/index.js\nvar Styled = __webpack_require__(\"586Q\");\n\n// CONCATENATED MODULE: ./layouts/content.js\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst Wrap = Object(styled_components_browser_esm[\"c\" /* default */])(Column[\"a\" /* default */]).withConfig({\n  displayName: \"content__Wrap\",\n  componentId: \"sc-1afm75p-0\"\n})([\"margin-top:120px;margin-bottom:80px;\", \" @media only screen and (max-width:480px){margin-top:0;}\"], ({\n  clear\n}) => clear && Object(styled_components_browser_esm[\"b\" /* css */])([\"margin:0;\"]));\n\nconst ContentLayout = ({\n  title,\n  store,\n  query,\n  handle,\n  filters,\n  options,\n  research,\n  scaffold,\n  dashboard,\n  variables = {},\n  limit = 6,\n  startOffset = 6,\n  initialize,\n  children\n}) => {\n  const Layout = dashboard ? layouts_dashboard[\"a\" /* default */] : layouts_default[\"a\" /* default */];\n  const [date, onChangeDate] = Object(react[\"useState\"])();\n  const [select, onChangeSelect] = Object(react[\"useState\"])();\n  const [search, setSearch] = Object(react[\"useState\"])(null);\n  const [isFetching, setFetching] = Object(react[\"useState\"])(false);\n  const [visibleFilter, setVisibleFilter] = Object(react[\"useState\"])(false);\n  const [offset, setOffset] = Object(react[\"useState\"])(startOffset);\n  const [documents, setDocuments] = Object(react[\"useState\"])((store === null || store === void 0 ? void 0 : store.documents) || []);\n  const [loadDocumentsBySearch, {\n    data: dataBySearch,\n    loading: loadingBySearch,\n    error: errorBySearch,\n    refetch: refetchBySearch\n  }] = Object(client[\"useLazyQuery\"])(query);\n  const [loadDocuments, {\n    data,\n    loading,\n    error,\n    refetch\n  }] = Object(client[\"useLazyQuery\"])(query);\n\n  const getFilters = () => {\n    return filters.map(filter => {\n      switch (filter.type) {\n        case 'DATEPICKER':\n          return /*#__PURE__*/react_default.a.createElement(DatePicker[\"a\" /* default */], {\n            key: Object(v4[\"a\" /* default */])(),\n            value: date,\n            placeholder: filter.placeholder || 'Дата публикации',\n            onChange: onChangeDate,\n            withNavigate: true\n          });\n\n        case 'SELECT':\n          return /*#__PURE__*/react_default.a.createElement(Select[\"a\" /* default */], {\n            key: Object(v4[\"a\" /* default */])(),\n            options: filter.options,\n            placeholder: filter.placeholder || 'Раздел',\n            selected: select,\n            onChange: item => onChangeSelect(item)\n          });\n\n        default:\n          return null;\n      }\n    });\n  };\n\n  const onSearch = value => {\n    setDocuments([]);\n\n    if (value) {\n      setSearch(value);\n      loadDocumentsBySearch({\n        variables: { ...variables,\n          search: value,\n          offset: 0,\n          limit: startOffset\n        }\n      });\n    } else {\n      const result = { ...variables,\n        offset: 0,\n        limit\n      };\n      setSearch(null);\n      if (refetch) refetch(result);else loadDocuments({\n        variables: result\n      });\n    }\n\n    setOffset(0);\n  };\n\n  useInfiniteScroll({\n    callbackOnBottom: async () => {\n      const updateOffset = () => setOffset(prev => prev + limit);\n\n      if (!loading && !isFetching) {\n        setFetching(true);\n        const result = { ...variables,\n          offset,\n          limit\n        };\n\n        if (search) {\n          await refetchBySearch(variables);\n        } else {\n          if (refetch) {\n            await refetch(result);\n            updateOffset();\n          } else {\n            await loadDocuments({\n              variables: result\n            });\n          }\n        }\n\n        setFetching(false);\n      }\n    },\n    offset: 850\n  });\n  Object(react[\"useEffect\"])(() => {\n    if (initialize) loadDocuments({\n      variables: {\n        offset,\n        limit\n      }\n    });\n  }, [initialize]);\n  Object(react[\"useEffect\"])(() => {\n    if (research) onSearch(research);\n  }, [research]);\n  Object(react[\"useEffect\"])(() => {\n    const isCommon = !search && !loading && data;\n    const isSearch = search && !loadingBySearch && dataBySearch;\n    const result = isCommon || isSearch;\n    if (result) setDocuments(prev => [...prev, ...result[Object.keys(result)[0]]]);\n  }, [search, loading, loadingBySearch, data, dataBySearch]);\n  return /*#__PURE__*/react_default.a.createElement(Layout, {\n    title: title,\n    scaffold: scaffold\n  }, /*#__PURE__*/react_default.a.createElement(Wrap, {\n    clear: scaffold || dashboard\n  }, !scaffold && !dashboard && /*#__PURE__*/react_default.a.createElement(SearchBar[\"a\" /* default */], {\n    onChangeFilter: () => setVisibleFilter(!visibleFilter),\n    onSubmit: onSearch\n  }), dashboard && handle && /*#__PURE__*/react_default.a.createElement(HandleBar[\"a\" /* default */], {\n    title: title,\n    icon: handle.icon,\n    buttonCreateText: handle.buttonCreateText,\n    onCreate: handle.onCreate,\n    onChangeVisibleFilter: () => setVisibleFilter(!visibleFilter),\n    onChangeDisplayMethod: handle.onChangeDisplayMethod\n  }), (filters || options) && /*#__PURE__*/react_default.a.createElement(FilterBar[\"a\" /* default */], {\n    isOpen: visibleFilter,\n    filters: getFilters(),\n    options: options\n  }), react_default.a.createElement(children, {\n    documents\n  }), search && !loadingBySearch && documents.length === 0 && /*#__PURE__*/react_default.a.createElement(Alert[\"a\" /* default */], {\n    style: {\n      width: '100%',\n      textAlign: 'center'\n    }\n  }, \"\\u041F\\u043E \\u0432\\u0430\\u0448\\u0435\\u043C\\u0443 \\u0437\\u0430\\u043F\\u0440\\u043E\\u0441\\u0443 \\u043D\\u0438\\u0447\\u0435\\u0433\\u043E \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E\"), (search && errorBySearch || !search && error) && /*#__PURE__*/react_default.a.createElement(Alert[\"a\" /* default */], {\n    appearance: 'error',\n    style: {\n      width: '100%',\n      textAlign: 'center'\n    }\n  }, \"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435\"), (isFetching || !error && loading || search && !errorBySearch && loadingBySearch) && /*#__PURE__*/react_default.a.createElement(Styled[\"d\" /* LowerLoader */], null, /*#__PURE__*/react_default.a.createElement(Spinner[\"a\" /* default */], null)), !search && !loading && !loadingBySearch && !errorBySearch && documents.length === 0 && /*#__PURE__*/react_default.a.createElement(Alert[\"a\" /* default */], {\n    style: {\n      width: '100%',\n      textAlign: 'center'\n    }\n  }, \"\\u0414\\u0430\\u043D\\u043D\\u044B\\u0445 \\u043D\\u0435\\u0442\")));\n};\n\n/* harmony default export */ var content = __webpack_exports__[\"a\"] = (ContentLayout);\n\n/***/ }),\n\n/***/ \"RHEb\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__N_SSP\", function() { return __N_SSP; });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"20a2\");\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_router__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _atomic_ui_utils_functions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"NWnW\");\n/* harmony import */ var _layouts_content__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"QX5T\");\n/* harmony import */ var _components_Styled__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"586Q\");\n/* harmony import */ var _components_ProjectList__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"qF4B\");\n/* harmony import */ var _graphql_queries__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(\"u2Cb\");\n\n\n\n\n\n\n\nconst TITLE = 'Проекты';\n\nconst Projects = ({\n  store\n}) => {\n  const router = Object(next_router__WEBPACK_IMPORTED_MODULE_1__[\"useRouter\"])();\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_layouts_content__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"], {\n    title: TITLE,\n    filters: [{\n      type: 'DATEPICKER'\n    }, {\n      type: 'SELECT',\n      options: store === null || store === void 0 ? void 0 : store.categories.map(category => ({\n        value: category.id,\n        label: Object(_atomic_ui_utils_functions__WEBPACK_IMPORTED_MODULE_2__[/* getLabelCategory */ \"d\"])(category.name)\n      }))\n    }],\n    options: [{\n      label: 'Компания',\n      value: 'company'\n    }, {\n      label: 'Участники',\n      value: 'members'\n    }, {\n      label: 'Дата публикации',\n      value: 'createdAt'\n    }],\n    query: _graphql_queries__WEBPACK_IMPORTED_MODULE_6__[/* default */ \"a\"].GET_PROJECTS,\n    variables: {\n      category: router.query.category,\n      status: 'PUBLISHED'\n    },\n    store: {\n      documents: store === null || store === void 0 ? void 0 : store.projects\n    }\n  }, ({\n    documents\n  }) => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_components_Styled__WEBPACK_IMPORTED_MODULE_4__[/* GridAside */ \"b\"], null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_components_ProjectList__WEBPACK_IMPORTED_MODULE_5__[/* default */ \"a\"], {\n    initialList: documents,\n    layout: true\n  })));\n};\n\nvar __N_SSP = true;\n/* harmony default export */ __webpack_exports__[\"default\"] = (Projects);\n\n/***/ }),\n\n/***/ \"qF4B\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export Wrap */\n/* unused harmony export ProjectList */\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var styled_components__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"vOnD\");\n/* harmony import */ var _apollo_react_hooks__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"VX74\");\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"/MKj\");\n/* harmony import */ var _atomic_ui_components_Alert__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"ZwIX\");\n/* harmony import */ var _atomic_ui_components_Spinner__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"auMy\");\n/* harmony import */ var _Styled__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(\"586Q\");\n/* harmony import */ var _LazyLoad__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(\"VP1n\");\n/* harmony import */ var _ProjectCard__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(\"1zqG\");\n/* harmony import */ var _hooks_useHelper__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(\"ApjV\");\n/* harmony import */ var _hooks_useMutate__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(\"lphG\");\n/* harmony import */ var _store_actions_user__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(\"8ihE\");\n/* harmony import */ var _store_helpers_user__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(\"rP4V\");\n/* harmony import */ var _store_helpers_project__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(\"IxyI\");\n/* harmony import */ var _graphql_queries__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(\"u2Cb\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst Wrap = styled_components__WEBPACK_IMPORTED_MODULE_1__[/* default */ \"c\"].div.withConfig({\n  displayName: \"ProjectList__Wrap\",\n  componentId: \"zcwfmw-0\"\n})([\"display:grid;grid-template-columns:repeat(auto-fit,minmax(442px,1fr));grid-gap:var(--default-gap);grid-auto-rows:max-content;@media only screen and (max-width:768px){grid-template-columns:repeat(auto-fit,minmax(285px,1fr));}\"]);\nconst ProjectList = ({\n  variables,\n  layout,\n  initialList\n}) => {\n  const recall = Object(_hooks_useHelper__WEBPACK_IMPORTED_MODULE_9__[/* useHelper */ \"b\"])();\n  const mutate = Object(_hooks_useMutate__WEBPACK_IMPORTED_MODULE_10__[/* useMutate */ \"a\"])();\n  const user = Object(react_redux__WEBPACK_IMPORTED_MODULE_3__[/* useSelector */ \"c\"])(state => state.user);\n  const [projects, setProjects] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(initialList || []);\n  const dispatch = Object(react_redux__WEBPACK_IMPORTED_MODULE_3__[/* useDispatch */ \"b\"])();\n  const {\n    data,\n    loading,\n    error\n  } = initialList ? {\n    data: null,\n    loading: false,\n    error: false\n  } : Object(_apollo_react_hooks__WEBPACK_IMPORTED_MODULE_2__[\"useQuery\"])(_graphql_queries__WEBPACK_IMPORTED_MODULE_14__[/* default */ \"a\"].GET_PROJECTS, {\n    variables\n  });\n  Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useEffect\"])(() => {\n    if (!loading && data) {\n      setProjects(data.getProjects);\n    }\n  }, [data, loading]);\n  Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useEffect\"])(() => {\n    if ((initialList === null || initialList === void 0 ? void 0 : initialList.length) > 0) setProjects(initialList);\n  }, [initialList]);\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Wrap, null, !loading && data || projects.length > 0 ? projects.map(project => {\n    var _user$projects, _user$folders, _project$company;\n\n    const owned = user === null || user === void 0 ? void 0 : (_user$projects = user.projects) === null || _user$projects === void 0 ? void 0 : _user$projects.find(candidate => candidate.id === project.id);\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_LazyLoad__WEBPACK_IMPORTED_MODULE_7__[/* default */ \"a\"], {\n      key: project.id\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_ProjectCard__WEBPACK_IMPORTED_MODULE_8__[/* default */ \"c\"], {\n      project: project,\n      layout: layout || 'column',\n      owned: owned,\n      added: !!(user !== null && user !== void 0 && (_user$folders = user.folders) !== null && _user$folders !== void 0 && _user$folders.find(folder => !!(folder !== null && folder !== void 0 && folder.projects.find(item => item.id === project.id)))),\n      liked: !!((user === null || user === void 0 ? void 0 : user.likedProjects) || []).find(item => item.id === project.id),\n      onLink: recall(_store_helpers_project__WEBPACK_IMPORTED_MODULE_13__[/* onProjectLink */ \"e\"], {\n        id: project.id,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        liked: !!((user === null || user === void 0 ? void 0 : user.likedProjects) || []).find(item => item.id === project.id),\n        onLike: user.email && mutate(_graphql_queries__WEBPACK_IMPORTED_MODULE_14__[/* default */ \"a\"].LIKE_PROJECT, {\n          id: project.id\n        }, response => dispatch(Object(_store_actions_user__WEBPACK_IMPORTED_MODULE_11__[/* updateUser */ \"e\"])(response.data.likeProject))),\n        onAdd: user.email && recall(_store_helpers_project__WEBPACK_IMPORTED_MODULE_13__[/* onProjectAdd */ \"a\"], {\n          id: project.id,\n          folders: user === null || user === void 0 ? void 0 : user.folders,\n          mutations: {\n            addProject: _graphql_queries__WEBPACK_IMPORTED_MODULE_14__[/* default */ \"a\"].ADD_USER_PROJECT,\n            createFolder: _graphql_queries__WEBPACK_IMPORTED_MODULE_14__[/* default */ \"a\"].ADD_USER_FOLDER\n          }\n        }),\n        owned\n      }),\n      onLike: user.email && mutate(_graphql_queries__WEBPACK_IMPORTED_MODULE_14__[/* default */ \"a\"].LIKE_PROJECT, {\n        id: project.id\n      }, response => dispatch(Object(_store_actions_user__WEBPACK_IMPORTED_MODULE_11__[/* updateUser */ \"e\"])(response.data.likeProject))),\n      onAdd: user.email && recall(_store_helpers_project__WEBPACK_IMPORTED_MODULE_13__[/* onProjectAdd */ \"a\"], {\n        id: project.id,\n        folders: user === null || user === void 0 ? void 0 : user.folders,\n        mutations: {\n          addProject: _graphql_queries__WEBPACK_IMPORTED_MODULE_14__[/* default */ \"a\"].ADD_USER_PROJECT,\n          createFolder: _graphql_queries__WEBPACK_IMPORTED_MODULE_14__[/* default */ \"a\"].ADD_USER_FOLDER\n        }\n      }),\n      onAboutMore: recall(_store_helpers_user__WEBPACK_IMPORTED_MODULE_12__[/* onUserAboutMore */ \"a\"], {\n        user: project\n      }),\n      onCompanyLink: recall(_store_helpers_user__WEBPACK_IMPORTED_MODULE_12__[/* onUserLink */ \"i\"], {\n        id: (_project$company = project.company) === null || _project$company === void 0 ? void 0 : _project$company.email,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        recipient: project.author,\n        query: _graphql_queries__WEBPACK_IMPORTED_MODULE_14__[/* default */ \"a\"].GET_USER_CHATS,\n        mutation: _graphql_queries__WEBPACK_IMPORTED_MODULE_14__[/* default */ \"a\"].SEND_MESSAGE\n      }),\n      onScreenshotClick: (_, key) => recall(_store_helpers_project__WEBPACK_IMPORTED_MODULE_13__[/* onProjectScreenshot */ \"f\"], {\n        screenshots: [project.preview, ...project.screenshots],\n        key\n      })()\n    }));\n  }) : error ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_atomic_ui_components_Alert__WEBPACK_IMPORTED_MODULE_4__[/* default */ \"a\"], {\n    appearance: 'error',\n    style: {\n      width: '100%',\n      textAlign: 'center'\n    }\n  }, \"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435\") : loading ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_Styled__WEBPACK_IMPORTED_MODULE_6__[/* Loader */ \"c\"], null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_atomic_ui_components_Spinner__WEBPACK_IMPORTED_MODULE_5__[/* default */ \"a\"], null)) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_atomic_ui_components_Alert__WEBPACK_IMPORTED_MODULE_4__[/* default */ \"a\"], {\n    style: {\n      width: '100%',\n      textAlign: 'center'\n    }\n  }, \"\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u043E\\u0432 \\u043D\\u0435\\u0442\"));\n};\n/* harmony default export */ __webpack_exports__[\"a\"] = (ProjectList);\n\n/***/ })\n\n},[[\"D85t\",0,2,1,3,4,5,6,7]]]);","inputSourceMap":{"version":3,"sources":["C:\\Users\\dan82\\Documents\\workspace\\FREELANCE\\atomic\\atomic-frontend\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-client-pages-loader.js?page=%2Fprojects&absolutePagePath=private-next-pages%2Fprojects.js!","C:\\Users\\dan82\\Documents\\workspace\\FREELANCE\\atomic\\atomic-frontend\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!C:\\Users\\dan82\\Documents\\workspace\\FREELANCE\\atomic\\atomic-frontend\\hooks\\useInfiniteScroll.js","C:\\Users\\dan82\\Documents\\workspace\\FREELANCE\\atomic\\atomic-frontend\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!C:\\Users\\dan82\\Documents\\workspace\\FREELANCE\\atomic\\atomic-frontend\\layouts\\content.js","C:\\Users\\dan82\\Documents\\workspace\\FREELANCE\\atomic\\atomic-frontend\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!C:\\Users\\dan82\\Documents\\workspace\\FREELANCE\\atomic\\atomic-frontend\\pages\\projects.js","C:\\Users\\dan82\\Documents\\workspace\\FREELANCE\\atomic\\atomic-frontend\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!C:\\Users\\dan82\\Documents\\workspace\\FREELANCE\\atomic\\atomic-frontend\\components\\ProjectList\\index.js"],"names":[],"mappings":";;;;;;;AACA;AACA;AACA;AACA,iBAAiB,mBAAO,CAAC,MAAgC;AACzD;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACN4C;AACrC;AACP;AACA;AACA;AACA,CAAC;AACD,4CAA4C,yBAAQ;AACpD,EAAE,0BAAS;AACX;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACe,6EAAiB,E;;;;;;;;;;;;;;;;;;;;ACpCmB;AACH;AACG;AACzB;AAC0B;AACF;AACU;AACN;AACF;AACW;AAChB;AACL;AACM;AACA;AACA;AACG;AACnD,aAAa,wDAAM,CAAC,yBAAM;AAC1B;AACA;AACA,CAAC,qBAAqB,mBAAmB,8CAA8C,cAAc;AACrG;AACA,CAAC,cAAc,oDAAG,YAAY;;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA,CAAC;AACD,6BAA6B,oCAAe,GAAG,kCAAa;AAC5D,+BAA+B,yBAAQ;AACvC,mCAAmC,yBAAQ;AAC3C,8BAA8B,yBAAQ;AACtC,oCAAoC,yBAAQ;AAC5C,4CAA4C,yBAAQ;AACpD,8BAA8B,yBAAQ;AACtC,oCAAoC,yBAAQ;AAC5C;AACA;AACA;AACA;AACA;AACA,GAAG,IAAI,8BAAY;AACnB;AACA;AACA;AACA;AACA;AACA,GAAG,IAAI,8BAAY;;AAEnB;AACA;AACA;AACA;AACA,8BAA8B,eAAK,eAAe,6BAAU;AAC5D,iBAAiB,6BAAE;AACnB;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA,8BAA8B,eAAK,eAAe,yBAAM;AACxD,iBAAiB,6BAAE;AACnB;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL,sBAAsB;AACtB;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA,OAAO;AACP;;AAEA;AACA;;AAEA,EAAE,iBAAiB;AACnB;AACA;;AAEA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH,EAAE,0BAAS;AACX;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH,EAAE,0BAAS;AACX;AACA,GAAG;AACH,EAAE,0BAAS;AACX;AACA;AACA;AACA;AACA,GAAG;AACH,sBAAsB,eAAK;AAC3B;AACA;AACA,GAAG,eAAe,eAAK;AACvB;AACA,GAAG,0CAA0C,eAAK,eAAe,4BAAS;AAC1E;AACA;AACA,GAAG,uCAAuC,eAAK,eAAe,4BAAS;AACvE;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,wCAAwC,eAAK,eAAe,4BAAS;AACxE;AACA;AACA;AACA,GAAG,GAAG,eAAK;AACX;AACA,GAAG,wEAAwE,eAAK,eAAe,wBAAK;AACpG;AACA;AACA;AACA;AACA,GAAG,8PAA8P,eAAK,eAAe,wBAAK;AAC1R;AACA;AACA;AACA;AACA;AACA,GAAG,2PAA2P,eAAK,eAAe,6BAAW,qBAAqB,eAAK,eAAe,0BAAO,8GAA8G,eAAK,eAAe,wBAAK;AACpd;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEe,oFAAa,E;;;;;;;;ACvM5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA0B;AACc;AACwB;AACjB;AACe;AACV;AACX;AACzC;;AAEA;AACA;AACA,CAAC;AACD,iBAAiB,6DAAS;AAC1B,sBAAsB,4CAAK,eAAe,gEAAa;AACvD;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,eAAe,2FAAgB;AAC/B,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL,WAAW,gEAAO;AAClB;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG,kBAAkB,4CAAK,eAAe,oEAAS,qBAAqB,4CAAK,eAAe,uEAAW;AACtG;AACA;AACA,GAAG;AACH;;AAEO;AACQ,uEAAQ,E;;;;;;;;ACnDvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmD;AACZ;AACQ;AACQ;AACF;AACI;AACtB;AACA;AACM;AACS;AACA;AACI;AACiB;AACwB;AACnD;AACrC,aAAa,iEAAM;AAC1B;AACA;AACA,CAAC,iBAAiB,yDAAyD,4BAA4B,2BAA2B,yCAAyC,0DAA0D;AAC9N;AACP;AACA;AACA;AACA,CAAC;AACD,iBAAiB,0EAAS;AAC1B,iBAAiB,2EAAS;AAC1B,eAAe,uEAAW;AAC1B,kCAAkC,sDAAQ;AAC1C,mBAAmB,uEAAW;AAC9B;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG,GAAG,oEAAQ,CAAC,iEAAO;AACtB;AACA,GAAG;AACH,EAAE,uDAAS;AACX;AACA;AACA;AACA,GAAG;AACH,EAAE,uDAAS;AACX;AACA,GAAG;AACH,sBAAsB,4CAAK;AAC3B;;AAEA;AACA,wBAAwB,4CAAK,eAAe,yDAAQ;AACpD;AACA,KAAK,eAAe,4CAAK,eAAe,4DAAW;AACnD;AACA;AACA;AACA;AACA;AACA,qBAAqB,6EAAa;AAClC;AACA;AACA;AACA,qCAAqC,iEAAO;AAC5C;AACA,SAAS,uBAAuB,+EAAU;AAC1C,oCAAoC,4EAAY;AAChD;AACA;AACA;AACA,wBAAwB,iEAAO;AAC/B,0BAA0B,iEAAO;AACjC;AACA,SAAS;AACT;AACA,OAAO;AACP,mCAAmC,iEAAO;AAC1C;AACA,OAAO,uBAAuB,+EAAU;AACxC,kCAAkC,4EAAY;AAC9C;AACA;AACA;AACA,sBAAsB,iEAAO;AAC7B,wBAAwB,iEAAO;AAC/B;AACA,OAAO;AACP,0BAA0B,4EAAe;AACzC;AACA,OAAO;AACP,4BAA4B,uEAAU;AACtC;AACA;AACA;AACA,eAAe,iEAAO;AACtB,kBAAkB,iEAAO;AACzB,OAAO;AACP,4CAA4C,mFAAmB;AAC/D;AACA;AACA,OAAO;AACP,KAAK;AACL,GAAG,yBAAyB,4CAAK,eAAe,2EAAK;AACrD;AACA;AACA;AACA;AACA;AACA,GAAG,kLAAkL,4CAAK,eAAe,sDAAM,qBAAqB,4CAAK,eAAe,6EAAO,wBAAwB,4CAAK,eAAe,2EAAK;AAChT;AACA;AACA;AACA;AACA,GAAG;AACH;AACe,oEAAW,E","file":"x","sourcesContent":["\n      (window.__NEXT_P = window.__NEXT_P || []).push([\n        \"/projects\",\n        function () {\n          return require(\"private-next-pages/projects.js\");\n        }\n      ]);\n    ","import { useState, useEffect } from 'react';\nexport const useInfiniteScroll = ({\n  callbackOnTop,\n  callbackOnBottom,\n  offset = 50\n}) => {\n  const [lastScrollTop, setLastScrollTop] = useState(0);\n  useEffect(() => {\n    const scrollElement = document.documentElement;\n\n    const onScroll = () => {\n      if (!scrollElement) return;\n      const dir = scrollElement.scrollTop - lastScrollTop;\n\n      if (callbackOnBottom && dir > 0 && scrollElement.scrollTop + scrollElement.clientHeight >= scrollElement.scrollHeight - offset) {\n        callbackOnBottom(scrollElement.scrollTop, scrollElement.scrollHeight);\n      }\n\n      if (callbackOnTop && dir < 0 && scrollElement.scrollTop <= offset) {\n        callbackOnTop(scrollElement.scrollTop, scrollElement.scrollHeight);\n      }\n\n      setLastScrollTop(scrollElement.scrollTop);\n    };\n\n    if (scrollElement) {\n      window.addEventListener('scroll', onScroll);\n    }\n\n    return () => {\n      if (scrollElement) {\n        window.removeEventListener('scroll', onScroll);\n      }\n    };\n  }, [callbackOnTop, callbackOnBottom, offset]);\n};\nexport default useInfiniteScroll;","import React, { useState, useEffect } from 'react';\nimport styled, { css } from 'styled-components';\nimport { useLazyQuery } from '@apollo/react-hooks';\nimport { v4 } from 'uuid';\nimport Column from '../atomic-ui/components/Column';\nimport Alert from '../atomic-ui/components/Alert';\nimport DatePicker from '../atomic-ui/components/DatePicker';\nimport Spinner from '../atomic-ui/components/Spinner';\nimport Select from '../atomic-ui/components/Select';\nimport { useInfiniteScroll } from '../hooks/useInfiniteScroll';\nimport DefaultLayout from '../layouts/default';\nimport DashboardLayout from './dashboard';\nimport FilterBar from '../components/FilterBar';\nimport SearchBar from '../components/SearchBar';\nimport HandleBar from '../components/HandleBar';\nimport { LowerLoader } from '../components/Styled';\nconst Wrap = styled(Column).withConfig({\n  displayName: \"content__Wrap\",\n  componentId: \"sc-1afm75p-0\"\n})([\"margin-top:120px;margin-bottom:80px;\", \" @media only screen and (max-width:480px){margin-top:0;}\"], ({\n  clear\n}) => clear && css([\"margin:0;\"]));\n\nconst ContentLayout = ({\n  title,\n  store,\n  query,\n  handle,\n  filters,\n  options,\n  research,\n  scaffold,\n  dashboard,\n  variables = {},\n  limit = 6,\n  startOffset = 6,\n  initialize,\n  children\n}) => {\n  const Layout = dashboard ? DashboardLayout : DefaultLayout;\n  const [date, onChangeDate] = useState();\n  const [select, onChangeSelect] = useState();\n  const [search, setSearch] = useState(null);\n  const [isFetching, setFetching] = useState(false);\n  const [visibleFilter, setVisibleFilter] = useState(false);\n  const [offset, setOffset] = useState(startOffset);\n  const [documents, setDocuments] = useState((store === null || store === void 0 ? void 0 : store.documents) || []);\n  const [loadDocumentsBySearch, {\n    data: dataBySearch,\n    loading: loadingBySearch,\n    error: errorBySearch,\n    refetch: refetchBySearch\n  }] = useLazyQuery(query);\n  const [loadDocuments, {\n    data,\n    loading,\n    error,\n    refetch\n  }] = useLazyQuery(query);\n\n  const getFilters = () => {\n    return filters.map(filter => {\n      switch (filter.type) {\n        case 'DATEPICKER':\n          return /*#__PURE__*/React.createElement(DatePicker, {\n            key: v4(),\n            value: date,\n            placeholder: filter.placeholder || 'Дата публикации',\n            onChange: onChangeDate,\n            withNavigate: true\n          });\n\n        case 'SELECT':\n          return /*#__PURE__*/React.createElement(Select, {\n            key: v4(),\n            options: filter.options,\n            placeholder: filter.placeholder || 'Раздел',\n            selected: select,\n            onChange: item => onChangeSelect(item)\n          });\n\n        default:\n          return null;\n      }\n    });\n  };\n\n  const onSearch = value => {\n    setDocuments([]);\n\n    if (value) {\n      setSearch(value);\n      loadDocumentsBySearch({\n        variables: { ...variables,\n          search: value,\n          offset: 0,\n          limit: startOffset\n        }\n      });\n    } else {\n      const result = { ...variables,\n        offset: 0,\n        limit\n      };\n      setSearch(null);\n      if (refetch) refetch(result);else loadDocuments({\n        variables: result\n      });\n    }\n\n    setOffset(0);\n  };\n\n  useInfiniteScroll({\n    callbackOnBottom: async () => {\n      const updateOffset = () => setOffset(prev => prev + limit);\n\n      if (!loading && !isFetching) {\n        setFetching(true);\n        const result = { ...variables,\n          offset,\n          limit\n        };\n\n        if (search) {\n          await refetchBySearch(variables);\n        } else {\n          if (refetch) {\n            await refetch(result);\n            updateOffset();\n          } else {\n            await loadDocuments({\n              variables: result\n            });\n          }\n        }\n\n        setFetching(false);\n      }\n    },\n    offset: 850\n  });\n  useEffect(() => {\n    if (initialize) loadDocuments({\n      variables: {\n        offset,\n        limit\n      }\n    });\n  }, [initialize]);\n  useEffect(() => {\n    if (research) onSearch(research);\n  }, [research]);\n  useEffect(() => {\n    const isCommon = !search && !loading && data;\n    const isSearch = search && !loadingBySearch && dataBySearch;\n    const result = isCommon || isSearch;\n    if (result) setDocuments(prev => [...prev, ...result[Object.keys(result)[0]]]);\n  }, [search, loading, loadingBySearch, data, dataBySearch]);\n  return /*#__PURE__*/React.createElement(Layout, {\n    title: title,\n    scaffold: scaffold\n  }, /*#__PURE__*/React.createElement(Wrap, {\n    clear: scaffold || dashboard\n  }, !scaffold && !dashboard && /*#__PURE__*/React.createElement(SearchBar, {\n    onChangeFilter: () => setVisibleFilter(!visibleFilter),\n    onSubmit: onSearch\n  }), dashboard && handle && /*#__PURE__*/React.createElement(HandleBar, {\n    title: title,\n    icon: handle.icon,\n    buttonCreateText: handle.buttonCreateText,\n    onCreate: handle.onCreate,\n    onChangeVisibleFilter: () => setVisibleFilter(!visibleFilter),\n    onChangeDisplayMethod: handle.onChangeDisplayMethod\n  }), (filters || options) && /*#__PURE__*/React.createElement(FilterBar, {\n    isOpen: visibleFilter,\n    filters: getFilters(),\n    options: options\n  }), React.createElement(children, {\n    documents\n  }), search && !loadingBySearch && documents.length === 0 && /*#__PURE__*/React.createElement(Alert, {\n    style: {\n      width: '100%',\n      textAlign: 'center'\n    }\n  }, \"\\u041F\\u043E \\u0432\\u0430\\u0448\\u0435\\u043C\\u0443 \\u0437\\u0430\\u043F\\u0440\\u043E\\u0441\\u0443 \\u043D\\u0438\\u0447\\u0435\\u0433\\u043E \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E\"), (search && errorBySearch || !search && error) && /*#__PURE__*/React.createElement(Alert, {\n    appearance: 'error',\n    style: {\n      width: '100%',\n      textAlign: 'center'\n    }\n  }, \"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435\"), (isFetching || !error && loading || search && !errorBySearch && loadingBySearch) && /*#__PURE__*/React.createElement(LowerLoader, null, /*#__PURE__*/React.createElement(Spinner, null)), !search && !loading && !loadingBySearch && !errorBySearch && documents.length === 0 && /*#__PURE__*/React.createElement(Alert, {\n    style: {\n      width: '100%',\n      textAlign: 'center'\n    }\n  }, \"\\u0414\\u0430\\u043D\\u043D\\u044B\\u0445 \\u043D\\u0435\\u0442\")));\n};\n\nexport default ContentLayout;","import React from 'react';\nimport { useRouter } from 'next/router';\nimport { getLabelCategory } from '../atomic-ui/utils/functions';\nimport ContentLayout from '../layouts/content';\nimport { GridAside as Container } from '../components/Styled';\nimport ProjectList from '../components/ProjectList';\nimport queries from '../graphql/queries';\nconst TITLE = 'Проекты';\n\nconst Projects = ({\n  store\n}) => {\n  const router = useRouter();\n  return /*#__PURE__*/React.createElement(ContentLayout, {\n    title: TITLE,\n    filters: [{\n      type: 'DATEPICKER'\n    }, {\n      type: 'SELECT',\n      options: store === null || store === void 0 ? void 0 : store.categories.map(category => ({\n        value: category.id,\n        label: getLabelCategory(category.name)\n      }))\n    }],\n    options: [{\n      label: 'Компания',\n      value: 'company'\n    }, {\n      label: 'Участники',\n      value: 'members'\n    }, {\n      label: 'Дата публикации',\n      value: 'createdAt'\n    }],\n    query: queries.GET_PROJECTS,\n    variables: {\n      category: router.query.category,\n      status: 'PUBLISHED'\n    },\n    store: {\n      documents: store === null || store === void 0 ? void 0 : store.projects\n    }\n  }, ({\n    documents\n  }) => /*#__PURE__*/React.createElement(Container, null, /*#__PURE__*/React.createElement(ProjectList, {\n    initialList: documents,\n    layout: true\n  })));\n};\n\nexport var __N_SSP = true;\nexport default Projects;","import React, { useState, useEffect } from 'react';\nimport styled from 'styled-components';\nimport { useQuery } from '@apollo/react-hooks';\nimport { useDispatch, useSelector } from 'react-redux';\nimport Alert from '../../atomic-ui/components/Alert';\nimport Spinner from '../../atomic-ui/components/Spinner';\nimport { Loader } from '../Styled';\nimport LazyLoad from '../LazyLoad';\nimport ProjectCard from '../ProjectCard';\nimport { useHelper } from '../../hooks/useHelper';\nimport { useMutate } from '../../hooks/useMutate';\nimport { updateUser } from '../../store/actions/user';\nimport { onUserAboutMore, onUserLink } from '../../store/helpers/user';\nimport { onProjectAdd, onProjectLink, onProjectScreenshot } from '../../store/helpers/project';\nimport queries from '../../graphql/queries';\nexport const Wrap = styled.div.withConfig({\n  displayName: \"ProjectList__Wrap\",\n  componentId: \"zcwfmw-0\"\n})([\"display:grid;grid-template-columns:repeat(auto-fit,minmax(442px,1fr));grid-gap:var(--default-gap);grid-auto-rows:max-content;@media only screen and (max-width:768px){grid-template-columns:repeat(auto-fit,minmax(285px,1fr));}\"]);\nexport const ProjectList = ({\n  variables,\n  layout,\n  initialList\n}) => {\n  const recall = useHelper();\n  const mutate = useMutate();\n  const user = useSelector(state => state.user);\n  const [projects, setProjects] = useState(initialList || []);\n  const dispatch = useDispatch();\n  const {\n    data,\n    loading,\n    error\n  } = initialList ? {\n    data: null,\n    loading: false,\n    error: false\n  } : useQuery(queries.GET_PROJECTS, {\n    variables\n  });\n  useEffect(() => {\n    if (!loading && data) {\n      setProjects(data.getProjects);\n    }\n  }, [data, loading]);\n  useEffect(() => {\n    if ((initialList === null || initialList === void 0 ? void 0 : initialList.length) > 0) setProjects(initialList);\n  }, [initialList]);\n  return /*#__PURE__*/React.createElement(Wrap, null, !loading && data || projects.length > 0 ? projects.map(project => {\n    var _user$projects, _user$folders, _project$company;\n\n    const owned = user === null || user === void 0 ? void 0 : (_user$projects = user.projects) === null || _user$projects === void 0 ? void 0 : _user$projects.find(candidate => candidate.id === project.id);\n    return /*#__PURE__*/React.createElement(LazyLoad, {\n      key: project.id\n    }, /*#__PURE__*/React.createElement(ProjectCard, {\n      project: project,\n      layout: layout || 'column',\n      owned: owned,\n      added: !!(user !== null && user !== void 0 && (_user$folders = user.folders) !== null && _user$folders !== void 0 && _user$folders.find(folder => !!(folder !== null && folder !== void 0 && folder.projects.find(item => item.id === project.id)))),\n      liked: !!((user === null || user === void 0 ? void 0 : user.likedProjects) || []).find(item => item.id === project.id),\n      onLink: recall(onProjectLink, {\n        id: project.id,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        liked: !!((user === null || user === void 0 ? void 0 : user.likedProjects) || []).find(item => item.id === project.id),\n        onLike: user.email && mutate(queries.LIKE_PROJECT, {\n          id: project.id\n        }, response => dispatch(updateUser(response.data.likeProject))),\n        onAdd: user.email && recall(onProjectAdd, {\n          id: project.id,\n          folders: user === null || user === void 0 ? void 0 : user.folders,\n          mutations: {\n            addProject: queries.ADD_USER_PROJECT,\n            createFolder: queries.ADD_USER_FOLDER\n          }\n        }),\n        owned\n      }),\n      onLike: user.email && mutate(queries.LIKE_PROJECT, {\n        id: project.id\n      }, response => dispatch(updateUser(response.data.likeProject))),\n      onAdd: user.email && recall(onProjectAdd, {\n        id: project.id,\n        folders: user === null || user === void 0 ? void 0 : user.folders,\n        mutations: {\n          addProject: queries.ADD_USER_PROJECT,\n          createFolder: queries.ADD_USER_FOLDER\n        }\n      }),\n      onAboutMore: recall(onUserAboutMore, {\n        user: project\n      }),\n      onCompanyLink: recall(onUserLink, {\n        id: (_project$company = project.company) === null || _project$company === void 0 ? void 0 : _project$company.email,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        recipient: project.author,\n        query: queries.GET_USER_CHATS,\n        mutation: queries.SEND_MESSAGE\n      }),\n      onScreenshotClick: (_, key) => recall(onProjectScreenshot, {\n        screenshots: [project.preview, ...project.screenshots],\n        key\n      })()\n    }));\n  }) : error ? /*#__PURE__*/React.createElement(Alert, {\n    appearance: 'error',\n    style: {\n      width: '100%',\n      textAlign: 'center'\n    }\n  }, \"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435\") : loading ? /*#__PURE__*/React.createElement(Loader, null, /*#__PURE__*/React.createElement(Spinner, null)) : /*#__PURE__*/React.createElement(Alert, {\n    style: {\n      width: '100%',\n      textAlign: 'center'\n    }\n  }, \"\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u043E\\u0432 \\u043D\\u0435\\u0442\"));\n};\nexport default ProjectList;"]}}