{"code":"_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[30],{RNiq:function(e,i,a){\"use strict\";a.r(i),a.d(i,\"__N_SSP\",(function(){return O}));var t=a(\"q1tI\"),d=a.n(t),n=a(\"vOnD\"),o=a(\"/MKj\"),l=a(\"VX74\"),r=a(\"7Cbv\"),c=a(\"ZwIX\"),s=a(\"7sPp\"),u=a(\"auMy\"),m=a(\"ApjV\"),E=a(\"lphG\");const p=e=>{const[i,a]=Object(t.useState)(!1),d=()=>{const e=document.documentElement.scrollHeight,t=window.innerHeight,d=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;i||t+d!==e||a(!0)};return Object(t.useEffect)((()=>{i&&e()}),[i]),Object(t.useEffect)((()=>(window.addEventListener(\"scroll\",d),()=>window.removeEventListener(\"scroll\",d))),[]),[i,a]};var v=a(\"X+Rt\"),_=a(\"1zqG\"),h=a(\"UwjQ\"),f=a(\"TsNn\"),g=a(\"8ihE\"),j=a(\"IxyI\"),w=a(\"rP4V\"),S=a(\"owvJ\"),C=a(\"+EEm\"),k=a(\"u2Cb\");const y=n.c.div.withConfig({displayName:\"pages__Container\",componentId:\"sc-1kp8388-0\"})([\"display:grid;grid-template-columns:1fr min-content;grid-gap:var(--default-gap);margin-bottom:80px;@media only screen and (max-width:1196px){grid-template-columns:1fr;}\"]),A=n.c.aside.withConfig({displayName:\"pages__Projects\",componentId:\"sc-1kp8388-1\"})([\"display:grid;grid-template-columns:repeat(auto-fit,minmax(442px,1fr));grid-gap:var(--default-gap);grid-auto-rows:max-content;@media only screen and (max-width:768px){grid-template-columns:repeat(auto-fit,minmax(285px,1fr));}\"]),D=n.c.aside.withConfig({displayName:\"pages__Aside\",componentId:\"sc-1kp8388-2\"})([\"display:flex;flex-direction:column;grid-gap:var(--default-gap);width:394px;@media only screen and (max-width:1196px){width:auto;}\"]),R=n.c.div.withConfig({displayName:\"pages__Loader\",componentId:\"sc-1kp8388-3\"})([\"display:flex;justify-content:center;width:100%;height:80px;\"]);var O=!0;i.default=({store:e})=>{const i=Object(m.b)(),a=Object(E.a)(),n=Object(o.c)((e=>e.user)),O=Object(o.b)(),{loading:T,refetch:b}=Object(l.useQuery)(k.a.GET_PROJECTS,{variables:{offset:0,limit:5}}),{articles:P,users:L}=e,[x,U]=Object(t.useState)(e.projects||[]),[N,G]=Object(t.useState)(13),[H,I]=p((async()=>{const e=await b({offset:N,limit:5});e.errors||U((i=>[...i,...e.data.getProjects])),G((e=>e+5)),I(!1)}));return d.a.createElement(v.a,{title:\"\\u0410\\u0442\\u043e\\u043c\\u0438\\u043a\",scaffold:{title:\"\\u0421\\u043e\\u0437\\u0434\\u0430\\u0432\\u0430\\u0439 \\u0448\\u043a\\u043e\\u043b\\u0443 \\u0431\\u0443\\u0434\\u0443\\u0449\\u0435\\u0433\\u043e \\u0441 \\u043d\\u0430\\u043c\\u0438\",background:\"/images/main-background.png\",primary:x.length>0&&x[0],residue:x.length>4&&x.slice(1,3),onLink:(e,t)=>i(j.e,{id:e.id,auth:null===n||void 0===n?void 0:n.email,project:e,liked:!!((null===n||void 0===n?void 0:n.likedProjects)||[]).find((i=>i.id===e.id)),onLike:n.email&&a(k.a.LIKE_PROJECT,{id:e.id},(e=>O(Object(g.e)(e.data.likeProject)))),onAdd:n.email&&i(j.a,{id:e.id,project:e,folders:null===n||void 0===n?void 0:n.folders,mutations:{addProject:k.a.ADD_USER_PROJECT,createFolder:k.a.ADD_USER_FOLDER}}),owned:t})(),onLike:n.email&&(e=>a(k.a.LIKE_PROJECT,{id:e.id},(e=>O(Object(g.e)(e.data.likeProject))))()),onAdd:n.email&&(e=>i(j.a,{id:e.id,project:e,folders:null===n||void 0===n?void 0:n.folders,mutations:{addProject:k.a.ADD_USER_PROJECT,createFolder:k.a.ADD_USER_FOLDER}})()),onCompanyLink:e=>{var a;return i(w.i,{id:null===(a=e.company)||void 0===a?void 0:a.email,auth:n})()},onScreenshotClick:(e,a)=>i(j.f,{screenshots:[e.preview,...e.screenshots],key:a})()}},d.a.createElement(y,null,d.a.createElement(A,null,x.length>3?x.slice(3).map((e=>{var t,o,l;const c=null===n||void 0===n||null===(t=n.projects)||void 0===t?void 0:t.find((i=>i.id===e.id));return d.a.createElement(_.c,{key:Object(r.a)(),project:e,owned:c,added:!(null===n||void 0===n||null===(o=n.folders)||void 0===o||!o.find((i=>!(null===i||void 0===i||!i.projects.find((i=>i.id===e.id)))))),liked:!!((null===n||void 0===n?void 0:n.likedProjects)||[]).find((i=>i.id===e.id)),onLink:i(j.e,{id:e.id,auth:null===n||void 0===n?void 0:n.email,liked:!!((null===n||void 0===n?void 0:n.likedProjects)||[]).find((i=>i.id===e.id)),onLike:n.email&&a(k.a.LIKE_PROJECT,{id:e.id},(e=>O(Object(g.e)(e.data.likeProject)))),onAdd:n.email&&i(j.a,{id:e.id,project:e,folders:null===n||void 0===n?void 0:n.folders,mutations:{addProject:k.a.ADD_USER_PROJECT,createFolder:k.a.ADD_USER_FOLDER}}),owned:c}),onLike:n.email&&a(k.a.LIKE_PROJECT,{id:e.id},(e=>O(Object(g.e)(e.data.likeProject)))),onAdd:n.email&&i(j.a,{id:e.id,project:e,folders:null===n||void 0===n?void 0:n.folders,mutations:{addProject:k.a.ADD_USER_PROJECT,createFolder:k.a.ADD_USER_FOLDER}}),onCompanyLink:i(w.i,{id:null===(l=e.company)||void 0===l?void 0:l.email,auth:null===n||void 0===n?void 0:n.email,recipient:e.author,query:k.a.GET_USER_CHATS,mutation:k.a.SEND_MESSAGE}),onScreenshotClick:(a,t)=>i(j.f,{screenshots:[e.preview,...e.screenshots],key:t})()})})):d.a.createElement(c.a,{style:{width:\"100%\",textAlign:\"center\"}},\"\\u041f\\u0440\\u043e\\u0435\\u043a\\u0442\\u043e\\u0432 \\u043d\\u0435\\u0442\"),(T||H)&&d.a.createElement(R,null,d.a.createElement(u.a,null))),d.a.createElement(D,null,d.a.createElement(s.a,{tag:\"h4\"},\"\\u0410\\u0432\\u0442\\u043e\\u0440\\u044b\"),L.length>0?L.slice(0,3).map((e=>{var a;const t=e.name===(null===n||void 0===n?void 0:n.name);return d.a.createElement(f.a,{key:Object(r.a)(),user:e,owned:t,onChat:n.email&&i(C.a,{email:e.email,auth:null===n||void 0===n?void 0:n.email,queries:{userChats:k.a.GET_USER_CHATS,chat:k.a.GET_CHAT},mutations:{addUserChat:k.a.ADD_USER_CHAT,sendMessage:k.a.SEND_MESSAGE}}),onLink:i(w.i,{id:e.email,auth:null===n||void 0===n?void 0:n.email,owned:t,queries:{userChats:k.a.GET_USER_CHATS,chat:k.a.GET_CHAT},mutations:{addUserChat:k.a.ADD_USER_CHAT,sendMessage:k.a.SEND_MESSAGE}}),onMembers:i(w.j,{id:null===e||void 0===e?void 0:e.email,auth:null===n||void 0===n?void 0:n.email}),onCompanyLink:i(w.i,{id:null===(a=e.company)||void 0===a?void 0:a.email,auth:null===n||void 0===n?void 0:n.email,queries:{userChats:k.a.GET_USER_CHATS,chat:k.a.GET_CHAT},mutations:{addUserChat:k.a.ADD_USER_CHAT,sendMessage:k.a.SEND_MESSAGE}})})})):d.a.createElement(c.a,{style:{width:\"100%\",textAlign:\"center\"}},\"\\u0410\\u0432\\u0442\\u043e\\u0440\\u043e\\u0432 \\u043d\\u0435\\u0442\"),d.a.createElement(s.a,{tag:\"h4\"},\"\\u041d\\u043e\\u0432\\u043e\\u0441\\u0442\\u0438\"),P.length>0?P.slice(0,2).map((e=>{var a;return d.a.createElement(h.a,{key:Object(r.a)(),layout:\"column\",article:e,owned:null===n||void 0===n||null===(a=n.articles)||void 0===a?void 0:a.find((i=>i.id===e.id)),onLink:i(S.d,{id:e.id,auth:null===n||void 0===n?void 0:n.email})})})):d.a.createElement(c.a,{style:{width:\"100%\",textAlign:\"center\"}},\"\\u041d\\u043e\\u0432\\u043e\\u0441\\u0442\\u0435\\u0439 \\u043d\\u0435\\u0442\"))))}},vlRD:function(e,i,a){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/\",function(){return a(\"RNiq\")}])}},[[\"vlRD\",0,2,1,3,4,5,6,9]]]);","map":{"version":3,"sources":["static/chunks/pages/index-cd990a44d10e4c6c5ec5.js"],"names":["_N_E","window","push","RNiq","module","__webpack_exports__","__webpack_require__","r","d","__N_SSP","react","react_default","n","styled_components_browser_esm","es","client","v4","Alert","Title","Spinner","useHelper","useMutate","useInfiniteScroll","fetchCallback","isFetching","setIsFetching","Object","onScroll","offsetHeight","document","documentElement","scrollHeight","innerHeight","scrollTop","pageYOffset","body","addEventListener","removeEventListener","layouts_default","ProjectCard","ArticleCard","UserCard","actions_user","helpers_project","helpers_user","helpers_article","helpers","queries","Container","div","withConfig","displayName","componentId","Projects","aside","Aside","Loader","store","recall","mutate","user","state","dispatch","loading","refetch","GET_PROJECTS","variables","offset","limit","articles","users","projects","setProjects","setOffset","async","response","errors","prev","data","getProjects","a","createElement","title","scaffold","background","primary","length","residue","slice","onLink","project","owned","id","auth","email","liked","likedProjects","find","item","onLike","LIKE_PROJECT","likeProject","onAdd","folders","mutations","addProject","ADD_USER_PROJECT","createFolder","ADD_USER_FOLDER","onCompanyLink","_project$company","company","onScreenshotClick","key","screenshots","preview","map","_user$projects","_user$folders","_project$company2","candidate","added","folder","recipient","author","query","GET_USER_CHATS","mutation","SEND_MESSAGE","_","style","width","textAlign","tag","_author$company","name","onChat","userChats","chat","GET_CHAT","addUserChat","ADD_USER_CHAT","sendMessage","onMembers","article","_user$articles","layout","vlRD","exports","__NEXT_P"],"mappings":"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"},"name":"static/chunks/pages/index-cd990a44d10e4c6c5ec5.js","input":"_N_E =\n(window[\"webpackJsonp_N_E\"] = window[\"webpackJsonp_N_E\"] || []).push([[30],{\n\n/***/ \"RNiq\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"__N_SSP\", function() { return /* binding */ __N_SSP; });\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(\"q1tI\");\nvar react_default = /*#__PURE__*/__webpack_require__.n(react);\n\n// EXTERNAL MODULE: ./node_modules/styled-components/dist/styled-components.browser.esm.js\nvar styled_components_browser_esm = __webpack_require__(\"vOnD\");\n\n// EXTERNAL MODULE: ./node_modules/react-redux/es/index.js + 22 modules\nvar es = __webpack_require__(\"/MKj\");\n\n// EXTERNAL MODULE: ./node_modules/@apollo/client/index.js\nvar client = __webpack_require__(\"VX74\");\n\n// EXTERNAL MODULE: ./node_modules/uuid/dist/esm-browser/v4.js + 4 modules\nvar v4 = __webpack_require__(\"7Cbv\");\n\n// EXTERNAL MODULE: ./atomic-ui/components/Alert/index.js\nvar Alert = __webpack_require__(\"ZwIX\");\n\n// EXTERNAL MODULE: ./atomic-ui/components/Title/index.js\nvar Title = __webpack_require__(\"7sPp\");\n\n// EXTERNAL MODULE: ./atomic-ui/components/Spinner/index.js\nvar Spinner = __webpack_require__(\"auMy\");\n\n// EXTERNAL MODULE: ./hooks/useHelper.js\nvar useHelper = __webpack_require__(\"ApjV\");\n\n// EXTERNAL MODULE: ./hooks/useMutate.js\nvar useMutate = __webpack_require__(\"lphG\");\n\n// CONCATENATED MODULE: ./hooks/useInfiniteScroll.js\n\nconst useInfiniteScroll = fetchCallback => {\n  const [isFetching, setIsFetching] = Object(react[\"useState\"])(false);\n\n  const onScroll = () => {\n    const offsetHeight = document.documentElement.scrollHeight;\n    const innerHeight = window.innerHeight;\n    const scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;\n    if (isFetching || innerHeight + scrollTop !== offsetHeight) return;\n    setIsFetching(true);\n  };\n\n  Object(react[\"useEffect\"])(() => {\n    if (!isFetching) return;\n    fetchCallback();\n  }, [isFetching]);\n  Object(react[\"useEffect\"])(() => {\n    window.addEventListener('scroll', onScroll);\n    return () => window.removeEventListener('scroll', onScroll);\n  }, []);\n  return [isFetching, setIsFetching];\n};\n/* harmony default export */ var hooks_useInfiniteScroll = (useInfiniteScroll);\n// EXTERNAL MODULE: ./layouts/default.js + 3 modules\nvar layouts_default = __webpack_require__(\"X+Rt\");\n\n// EXTERNAL MODULE: ./components/ProjectCard/index.js\nvar ProjectCard = __webpack_require__(\"1zqG\");\n\n// EXTERNAL MODULE: ./components/ArticleCard/index.js + 1 modules\nvar ArticleCard = __webpack_require__(\"UwjQ\");\n\n// EXTERNAL MODULE: ./components/UserCard/index.js\nvar UserCard = __webpack_require__(\"TsNn\");\n\n// EXTERNAL MODULE: ./store/actions/user.js\nvar actions_user = __webpack_require__(\"8ihE\");\n\n// EXTERNAL MODULE: ./store/helpers/project.js + 6 modules\nvar helpers_project = __webpack_require__(\"IxyI\");\n\n// EXTERNAL MODULE: ./store/helpers/user.js + 11 modules\nvar helpers_user = __webpack_require__(\"rP4V\");\n\n// EXTERNAL MODULE: ./store/helpers/article.js + 4 modules\nvar helpers_article = __webpack_require__(\"owvJ\");\n\n// EXTERNAL MODULE: ./store/helpers/index.js + 5 modules\nvar helpers = __webpack_require__(\"+EEm\");\n\n// EXTERNAL MODULE: ./graphql/queries/index.js + 14 modules\nvar queries = __webpack_require__(\"u2Cb\");\n\n// CONCATENATED MODULE: ./pages/index.js\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst TITLE = 'Атомик';\nconst START_OFFSET = 13;\nconst LIMIT = 5;\nconst Container = styled_components_browser_esm[\"c\" /* default */].div.withConfig({\n  displayName: \"pages__Container\",\n  componentId: \"sc-1kp8388-0\"\n})([\"display:grid;grid-template-columns:1fr min-content;grid-gap:var(--default-gap);margin-bottom:80px;@media only screen and (max-width:1196px){grid-template-columns:1fr;}\"]);\nconst Projects = styled_components_browser_esm[\"c\" /* default */].aside.withConfig({\n  displayName: \"pages__Projects\",\n  componentId: \"sc-1kp8388-1\"\n})([\"display:grid;grid-template-columns:repeat(auto-fit,minmax(442px,1fr));grid-gap:var(--default-gap);grid-auto-rows:max-content;@media only screen and (max-width:768px){grid-template-columns:repeat(auto-fit,minmax(285px,1fr));}\"]);\nconst Aside = styled_components_browser_esm[\"c\" /* default */].aside.withConfig({\n  displayName: \"pages__Aside\",\n  componentId: \"sc-1kp8388-2\"\n})([\"display:flex;flex-direction:column;grid-gap:var(--default-gap);width:394px;@media only screen and (max-width:1196px){width:auto;}\"]);\nconst Loader = styled_components_browser_esm[\"c\" /* default */].div.withConfig({\n  displayName: \"pages__Loader\",\n  componentId: \"sc-1kp8388-3\"\n})([\"display:flex;justify-content:center;width:100%;height:80px;\"]);\n\nconst Home = ({\n  store\n}) => {\n  const recall = Object(useHelper[\"b\" /* useHelper */])();\n  const mutate = Object(useMutate[\"a\" /* useMutate */])();\n  const user = Object(es[\"c\" /* useSelector */])(state => state.user);\n  const dispatch = Object(es[\"b\" /* useDispatch */])();\n  const {\n    loading,\n    refetch\n  } = Object(client[\"useQuery\"])(queries[\"a\" /* default */].GET_PROJECTS, {\n    variables: {\n      offset: 0,\n      limit: LIMIT\n    }\n  });\n  const {\n    articles,\n    users\n  } = store;\n  const [projects, setProjects] = Object(react[\"useState\"])(store.projects || []);\n  const [offset, setOffset] = Object(react[\"useState\"])(START_OFFSET);\n  const [isFetching, setIsFetching] = useInfiniteScroll(async () => {\n    const response = await refetch({\n      offset,\n      limit: LIMIT\n    });\n\n    if (!response.errors) {\n      setProjects(prev => [...prev, ...response.data.getProjects]);\n    }\n\n    setOffset(prev => prev + LIMIT);\n    setIsFetching(false);\n  });\n  return /*#__PURE__*/react_default.a.createElement(layouts_default[\"a\" /* default */], {\n    title: TITLE,\n    scaffold: {\n      title: 'Создавай школу будущего с нами',\n      background: '/images/main-background.png',\n      primary: projects.length > 0 && projects[0],\n      residue: projects.length > 4 && projects.slice(1, 3),\n      onLink: (project, owned) => recall(helpers_project[\"e\" /* onProjectLink */], {\n        id: project.id,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        project,\n        liked: !!((user === null || user === void 0 ? void 0 : user.likedProjects) || []).find(item => item.id === project.id),\n        onLike: user.email && mutate(queries[\"a\" /* default */].LIKE_PROJECT, {\n          id: project.id\n        }, response => dispatch(Object(actions_user[\"e\" /* updateUser */])(response.data.likeProject))),\n        onAdd: user.email && recall(helpers_project[\"a\" /* onProjectAdd */], {\n          id: project.id,\n          project,\n          folders: user === null || user === void 0 ? void 0 : user.folders,\n          mutations: {\n            addProject: queries[\"a\" /* default */].ADD_USER_PROJECT,\n            createFolder: queries[\"a\" /* default */].ADD_USER_FOLDER\n          }\n        }),\n        owned\n      })(),\n      onLike: user.email && (project => mutate(queries[\"a\" /* default */].LIKE_PROJECT, {\n        id: project.id\n      }, response => dispatch(Object(actions_user[\"e\" /* updateUser */])(response.data.likeProject)))()),\n      onAdd: user.email && (project => recall(helpers_project[\"a\" /* onProjectAdd */], {\n        id: project.id,\n        project,\n        folders: user === null || user === void 0 ? void 0 : user.folders,\n        mutations: {\n          addProject: queries[\"a\" /* default */].ADD_USER_PROJECT,\n          createFolder: queries[\"a\" /* default */].ADD_USER_FOLDER\n        }\n      })()),\n      onCompanyLink: project => {\n        var _project$company;\n\n        return recall(helpers_user[\"i\" /* onUserLink */], {\n          id: (_project$company = project.company) === null || _project$company === void 0 ? void 0 : _project$company.email,\n          auth: user\n        })();\n      },\n      onScreenshotClick: (project, key) => recall(helpers_project[\"f\" /* onProjectScreenshot */], {\n        screenshots: [project.preview, ...project.screenshots],\n        key\n      })()\n    }\n  }, /*#__PURE__*/react_default.a.createElement(Container, null, /*#__PURE__*/react_default.a.createElement(Projects, null, projects.length > 3 ? projects.slice(3).map(project => {\n    var _user$projects, _user$folders, _project$company2;\n\n    const owned = user === null || user === void 0 ? void 0 : (_user$projects = user.projects) === null || _user$projects === void 0 ? void 0 : _user$projects.find(candidate => candidate.id === project.id);\n    return /*#__PURE__*/react_default.a.createElement(ProjectCard[\"c\" /* default */], {\n      key: Object(v4[\"a\" /* default */])(),\n      project: project,\n      owned: owned,\n      added: !!(user !== null && user !== void 0 && (_user$folders = user.folders) !== null && _user$folders !== void 0 && _user$folders.find(folder => !!(folder !== null && folder !== void 0 && folder.projects.find(item => item.id === project.id)))),\n      liked: !!((user === null || user === void 0 ? void 0 : user.likedProjects) || []).find(item => item.id === project.id),\n      onLink: recall(helpers_project[\"e\" /* onProjectLink */], {\n        id: project.id,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        liked: !!((user === null || user === void 0 ? void 0 : user.likedProjects) || []).find(item => item.id === project.id),\n        onLike: user.email && mutate(queries[\"a\" /* default */].LIKE_PROJECT, {\n          id: project.id\n        }, response => dispatch(Object(actions_user[\"e\" /* updateUser */])(response.data.likeProject))),\n        onAdd: user.email && recall(helpers_project[\"a\" /* onProjectAdd */], {\n          id: project.id,\n          project,\n          folders: user === null || user === void 0 ? void 0 : user.folders,\n          mutations: {\n            addProject: queries[\"a\" /* default */].ADD_USER_PROJECT,\n            createFolder: queries[\"a\" /* default */].ADD_USER_FOLDER\n          }\n        }),\n        owned\n      }),\n      onLike: user.email && mutate(queries[\"a\" /* default */].LIKE_PROJECT, {\n        id: project.id\n      }, response => dispatch(Object(actions_user[\"e\" /* updateUser */])(response.data.likeProject))),\n      onAdd: user.email && recall(helpers_project[\"a\" /* onProjectAdd */], {\n        id: project.id,\n        project,\n        folders: user === null || user === void 0 ? void 0 : user.folders,\n        mutations: {\n          addProject: queries[\"a\" /* default */].ADD_USER_PROJECT,\n          createFolder: queries[\"a\" /* default */].ADD_USER_FOLDER\n        }\n      }),\n      onCompanyLink: recall(helpers_user[\"i\" /* onUserLink */], {\n        id: (_project$company2 = project.company) === null || _project$company2 === void 0 ? void 0 : _project$company2.email,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        recipient: project.author,\n        query: queries[\"a\" /* default */].GET_USER_CHATS,\n        mutation: queries[\"a\" /* default */].SEND_MESSAGE\n      }),\n      onScreenshotClick: (_, key) => recall(helpers_project[\"f\" /* onProjectScreenshot */], {\n        screenshots: [project.preview, ...project.screenshots],\n        key\n      })()\n    });\n  }) : /*#__PURE__*/react_default.a.createElement(Alert[\"a\" /* default */], {\n    style: {\n      width: '100%',\n      textAlign: 'center'\n    }\n  }, \"\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u043E\\u0432 \\u043D\\u0435\\u0442\"), (loading || isFetching) && /*#__PURE__*/react_default.a.createElement(Loader, null, /*#__PURE__*/react_default.a.createElement(Spinner[\"a\" /* default */], null))), /*#__PURE__*/react_default.a.createElement(Aside, null, /*#__PURE__*/react_default.a.createElement(Title[\"a\" /* default */], {\n    tag: 'h4'\n  }, \"\\u0410\\u0432\\u0442\\u043E\\u0440\\u044B\"), users.length > 0 ? users.slice(0, 3).map(author => {\n    var _author$company;\n\n    const owned = author.name === (user === null || user === void 0 ? void 0 : user.name);\n    return /*#__PURE__*/react_default.a.createElement(UserCard[\"a\" /* default */], {\n      key: Object(v4[\"a\" /* default */])(),\n      user: author,\n      owned: owned,\n      onChat: user.email && recall(helpers[\"a\" /* onChat */], {\n        email: author.email,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        queries: {\n          userChats: queries[\"a\" /* default */].GET_USER_CHATS,\n          chat: queries[\"a\" /* default */].GET_CHAT\n        },\n        mutations: {\n          addUserChat: queries[\"a\" /* default */].ADD_USER_CHAT,\n          sendMessage: queries[\"a\" /* default */].SEND_MESSAGE\n        }\n      }),\n      onLink: recall(helpers_user[\"i\" /* onUserLink */], {\n        id: author.email,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        owned,\n        queries: {\n          userChats: queries[\"a\" /* default */].GET_USER_CHATS,\n          chat: queries[\"a\" /* default */].GET_CHAT\n        },\n        mutations: {\n          addUserChat: queries[\"a\" /* default */].ADD_USER_CHAT,\n          sendMessage: queries[\"a\" /* default */].SEND_MESSAGE\n        }\n      }),\n      onMembers: recall(helpers_user[\"j\" /* onUserMembers */], {\n        id: author === null || author === void 0 ? void 0 : author.email,\n        auth: user === null || user === void 0 ? void 0 : user.email\n      }),\n      onCompanyLink: recall(helpers_user[\"i\" /* onUserLink */], {\n        id: (_author$company = author.company) === null || _author$company === void 0 ? void 0 : _author$company.email,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        queries: {\n          userChats: queries[\"a\" /* default */].GET_USER_CHATS,\n          chat: queries[\"a\" /* default */].GET_CHAT\n        },\n        mutations: {\n          addUserChat: queries[\"a\" /* default */].ADD_USER_CHAT,\n          sendMessage: queries[\"a\" /* default */].SEND_MESSAGE\n        }\n      })\n    });\n  }) : /*#__PURE__*/react_default.a.createElement(Alert[\"a\" /* default */], {\n    style: {\n      width: '100%',\n      textAlign: 'center'\n    }\n  }, \"\\u0410\\u0432\\u0442\\u043E\\u0440\\u043E\\u0432 \\u043D\\u0435\\u0442\"), /*#__PURE__*/react_default.a.createElement(Title[\"a\" /* default */], {\n    tag: 'h4'\n  }, \"\\u041D\\u043E\\u0432\\u043E\\u0441\\u0442\\u0438\"), articles.length > 0 ? articles.slice(0, 2).map(article => {\n    var _user$articles;\n\n    return /*#__PURE__*/react_default.a.createElement(ArticleCard[\"a\" /* default */], {\n      key: Object(v4[\"a\" /* default */])(),\n      layout: 'column',\n      article: article,\n      owned: user === null || user === void 0 ? void 0 : (_user$articles = user.articles) === null || _user$articles === void 0 ? void 0 : _user$articles.find(candidate => candidate.id === article.id),\n      onLink: recall(helpers_article[\"d\" /* onArticleLink */], {\n        id: article.id,\n        auth: user === null || user === void 0 ? void 0 : user.email\n      })\n    });\n  }) : /*#__PURE__*/react_default.a.createElement(Alert[\"a\" /* default */], {\n    style: {\n      width: '100%',\n      textAlign: 'center'\n    }\n  }, \"\\u041D\\u043E\\u0432\\u043E\\u0441\\u0442\\u0435\\u0439 \\u043D\\u0435\\u0442\"))));\n};\n\nvar __N_SSP = true;\n/* harmony default export */ var pages = __webpack_exports__[\"default\"] = (Home);\n\n/***/ }),\n\n/***/ \"vlRD\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\n      (window.__NEXT_P = window.__NEXT_P || []).push([\n        \"/\",\n        function () {\n          return __webpack_require__(\"RNiq\");\n        }\n      ]);\n    \n\n/***/ })\n\n},[[\"vlRD\",0,2,1,3,4,5,6,9]]]);","inputSourceMap":{"version":3,"sources":["C:\\Users\\dan82\\Documents\\workspace\\FREELANCE\\atomic\\atomic-frontend\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!C:\\Users\\dan82\\Documents\\workspace\\FREELANCE\\atomic\\atomic-frontend\\hooks\\useInfiniteScroll.js","C:\\Users\\dan82\\Documents\\workspace\\FREELANCE\\atomic\\atomic-frontend\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!C:\\Users\\dan82\\Documents\\workspace\\FREELANCE\\atomic\\atomic-frontend\\pages\\index.js","C:\\Users\\dan82\\Documents\\workspace\\FREELANCE\\atomic\\atomic-frontend\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-client-pages-loader.js?page=%2F&absolutePagePath=private-next-pages%2Findex.js!"],"names":[],"mappings":"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","file":"x","sourcesContent":["import { useState, useEffect } from 'react';\nexport const useInfiniteScroll = fetchCallback => {\n  const [isFetching, setIsFetching] = useState(false);\n\n  const onScroll = () => {\n    const offsetHeight = document.documentElement.scrollHeight;\n    const innerHeight = window.innerHeight;\n    const scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;\n    if (isFetching || innerHeight + scrollTop !== offsetHeight) return;\n    setIsFetching(true);\n  };\n\n  useEffect(() => {\n    if (!isFetching) return;\n    fetchCallback();\n  }, [isFetching]);\n  useEffect(() => {\n    window.addEventListener('scroll', onScroll);\n    return () => window.removeEventListener('scroll', onScroll);\n  }, []);\n  return [isFetching, setIsFetching];\n};\nexport default useInfiniteScroll;","import React, { useState } from 'react';\nimport styled from 'styled-components';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { useQuery } from '@apollo/react-hooks';\nimport { v4 } from 'uuid';\nimport Alert from '../atomic-ui/components/Alert';\nimport Title from '../atomic-ui/components/Title';\nimport Spinner from '../atomic-ui/components/Spinner';\nimport { useHelper } from '../hooks/useHelper';\nimport { useMutate } from '../hooks/useMutate';\nimport { useInfiniteScroll } from '../hooks/useInfiniteScroll';\nimport DefaultLayout from '../layouts/default';\nimport ProjectCard from '../components/ProjectCard';\nimport ArticleCard from '../components/ArticleCard';\nimport UserCard from '../components/UserCard';\nimport { updateUser } from '../store/actions/user';\nimport { onProjectLink, onProjectAdd, onProjectScreenshot } from '../store/helpers/project';\nimport { onUserLink, onUserMembers } from '../store/helpers/user';\nimport { onArticleLink } from '../store/helpers/article';\nimport { onChat } from '../store/helpers';\nimport queries from '../graphql/queries';\nconst TITLE = 'Атомик';\nconst START_OFFSET = 13;\nconst LIMIT = 5;\nconst Container = styled.div.withConfig({\n  displayName: \"pages__Container\",\n  componentId: \"sc-1kp8388-0\"\n})([\"display:grid;grid-template-columns:1fr min-content;grid-gap:var(--default-gap);margin-bottom:80px;@media only screen and (max-width:1196px){grid-template-columns:1fr;}\"]);\nconst Projects = styled.aside.withConfig({\n  displayName: \"pages__Projects\",\n  componentId: \"sc-1kp8388-1\"\n})([\"display:grid;grid-template-columns:repeat(auto-fit,minmax(442px,1fr));grid-gap:var(--default-gap);grid-auto-rows:max-content;@media only screen and (max-width:768px){grid-template-columns:repeat(auto-fit,minmax(285px,1fr));}\"]);\nconst Aside = styled.aside.withConfig({\n  displayName: \"pages__Aside\",\n  componentId: \"sc-1kp8388-2\"\n})([\"display:flex;flex-direction:column;grid-gap:var(--default-gap);width:394px;@media only screen and (max-width:1196px){width:auto;}\"]);\nconst Loader = styled.div.withConfig({\n  displayName: \"pages__Loader\",\n  componentId: \"sc-1kp8388-3\"\n})([\"display:flex;justify-content:center;width:100%;height:80px;\"]);\n\nconst Home = ({\n  store\n}) => {\n  const recall = useHelper();\n  const mutate = useMutate();\n  const user = useSelector(state => state.user);\n  const dispatch = useDispatch();\n  const {\n    loading,\n    refetch\n  } = useQuery(queries.GET_PROJECTS, {\n    variables: {\n      offset: 0,\n      limit: LIMIT\n    }\n  });\n  const {\n    articles,\n    users\n  } = store;\n  const [projects, setProjects] = useState(store.projects || []);\n  const [offset, setOffset] = useState(START_OFFSET);\n  const [isFetching, setIsFetching] = useInfiniteScroll(async () => {\n    const response = await refetch({\n      offset,\n      limit: LIMIT\n    });\n\n    if (!response.errors) {\n      setProjects(prev => [...prev, ...response.data.getProjects]);\n    }\n\n    setOffset(prev => prev + LIMIT);\n    setIsFetching(false);\n  });\n  return /*#__PURE__*/React.createElement(DefaultLayout, {\n    title: TITLE,\n    scaffold: {\n      title: 'Создавай школу будущего с нами',\n      background: '/images/main-background.png',\n      primary: projects.length > 0 && projects[0],\n      residue: projects.length > 4 && projects.slice(1, 3),\n      onLink: (project, owned) => recall(onProjectLink, {\n        id: project.id,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        project,\n        liked: !!((user === null || user === void 0 ? void 0 : user.likedProjects) || []).find(item => item.id === project.id),\n        onLike: user.email && mutate(queries.LIKE_PROJECT, {\n          id: project.id\n        }, response => dispatch(updateUser(response.data.likeProject))),\n        onAdd: user.email && recall(onProjectAdd, {\n          id: project.id,\n          project,\n          folders: user === null || user === void 0 ? void 0 : user.folders,\n          mutations: {\n            addProject: queries.ADD_USER_PROJECT,\n            createFolder: queries.ADD_USER_FOLDER\n          }\n        }),\n        owned\n      })(),\n      onLike: user.email && (project => mutate(queries.LIKE_PROJECT, {\n        id: project.id\n      }, response => dispatch(updateUser(response.data.likeProject)))()),\n      onAdd: user.email && (project => recall(onProjectAdd, {\n        id: project.id,\n        project,\n        folders: user === null || user === void 0 ? void 0 : user.folders,\n        mutations: {\n          addProject: queries.ADD_USER_PROJECT,\n          createFolder: queries.ADD_USER_FOLDER\n        }\n      })()),\n      onCompanyLink: project => {\n        var _project$company;\n\n        return recall(onUserLink, {\n          id: (_project$company = project.company) === null || _project$company === void 0 ? void 0 : _project$company.email,\n          auth: user\n        })();\n      },\n      onScreenshotClick: (project, key) => recall(onProjectScreenshot, {\n        screenshots: [project.preview, ...project.screenshots],\n        key\n      })()\n    }\n  }, /*#__PURE__*/React.createElement(Container, null, /*#__PURE__*/React.createElement(Projects, null, projects.length > 3 ? projects.slice(3).map(project => {\n    var _user$projects, _user$folders, _project$company2;\n\n    const owned = user === null || user === void 0 ? void 0 : (_user$projects = user.projects) === null || _user$projects === void 0 ? void 0 : _user$projects.find(candidate => candidate.id === project.id);\n    return /*#__PURE__*/React.createElement(ProjectCard, {\n      key: v4(),\n      project: project,\n      owned: owned,\n      added: !!(user !== null && user !== void 0 && (_user$folders = user.folders) !== null && _user$folders !== void 0 && _user$folders.find(folder => !!(folder !== null && folder !== void 0 && folder.projects.find(item => item.id === project.id)))),\n      liked: !!((user === null || user === void 0 ? void 0 : user.likedProjects) || []).find(item => item.id === project.id),\n      onLink: recall(onProjectLink, {\n        id: project.id,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        liked: !!((user === null || user === void 0 ? void 0 : user.likedProjects) || []).find(item => item.id === project.id),\n        onLike: user.email && mutate(queries.LIKE_PROJECT, {\n          id: project.id\n        }, response => dispatch(updateUser(response.data.likeProject))),\n        onAdd: user.email && recall(onProjectAdd, {\n          id: project.id,\n          project,\n          folders: user === null || user === void 0 ? void 0 : user.folders,\n          mutations: {\n            addProject: queries.ADD_USER_PROJECT,\n            createFolder: queries.ADD_USER_FOLDER\n          }\n        }),\n        owned\n      }),\n      onLike: user.email && mutate(queries.LIKE_PROJECT, {\n        id: project.id\n      }, response => dispatch(updateUser(response.data.likeProject))),\n      onAdd: user.email && recall(onProjectAdd, {\n        id: project.id,\n        project,\n        folders: user === null || user === void 0 ? void 0 : user.folders,\n        mutations: {\n          addProject: queries.ADD_USER_PROJECT,\n          createFolder: queries.ADD_USER_FOLDER\n        }\n      }),\n      onCompanyLink: recall(onUserLink, {\n        id: (_project$company2 = project.company) === null || _project$company2 === void 0 ? void 0 : _project$company2.email,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        recipient: project.author,\n        query: queries.GET_USER_CHATS,\n        mutation: queries.SEND_MESSAGE\n      }),\n      onScreenshotClick: (_, key) => recall(onProjectScreenshot, {\n        screenshots: [project.preview, ...project.screenshots],\n        key\n      })()\n    });\n  }) : /*#__PURE__*/React.createElement(Alert, {\n    style: {\n      width: '100%',\n      textAlign: 'center'\n    }\n  }, \"\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u043E\\u0432 \\u043D\\u0435\\u0442\"), (loading || isFetching) && /*#__PURE__*/React.createElement(Loader, null, /*#__PURE__*/React.createElement(Spinner, null))), /*#__PURE__*/React.createElement(Aside, null, /*#__PURE__*/React.createElement(Title, {\n    tag: 'h4'\n  }, \"\\u0410\\u0432\\u0442\\u043E\\u0440\\u044B\"), users.length > 0 ? users.slice(0, 3).map(author => {\n    var _author$company;\n\n    const owned = author.name === (user === null || user === void 0 ? void 0 : user.name);\n    return /*#__PURE__*/React.createElement(UserCard, {\n      key: v4(),\n      user: author,\n      owned: owned,\n      onChat: user.email && recall(onChat, {\n        email: author.email,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        queries: {\n          userChats: queries.GET_USER_CHATS,\n          chat: queries.GET_CHAT\n        },\n        mutations: {\n          addUserChat: queries.ADD_USER_CHAT,\n          sendMessage: queries.SEND_MESSAGE\n        }\n      }),\n      onLink: recall(onUserLink, {\n        id: author.email,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        owned,\n        queries: {\n          userChats: queries.GET_USER_CHATS,\n          chat: queries.GET_CHAT\n        },\n        mutations: {\n          addUserChat: queries.ADD_USER_CHAT,\n          sendMessage: queries.SEND_MESSAGE\n        }\n      }),\n      onMembers: recall(onUserMembers, {\n        id: author === null || author === void 0 ? void 0 : author.email,\n        auth: user === null || user === void 0 ? void 0 : user.email\n      }),\n      onCompanyLink: recall(onUserLink, {\n        id: (_author$company = author.company) === null || _author$company === void 0 ? void 0 : _author$company.email,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        queries: {\n          userChats: queries.GET_USER_CHATS,\n          chat: queries.GET_CHAT\n        },\n        mutations: {\n          addUserChat: queries.ADD_USER_CHAT,\n          sendMessage: queries.SEND_MESSAGE\n        }\n      })\n    });\n  }) : /*#__PURE__*/React.createElement(Alert, {\n    style: {\n      width: '100%',\n      textAlign: 'center'\n    }\n  }, \"\\u0410\\u0432\\u0442\\u043E\\u0440\\u043E\\u0432 \\u043D\\u0435\\u0442\"), /*#__PURE__*/React.createElement(Title, {\n    tag: 'h4'\n  }, \"\\u041D\\u043E\\u0432\\u043E\\u0441\\u0442\\u0438\"), articles.length > 0 ? articles.slice(0, 2).map(article => {\n    var _user$articles;\n\n    return /*#__PURE__*/React.createElement(ArticleCard, {\n      key: v4(),\n      layout: 'column',\n      article: article,\n      owned: user === null || user === void 0 ? void 0 : (_user$articles = user.articles) === null || _user$articles === void 0 ? void 0 : _user$articles.find(candidate => candidate.id === article.id),\n      onLink: recall(onArticleLink, {\n        id: article.id,\n        auth: user === null || user === void 0 ? void 0 : user.email\n      })\n    });\n  }) : /*#__PURE__*/React.createElement(Alert, {\n    style: {\n      width: '100%',\n      textAlign: 'center'\n    }\n  }, \"\\u041D\\u043E\\u0432\\u043E\\u0441\\u0442\\u0435\\u0439 \\u043D\\u0435\\u0442\"))));\n};\n\nexport var __N_SSP = true;\nexport default Home;","\n      (window.__NEXT_P = window.__NEXT_P || []).push([\n        \"/\",\n        function () {\n          return require(\"private-next-pages/index.js\");\n        }\n      ]);\n    "]}}