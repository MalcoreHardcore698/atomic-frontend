{"ast":null,"code":"var _s = $RefreshSig$();\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React, { useMemo } from 'react';\nimport Head from 'next/head';\nimport Link from 'next/link';\nimport { useRouter } from 'next/router';\nimport styled, { css } from 'styled-components';\nimport { useQuery } from '@apollo/react-hooks';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { v4 } from 'uuid';\nimport Image from '../atomic-ui/components/Image';\nimport Spinner from '../atomic-ui/components/Spinner';\nimport { useMutate } from '../hooks/useMutate';\nimport { useHelper } from '../hooks/useHelper';\nimport MainLayout from './main';\nimport Scaffold from '../components/Scaffold';\nimport AppBar from '../components/AppBar';\nimport Footer from '../components/Footer';\nimport { FixedLoader } from '../components/Styled';\nimport { setLogout } from '../store/actions/user';\nimport { setDrawer } from '../store/actions/drawer';\nimport { onMenu, onHelp, onNotification, onChat } from '../store/helpers';\nimport { onUserClientEdit } from '../store/helpers/user';\nimport queries from '../graphql/queries';\nimport { supportLinks, socials, contacts } from '../__mock__';\nvar Wrap = styled.div.withConfig({\n  displayName: \"default__Wrap\",\n  componentId: \"sc-2byuzg-0\"\n})([\"position:relative;top:-20px;display:flex;flex-direction:column;justify-content:space-between;height:100vh;z-index:2;\"]);\n_c = Wrap;\nvar Background = styled(Image).withConfig({\n  displayName: \"default__Background\",\n  componentId: \"sc-2byuzg-1\"\n})([\"position:absolute;top:0;left:0;width:100%;height:auto;object-fit:contain;z-index:1;\"]);\n_c2 = Background;\nvar Main = styled.main.withConfig({\n  displayName: \"default__Main\",\n  componentId: \"sc-2byuzg-2\"\n})([\"padding:50px var(--main-offset-l);flex-grow:100;@media only screen and (max-width:996px){padding:25px var(--main-offset-m);}@media only screen and (max-width:768px){padding:25px var(--main-offset-s);}@media only screen and (max-width:480px){padding:25px var(--main-offset-xs);}\"]);\n_c3 = Main;\nvar Anchor = styled.a.withConfig({\n  displayName: \"default__Anchor\",\n  componentId: \"sc-2byuzg-3\"\n})([\"border-radius:25rem;padding:5px 15px;background:transparent;color:black;transition:all 150ms ease;\", \" \", \"\"], function (_ref) {\n  var link = _ref.link;\n  return link && css([\"&:hover{opacity:0.65;}\"]);\n}, function (_ref2) {\n  var active = _ref2.active,\n      link = _ref2.link;\n  return active && link && css([\"background:var(--default-color-accent-dim);color:var(--default-color-accent-link);&:hover{opacity:1;}\"]);\n});\n_c4 = Anchor;\nexport var DefaultLayout = function DefaultLayout(_ref3) {\n  _s();\n\n  var children = _ref3.children,\n      _ref3$title = _ref3.title,\n      title = _ref3$title === void 0 ? 'Атомик' : _ref3$title,\n      scaffold = _ref3.scaffold,\n      background = _ref3.background;\n  var recall = useHelper();\n  var mutate = useMutate();\n  var router = useRouter();\n\n  var _useQuery = useQuery(queries.GET_CATEGORIES),\n      data = _useQuery.data,\n      loading = _useQuery.loading;\n\n  var _useSelector = useSelector(function (state) {\n    return {\n      user: state.user\n    };\n  }),\n      user = _useSelector.user;\n\n  var dispatch = useDispatch();\n  var categories = useMemo(function () {\n    return (data === null || data === void 0 ? void 0 : data.getCategories) || [];\n  }, [data]);\n  var isProjects = router.pathname.includes('projects');\n  var categoryId = router.query.category;\n\n  if (loading) {\n    return /*#__PURE__*/React.createElement(FixedLoader, null, /*#__PURE__*/React.createElement(Spinner, null));\n  }\n\n  return /*#__PURE__*/React.createElement(MainLayout, null, /*#__PURE__*/React.createElement(Head, null, /*#__PURE__*/React.createElement(\"meta\", {\n    name: \"keywords\",\n    content: \"next,javascript,nextjs,react\"\n  }), /*#__PURE__*/React.createElement(\"meta\", {\n    name: \"description\",\n    content: \"atomic project description\"\n  }), /*#__PURE__*/React.createElement(\"title\", null, title)), /*#__PURE__*/React.createElement(Background, {\n    src: background,\n    alt: 'Background'\n  }), /*#__PURE__*/React.createElement(Wrap, null, /*#__PURE__*/React.createElement(AppBar, {\n    user: user.authenticated ? user : null,\n    logotype: '/images/logo.png',\n    link: function link(_ref4) {\n      var children = _ref4.children,\n          href = _ref4.href,\n          props = _objectWithoutProperties(_ref4, [\"children\", \"href\"]);\n\n      return /*#__PURE__*/React.createElement(Link, _extends({}, props, {\n        href: href\n      }), /*#__PURE__*/React.createElement(Anchor, {\n        active: router.pathname === href,\n        link: children.type.target === 'span'\n      }, children));\n    },\n    links: [{\n      label: 'Проекты',\n      props: {\n        sublinks: categories.filter(function (category) {\n          return category.type === 'DIVISION';\n        }).map(function (category) {\n          return {\n            label: category.name,\n            props: {\n              active: categoryId === category.id,\n              onClick: function onClick() {\n                return router.push(\"/projects?category=\".concat(category.id));\n              }\n            }\n          };\n        })\n      },\n      active: isProjects\n    }, {\n      label: 'Авторы',\n      props: {\n        href: '/creators'\n      }\n    }, {\n      label: 'Новости',\n      props: {\n        href: '/articles'\n      }\n    }, {\n      label: 'О ресурсе',\n      props: {\n        href: '/about'\n      }\n    }],\n    onMenu: recall(onMenu, {\n      links: [{\n        text: 'Проекты',\n        onClick: function onClick() {\n          dispatch(setDrawer(null));\n          router.push('/projects');\n        }\n      }, {\n        text: 'Авторы',\n        onClick: function onClick() {\n          dispatch(setDrawer(null));\n          router.push('/creators');\n        }\n      }, {\n        text: 'Новости',\n        onClick: function onClick() {\n          dispatch(setDrawer(null));\n          router.push('/articles');\n        }\n      }, {\n        text: 'О ресурсе',\n        onClick: function onClick() {\n          dispatch(setDrawer(null));\n          router.push('/about');\n        }\n      }]\n    }),\n    onHelp: recall(onHelp, {\n      mutation: queries.CREATE_USER_TICKET\n    }),\n    onChat: recall(onChat, {\n      sender: user,\n      queries: {\n        userChats: queries.GET_USER_CHATS,\n        chat: queries.GET_CHAT\n      },\n      mutations: {\n        addUserChat: queries.ADD_USER_CHAT,\n        sendMessage: queries.SEND_MESSAGE\n      }\n    }),\n    onSettings: recall(onUserClientEdit, {\n      user: user === null || user === void 0 ? void 0 : user.email,\n      mutations: {\n        update: queries.UPDATE_CLIENT_USER,\n        del: queries.DELETE_USER,\n        changePassword: queries.UPDATE_CLIENT_USER\n      }\n    }),\n    onNotification: recall(onNotification, {\n      notifications: user.notifications\n    }),\n    onProfile: function onProfile() {\n      return router.push('/profile');\n    },\n    onLogin: function onLogin() {\n      return router.push('/auth');\n    },\n    onLogout: mutate(queries.LOGOUT, {}, function () {\n      return dispatch(setLogout());\n    })\n  }), scaffold && /*#__PURE__*/React.createElement(Scaffold, _extends({\n    user: user\n  }, scaffold)), /*#__PURE__*/React.createElement(Main, {\n    id: 'main'\n  }, children), /*#__PURE__*/React.createElement(Footer, {\n    contacts: contacts,\n    socials: socials,\n    catalog: {\n      title: 'Каталог',\n      links: categories.filter(function (category) {\n        return category.type === 'DIVISION';\n      }).map(function (link) {\n        return /*#__PURE__*/React.createElement(Link, {\n          key: v4(),\n          href: \"/projects?category=\".concat(link.id)\n        }, /*#__PURE__*/React.createElement(\"a\", null, link.name));\n      })\n    },\n    support: {\n      title: 'О компании',\n      links: supportLinks.map(function (link) {\n        return /*#__PURE__*/React.createElement(Link, {\n          key: v4(),\n          href: link.path\n        }, /*#__PURE__*/React.createElement(\"a\", null, link.label));\n      })\n    }\n  })));\n};\n\n_s(DefaultLayout, \"GGUhLwl63h3LD67/JOIDDvWRVZM=\", false, function () {\n  return [useHelper, useMutate, useRouter, useQuery, useSelector, useDispatch];\n});\n\n_c5 = DefaultLayout;\nexport default DefaultLayout;\n\nvar _c, _c2, _c3, _c4, _c5;\n\n$RefreshReg$(_c, \"Wrap\");\n$RefreshReg$(_c2, \"Background\");\n$RefreshReg$(_c3, \"Main\");\n$RefreshReg$(_c4, \"Anchor\");\n$RefreshReg$(_c5, \"DefaultLayout\");","map":{"version":3,"sources":["C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/layouts/default.js"],"names":["React","useMemo","Head","Link","useRouter","styled","css","useQuery","useSelector","useDispatch","v4","Image","Spinner","useMutate","useHelper","MainLayout","Scaffold","AppBar","Footer","FixedLoader","setLogout","setDrawer","onMenu","onHelp","onNotification","onChat","onUserClientEdit","queries","supportLinks","socials","contacts","Wrap","div","Background","Main","main","Anchor","a","link","active","DefaultLayout","children","title","scaffold","background","recall","mutate","router","GET_CATEGORIES","data","loading","state","user","dispatch","categories","getCategories","isProjects","pathname","includes","categoryId","query","category","authenticated","href","props","type","target","label","sublinks","filter","map","name","id","onClick","push","links","text","mutation","CREATE_USER_TICKET","sender","userChats","GET_USER_CHATS","chat","GET_CHAT","mutations","addUserChat","ADD_USER_CHAT","sendMessage","SEND_MESSAGE","email","update","UPDATE_CLIENT_USER","del","DELETE_USER","changePassword","notifications","LOGOUT","path"],"mappings":"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","sourcesContent":["import React, { useMemo } from 'react'\nimport Head from 'next/head'\nimport Link from 'next/link'\nimport { useRouter } from 'next/router'\nimport styled, { css } from 'styled-components'\nimport { useQuery } from '@apollo/react-hooks'\nimport { useSelector, useDispatch } from 'react-redux'\nimport { v4 } from 'uuid'\n\nimport Image from '../atomic-ui/components/Image'\nimport Spinner from '../atomic-ui/components/Spinner'\n\nimport { useMutate } from '../hooks/useMutate'\nimport { useHelper } from '../hooks/useHelper'\nimport MainLayout from './main'\nimport Scaffold from '../components/Scaffold'\nimport AppBar from '../components/AppBar'\nimport Footer from '../components/Footer'\nimport { FixedLoader } from '../components/Styled'\nimport { setLogout } from '../store/actions/user'\nimport { setDrawer } from '../store/actions/drawer'\nimport { onMenu, onHelp, onNotification, onChat } from '../store/helpers'\nimport { onUserClientEdit } from '../store/helpers/user'\nimport queries from '../graphql/queries'\nimport { supportLinks, socials, contacts } from '../__mock__'\n\nconst Wrap = styled.div`\n  position: relative;\n  top: -20px;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  height: 100vh;\n  z-index: 2;\n`\n\nconst Background = styled(Image)`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: auto;\n  object-fit: contain;\n  z-index: 1;\n`\n\nconst Main = styled.main`\n  padding: 50px var(--main-offset-l);\n  flex-grow: 100;\n\n  @media only screen and (max-width: 996px) {\n    padding: 25px var(--main-offset-m);\n  }\n\n  @media only screen and (max-width: 768px) {\n    padding: 25px var(--main-offset-s);\n  }\n\n  @media only screen and (max-width: 480px) {\n    padding: 25px var(--main-offset-xs);\n  }\n`\n\nconst Anchor = styled.a`\n  border-radius: 25rem;\n  padding: 5px 15px;\n  background: transparent;\n  color: black;\n  transition: all 150ms ease;\n\n  ${({ link }) =>\n    link &&\n    css`\n      &:hover {\n        opacity: 0.65;\n      }\n    `}\n\n  ${({ active, link }) =>\n    active &&\n    link &&\n    css`\n      background: var(--default-color-accent-dim);\n      color: var(--default-color-accent-link);\n\n      &:hover {\n        opacity: 1;\n      }\n    `}\n`\n\nexport const DefaultLayout = ({ children, title = 'Атомик', scaffold, background }) => {\n  const recall = useHelper()\n  const mutate = useMutate()\n  const router = useRouter()\n  const { data, loading } = useQuery(queries.GET_CATEGORIES)\n  const { user } = useSelector((state) => ({\n    user: state.user\n  }))\n  const dispatch = useDispatch()\n  const categories = useMemo(() => data?.getCategories || [], [data])\n\n  const isProjects = router.pathname.includes('projects')\n  const categoryId = router.query.category\n\n  if (loading) {\n    return (\n      <FixedLoader>\n        <Spinner />\n      </FixedLoader>\n    )\n  }\n\n  return (\n    <MainLayout>\n      <Head>\n        <meta name=\"keywords\" content=\"next,javascript,nextjs,react\" />\n        <meta name=\"description\" content=\"atomic project description\" />\n        <title>{title}</title>\n      </Head>\n\n      <Background src={background} alt={'Background'} />\n\n      <Wrap>\n        <AppBar\n          user={user.authenticated ? user : null}\n          logotype={'/images/logo.png'}\n          link={({ children, href, ...props }) => (\n            <Link {...props} href={href}>\n              <Anchor active={router.pathname === href} link={children.type.target === 'span'}>\n                {children}\n              </Anchor>\n            </Link>\n          )}\n          links={[\n            {\n              label: 'Проекты',\n              props: {\n                sublinks: categories\n                  .filter((category) => category.type === 'DIVISION')\n                  .map((category) => ({\n                    label: category.name,\n                    props: {\n                      active: categoryId === category.id,\n                      onClick: () => router.push(`/projects?category=${category.id}`)\n                    }\n                  }))\n              },\n              active: isProjects\n            },\n            { label: 'Авторы', props: { href: '/creators' } },\n            { label: 'Новости', props: { href: '/articles' } },\n            { label: 'О ресурсе', props: { href: '/about' } }\n          ]}\n          onMenu={recall(onMenu, {\n            links: [\n              {\n                text: 'Проекты',\n                onClick: () => {\n                  dispatch(setDrawer(null))\n                  router.push('/projects')\n                }\n              },\n              {\n                text: 'Авторы',\n                onClick: () => {\n                  dispatch(setDrawer(null))\n                  router.push('/creators')\n                }\n              },\n              {\n                text: 'Новости',\n                onClick: () => {\n                  dispatch(setDrawer(null))\n                  router.push('/articles')\n                }\n              },\n              {\n                text: 'О ресурсе',\n                onClick: () => {\n                  dispatch(setDrawer(null))\n                  router.push('/about')\n                }\n              }\n            ]\n          })}\n          onHelp={recall(onHelp, {\n            mutation: queries.CREATE_USER_TICKET\n          })}\n          onChat={recall(onChat, {\n            sender: user,\n            queries: {\n              userChats: queries.GET_USER_CHATS,\n              chat: queries.GET_CHAT\n            },\n            mutations: {\n              addUserChat: queries.ADD_USER_CHAT,\n              sendMessage: queries.SEND_MESSAGE\n            }\n          })}\n          onSettings={recall(onUserClientEdit, {\n            user: user?.email,\n            mutations: {\n              update: queries.UPDATE_CLIENT_USER,\n              del: queries.DELETE_USER,\n              changePassword: queries.UPDATE_CLIENT_USER\n            }\n          })}\n          onNotification={recall(onNotification, { notifications: user.notifications })}\n          onProfile={() => router.push('/profile')}\n          onLogin={() => router.push('/auth')}\n          onLogout={mutate(queries.LOGOUT, {}, () => dispatch(setLogout()))}\n        />\n\n        {scaffold && <Scaffold user={user} {...scaffold} />}\n\n        <Main id={'main'}>{children}</Main>\n\n        <Footer\n          contacts={contacts}\n          socials={socials}\n          catalog={{\n            title: 'Каталог',\n            links: categories\n              .filter((category) => category.type === 'DIVISION')\n              .map((link) => (\n                <Link key={v4()} href={`/projects?category=${link.id}`}>\n                  <a>{link.name}</a>\n                </Link>\n              ))\n          }}\n          support={{\n            title: 'О компании',\n            links: supportLinks.map((link) => (\n              <Link key={v4()} href={link.path}>\n                <a>{link.label}</a>\n              </Link>\n            ))\n          }}\n        />\n      </Wrap>\n    </MainLayout>\n  )\n}\n\nexport default DefaultLayout\n"]},"metadata":{},"sourceType":"module"}