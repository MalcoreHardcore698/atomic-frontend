{"ast":null,"code":"import React, { useState, useEffect, useMemo } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport Grid from '../../atomic-ui/components/Grid';\nimport Table from '../../atomic-ui/components/Table';\nimport templates from '../../atomic-ui/components/Table/templates';\nimport { initializeApollo } from '../../apollo';\nimport { useHelper } from '../../hooks/useHelper';\nimport ContentLayout from '../../layouts/content';\nimport UserCard from '../../components/UserCard';\nimport { onUserCreate, onUserEdit, onUserDelete, onUserLink, onUserAboutMore } from '../../store/helpers/user';\nimport { setDocuments } from '../../store/actions/documents';\nimport { onChat } from '../../store/helpers';\nimport queries from '../../graphql/queries';\nconst TITLE = 'Пользователи';\nconst START_OFFSET = 12;\nconst LIMIT = 12;\n\nconst Users = ({\n  store\n}) => {\n  const recall = useHelper();\n  const {\n    user,\n    documents\n  } = useSelector(state => ({\n    user: state.user,\n    documents: state.documents\n  }));\n  const dispatch = useDispatch();\n  const [displayMethod, onChangeDisplayMethod] = useState('grid');\n  const canEditRole = useMemo(() => user && user.role.name === 'ADMIN', [user]);\n  const roles = useMemo(() => store.roles, [store]);\n  useEffect(() => {\n    dispatch(setDocuments(null));\n  }, []);\n  return /*#__PURE__*/React.createElement(ContentLayout, {\n    title: TITLE,\n    filters: [{\n      type: 'DATEPICKER',\n      placeholder: 'Дата регистарции'\n    }, {\n      type: 'SELECT',\n      placeholder: 'Компания',\n      options: []\n    }],\n    options: [{\n      label: 'Компания',\n      value: 'company'\n    }, {\n      label: 'Участники',\n      value: 'members'\n    }, {\n      label: 'Дата регистарции',\n      value: 'createdAt'\n    }],\n    handle: {\n      icon: 'user2',\n      buttonCreateText: 'Создать пользователя',\n      onCreate: recall(onUserCreate, {\n        roles,\n        canEditRole,\n        mutation: queries.CREATE_USER\n      }),\n      onChangeDisplayMethod: item => onChangeDisplayMethod(item.value)\n    },\n    limit: LIMIT,\n    startOffset: START_OFFSET,\n    bottomScrollOffset: 0,\n    query: queries.GET_USERS,\n    store: {\n      documents: documents || store.users\n    },\n    dashboard: true\n  }, ({\n    documents\n  }) => displayMethod === 'list' ? /*#__PURE__*/React.createElement(Table, {\n    data: documents,\n    template: templates.user,\n    onChecked: () => {},\n    onClick: author => {\n      const owned = author.name === user.name;\n      return recall(onUserLink, {\n        id: author.email,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        owned,\n        queries: {\n          userChats: queries.GET_USER_CHATS,\n          chat: queries.GET_CHAT\n        },\n        mutations: {\n          addUserChat: queries.ADD_USER_CHAT,\n          sendMessage: queries.SEND_MESSAGE\n        }\n      })();\n    },\n    onDelete: author => recall(onUserDelete, {\n      id: author.email,\n      user: author,\n      auth: user === null || user === void 0 ? void 0 : user.email,\n      mutation: queries.DELETE_USER\n    })(),\n    onEdit: author => recall(onUserEdit, {\n      user: author.email,\n      auth: user === null || user === void 0 ? void 0 : user.email,\n      roles,\n      canEditRole,\n      mutations: {\n        update: queries.UPDATE_USER,\n        del: queries.DELETE_USER,\n        changePassword: queries.UPDATE_USER\n      }\n    })(),\n    style: {\n      overflowX: 'auto',\n      width: 'calc(100vw - 290px)'\n    }\n  }) : /*#__PURE__*/React.createElement(Grid, null, documents.map(author => {\n    const owned = author.name === user.name;\n    return /*#__PURE__*/React.createElement(UserCard, {\n      key: author.email,\n      user: author,\n      onChecked: () => {},\n      onChat: user.email && recall(onChat, {\n        id: author.email,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        queries: {\n          userChats: queries.GET_USER_CHATS,\n          chat: queries.GET_CHAT\n        },\n        mutations: {\n          addUserChat: queries.ADD_USER_CHAT,\n          sendMessage: queries.SEND_MESSAGE\n        }\n      }),\n      onLink: recall(onUserLink, {\n        id: author.email,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        owned,\n        queries: {\n          userChats: queries.GET_USER_CHATS,\n          chat: queries.GET_CHAT\n        },\n        mutations: {\n          addUserChat: queries.ADD_USER_CHAT,\n          sendMessage: queries.SEND_MESSAGE\n        }\n      }),\n      onAboutMore: recall(onUserAboutMore, {\n        user: author\n      }),\n      onDelete: recall(onUserDelete, {\n        id: author.email,\n        user: author,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        mutation: queries.DELETE_USER\n      }),\n      onEdit: recall(onUserEdit, {\n        user: author.email,\n        auth: user === null || user === void 0 ? void 0 : user.email,\n        roles,\n        canEditRole,\n        mutations: {\n          update: queries.UPDATE_USER,\n          del: queries.DELETE_USER,\n          changePassword: queries.UPDATE_USER\n        }\n      }),\n      preview: true\n    });\n  })));\n};\n\nexport async function getServerSideProps() {\n  const client = initializeApollo();\n  let users = [];\n  let roles = [];\n\n  try {\n    const response = await client.query({\n      query: queries.GET_META_DASHBOARD_USERS,\n      variables: {\n        offset: 0,\n        limit: LIMIT\n      }\n    });\n\n    if (response && response.data) {\n      users = response.data.getUsers;\n      roles = response.data.getRoles;\n    }\n  } catch (err) {\n    console.log(err);\n  }\n\n  return {\n    props: {\n      store: {\n        users,\n        roles\n      }\n    }\n  };\n}\nexport default Users;","map":{"version":3,"sources":["C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/pages/dashboard/users.js"],"names":["React","useState","useEffect","useMemo","useDispatch","useSelector","Grid","Table","templates","initializeApollo","useHelper","ContentLayout","UserCard","onUserCreate","onUserEdit","onUserDelete","onUserLink","onUserAboutMore","setDocuments","onChat","queries","TITLE","START_OFFSET","LIMIT","Users","store","recall","user","documents","state","dispatch","displayMethod","onChangeDisplayMethod","canEditRole","role","name","roles","type","placeholder","options","label","value","icon","buttonCreateText","onCreate","mutation","CREATE_USER","item","GET_USERS","users","author","owned","id","email","auth","userChats","GET_USER_CHATS","chat","GET_CHAT","mutations","addUserChat","ADD_USER_CHAT","sendMessage","SEND_MESSAGE","DELETE_USER","update","UPDATE_USER","del","changePassword","overflowX","width","map","getServerSideProps","client","response","query","GET_META_DASHBOARD_USERS","variables","offset","limit","data","getUsers","getRoles","err","console","log","props"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useMemo } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\n\nimport Grid from '../../atomic-ui/components/Grid'\nimport Table from '../../atomic-ui/components/Table'\nimport templates from '../../atomic-ui/components/Table/templates'\n\nimport { initializeApollo } from '../../apollo'\nimport { useHelper } from '../../hooks/useHelper'\nimport ContentLayout from '../../layouts/content'\nimport UserCard from '../../components/UserCard'\nimport {\n  onUserCreate,\n  onUserEdit,\n  onUserDelete,\n  onUserLink,\n  onUserAboutMore\n} from '../../store/helpers/user'\nimport { setDocuments } from '../../store/actions/documents'\nimport { onChat } from '../../store/helpers'\nimport queries from '../../graphql/queries'\n\nconst TITLE = 'Пользователи'\nconst START_OFFSET = 12\nconst LIMIT = 12\n\nconst Users = ({ store }) => {\n  const recall = useHelper()\n  const { user, documents } = useSelector((state) => ({\n    user: state.user,\n    documents: state.documents\n  }))\n  const dispatch = useDispatch()\n  const [displayMethod, onChangeDisplayMethod] = useState('grid')\n  const canEditRole = useMemo(() => user && user.role.name === 'ADMIN', [user])\n  const roles = useMemo(() => store.roles, [store])\n\n  useEffect(() => {\n    dispatch(setDocuments(null))\n  }, [])\n\n  return (\n    <ContentLayout\n      title={TITLE}\n      filters={[\n        { type: 'DATEPICKER', placeholder: 'Дата регистарции' },\n        {\n          type: 'SELECT',\n          placeholder: 'Компания',\n          options: []\n        }\n      ]}\n      options={[\n        { label: 'Компания', value: 'company' },\n        { label: 'Участники', value: 'members' },\n        { label: 'Дата регистарции', value: 'createdAt' }\n      ]}\n      handle={{\n        icon: 'user2',\n        buttonCreateText: 'Создать пользователя',\n        onCreate: recall(onUserCreate, {\n          roles,\n          canEditRole,\n          mutation: queries.CREATE_USER\n        }),\n        onChangeDisplayMethod: (item) => onChangeDisplayMethod(item.value)\n      }}\n      limit={LIMIT}\n      startOffset={START_OFFSET}\n      bottomScrollOffset={0}\n      query={queries.GET_USERS}\n      store={{ documents: documents || store.users }}\n      dashboard>\n      {({ documents }) =>\n        displayMethod === 'list' ? (\n          <Table\n            data={documents}\n            template={templates.user}\n            onChecked={() => {}}\n            onClick={(author) => {\n              const owned = author.name === user.name\n\n              return recall(onUserLink, {\n                id: author.email,\n                auth: user?.email,\n                owned,\n                queries: {\n                  userChats: queries.GET_USER_CHATS,\n                  chat: queries.GET_CHAT\n                },\n                mutations: {\n                  addUserChat: queries.ADD_USER_CHAT,\n                  sendMessage: queries.SEND_MESSAGE\n                }\n              })()\n            }}\n            onDelete={(author) =>\n              recall(onUserDelete, {\n                id: author.email,\n                user: author,\n                auth: user?.email,\n                mutation: queries.DELETE_USER\n              })()\n            }\n            onEdit={(author) =>\n              recall(onUserEdit, {\n                user: author.email,\n                auth: user?.email,\n                roles,\n                canEditRole,\n                mutations: {\n                  update: queries.UPDATE_USER,\n                  del: queries.DELETE_USER,\n                  changePassword: queries.UPDATE_USER\n                }\n              })()\n            }\n            style={{ overflowX: 'auto', width: 'calc(100vw - 290px)' }}\n          />\n        ) : (\n          <Grid>\n            {documents.map((author) => {\n              const owned = author.name === user.name\n              return (\n                <UserCard\n                  key={author.email}\n                  user={author}\n                  onChecked={() => {}}\n                  onChat={\n                    user.email &&\n                    recall(onChat, {\n                      id: author.email,\n                      auth: user?.email,\n                      queries: {\n                        userChats: queries.GET_USER_CHATS,\n                        chat: queries.GET_CHAT\n                      },\n                      mutations: {\n                        addUserChat: queries.ADD_USER_CHAT,\n                        sendMessage: queries.SEND_MESSAGE\n                      }\n                    })\n                  }\n                  onLink={recall(onUserLink, {\n                    id: author.email,\n                    auth: user?.email,\n                    owned,\n                    queries: {\n                      userChats: queries.GET_USER_CHATS,\n                      chat: queries.GET_CHAT\n                    },\n                    mutations: {\n                      addUserChat: queries.ADD_USER_CHAT,\n                      sendMessage: queries.SEND_MESSAGE\n                    }\n                  })}\n                  onAboutMore={recall(onUserAboutMore, { user: author })}\n                  onDelete={recall(onUserDelete, {\n                    id: author.email,\n                    user: author,\n                    auth: user?.email,\n                    mutation: queries.DELETE_USER\n                  })}\n                  onEdit={recall(onUserEdit, {\n                    user: author.email,\n                    auth: user?.email,\n                    roles,\n                    canEditRole,\n                    mutations: {\n                      update: queries.UPDATE_USER,\n                      del: queries.DELETE_USER,\n                      changePassword: queries.UPDATE_USER\n                    }\n                  })}\n                  preview\n                />\n              )\n            })}\n          </Grid>\n        )\n      }\n    </ContentLayout>\n  )\n}\n\nexport async function getServerSideProps() {\n  const client = initializeApollo()\n\n  let users = []\n  let roles = []\n\n  try {\n    const response = await client.query({\n      query: queries.GET_META_DASHBOARD_USERS,\n      variables: {\n        offset: 0,\n        limit: LIMIT\n      }\n    })\n\n    if (response && response.data) {\n      users = response.data.getUsers\n      roles = response.data.getRoles\n    }\n  } catch (err) {\n    console.log(err)\n  }\n\n  return {\n    props: {\n      store: {\n        users,\n        roles\n      }\n    }\n  }\n}\n\nexport default Users\n"]},"metadata":{},"sourceType":"module"}