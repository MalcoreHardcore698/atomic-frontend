{"ast":null,"code":"import _extends from \"C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/node_modules/@babel/runtime/helpers/esm/extends\";\nimport _regeneratorRuntime from \"C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/node_modules/@babel/runtime/regenerator\";\nimport _defineProperty from \"C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _taggedTemplateLiteral from \"C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\dan82\\\\Documents\\\\workspace\\\\FREELANCE\\\\atomic\\\\atomic-frontend\\\\atomic-ui\\\\components\\\\Dropzone\\\\index.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _templateObject10() {\n  var data = _taggedTemplateLiteral([\"\\n  color: inherit;\\n  padding: var(--default-gap);\\n  text-align: center;\\n\"]);\n\n  _templateObject10 = function _templateObject10() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject9() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  object-fit: cover;\\n  border-radius: var(--surface-border-radius);\\n\"]);\n\n  _templateObject9 = function _templateObject9() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject8() {\n  var data = _taggedTemplateLiteral([\"\\n  img {\\n    height: 128px;\\n  }\\n\"]);\n\n  _templateObject8 = function _templateObject8() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject7() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  width: 100%;\\n  height: 100%;\\n\"]);\n\n  _templateObject7 = function _templateObject7() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6() {\n  var data = _taggedTemplateLiteral([\"\\n        color: var(--default-color-red);\\n        border: 2px dashed var(--default-color-red);\\n      \"]);\n\n  _templateObject6 = function _templateObject6() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5() {\n  var data = _taggedTemplateLiteral([\"\\n      color: var(--default-color-red);\\n      border: 2px dashed var(--default-color-red);\\n    \"]);\n\n  _templateObject5 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n\\n  position: relative;\\n  z-index: var(--z-12);\\n\\n  font-weight: var(--font-weight-medium);\\n  font-size: var(--font-size-s);\\n  font-family: var(--font-family);\\n  color: var(--input-placeholder-color);\\n\\n  width: 100%;\\n  height: 100%;\\n  border-radius: var(--surface-border-radius);\\n  border: 2px dashed var(--input-placeholder-color);\\n  outline: none;\\n  overflow: hidden;\\n  flex-grow: 1;\\n\\n  cursor: pointer;\\n  transition: all 150ms ease;\\n\\n  \", \"\\n\\n  &:hover {\\n    color: var(--default-color-accent);\\n    border: 2px dashed var(--default-color-accent);\\n\\n    \", \"\\n  }\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n  cursor: pointer;\\n  transition: opacity 450ms ease;\\n\\n  &:hover {\\n    opacity: 0.65;\\n  }\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  right: var(--default-gap);\\n  bottom: var(--default-gap);\\n  z-index: var(--z-15);\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  position: relative;\\n  display: flex;\\n  flex-direction: column;\\n  grid-gap: 10px;\\n\\n  width: 100%;\\n  height: 256px;\\n  min-height: 256px;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, useCallback } from 'react';\nimport styled, { css } from 'styled-components';\nimport imageCompression from 'browser-image-compression';\nimport { useDropzone } from 'react-dropzone';\nimport { v4 } from 'uuid';\nimport Image from '../Image';\nimport Text from '../Text';\nimport Grid from '../Grid';\nimport Tooltip from '../Tooltip';\nimport Icon from '../Icon';\nexport var Wrap = styled.div(_templateObject());\n_c = Wrap;\nexport var InfoTooltip = styled(Tooltip)(_templateObject2());\n_c2 = InfoTooltip;\nexport var InfoIcon = styled(Icon)(_templateObject3());\n_c3 = InfoIcon;\nexport var Container = styled.div(_templateObject4(), function (_ref) {\n  var error = _ref.error;\n  return error && css(_templateObject5());\n}, function (_ref2) {\n  var error = _ref2.error;\n  return error && css(_templateObject6());\n});\n_c4 = Container;\nexport var Area = styled.div(_templateObject7());\n_c5 = Area;\nexport var PreviewList = styled(Grid)(_templateObject8());\n_c6 = PreviewList;\nexport var Preview = styled(Image)(_templateObject9());\n_c7 = Preview;\nexport var Placeholder = styled(Text)(_templateObject10());\n_c8 = Placeholder;\nexport function getFile(file) {\n  var _file$type;\n\n  return {\n    file: file,\n    id: v4(),\n    blob: ((_file$type = file.type) === null || _file$type === void 0 ? void 0 : _file$type.includes('image')) && URL.createObjectURL(file)\n  };\n}\nexport function compressedUpload(_x) {\n  return _compressedUpload.apply(this, arguments);\n}\n\nfunction _compressedUpload() {\n  _compressedUpload = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(file) {\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return imageCompression(file, {\n              maxSizeMB: 1,\n              maxWidthOrHeight: 1920,\n              useWebWorker: true\n            });\n\n          case 3:\n            return _context2.abrupt(\"return\", _context2.sent);\n\n          case 6:\n            _context2.prev = 6;\n            _context2.t0 = _context2[\"catch\"](0);\n            console.log(_context2.t0);\n\n          case 9:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[0, 6]]);\n  }));\n  return _compressedUpload.apply(this, arguments);\n}\n\nexport var Dropzone = function Dropzone(_ref3) {\n  _s();\n\n  var style = _ref3.style,\n      accept = _ref3.accept,\n      className = _ref3.className,\n      defaultValue = _ref3.defaultValue,\n      placeholder = _ref3.placeholder,\n      tooltip = _ref3.tooltip,\n      multiple = _ref3.multiple,\n      maxFiles = _ref3.maxFiles,\n      onChange = _ref3.onChange;\n\n  var _useState = useState(false),\n      error = _useState[0],\n      setError = _useState[1];\n\n  var _useState2 = useState([]),\n      images = _useState2[0],\n      setImages = _useState2[1];\n\n  var onDrop = useCallback( /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(droppedFiles) {\n      var candidate, _iterator, _step, file, compressedFile, result;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setError(false);\n\n              if (!(droppedFiles.length > maxFiles || droppedFiles.length === 0)) {\n                _context.next = 4;\n                break;\n              }\n\n              setError(true);\n              return _context.abrupt(\"return\", false);\n\n            case 4:\n              if (!multiple) {\n                _context.next = 8;\n                break;\n              }\n\n              _context.t0 = [];\n              _context.next = 11;\n              break;\n\n            case 8:\n              _context.next = 10;\n              return compressedUpload(droppedFiles[0]);\n\n            case 10:\n              _context.t0 = _context.sent;\n\n            case 11:\n              candidate = _context.t0;\n\n              if (!multiple) {\n                _context.next = 37;\n                break;\n              }\n\n              _iterator = _createForOfIteratorHelper(droppedFiles);\n              _context.prev = 14;\n\n              _iterator.s();\n\n            case 16:\n              if ((_step = _iterator.n()).done) {\n                _context.next = 29;\n                break;\n              }\n\n              file = _step.value;\n\n              if (!(file.type === 'application/image')) {\n                _context.next = 24;\n                break;\n              }\n\n              _context.next = 21;\n              return compressedUpload(file);\n\n            case 21:\n              _context.t1 = _context.sent;\n              _context.next = 25;\n              break;\n\n            case 24:\n              _context.t1 = file;\n\n            case 25:\n              compressedFile = _context.t1;\n              if (compressedFile) candidate.push(_objectSpread(_objectSpread({}, getFile(compressedFile)), {}, {\n                size: file.size\n              }));\n\n            case 27:\n              _context.next = 16;\n              break;\n\n            case 29:\n              _context.next = 34;\n              break;\n\n            case 31:\n              _context.prev = 31;\n              _context.t2 = _context[\"catch\"](14);\n\n              _iterator.e(_context.t2);\n\n            case 34:\n              _context.prev = 34;\n\n              _iterator.f();\n\n              return _context.finish(34);\n\n            case 37:\n              result = candidate.length > 1 ? candidate : _objectSpread(_objectSpread({}, getFile(candidate)), {}, {\n                size: droppedFiles[0].size\n              });\n              setImages(result);\n\n              if (onChange) {\n                onChange(result);\n              }\n\n            case 40:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[14, 31, 34, 37]]);\n    }));\n\n    return function (_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }(), [setImages]);\n\n  var _useDropzone = useDropzone({\n    onDrop: onDrop,\n    multiple: multiple,\n    accept: accept\n  }),\n      getRootProps = _useDropzone.getRootProps,\n      getInputProps = _useDropzone.getInputProps,\n      isDragActive = _useDropzone.isDragActive;\n\n  return __jsx(Wrap, {\n    className: className,\n    style: style,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 5\n    }\n  }, tooltip && __jsx(InfoTooltip, {\n    text: tooltip,\n    maxWidth: 215,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 9\n    }\n  }, __jsx(InfoIcon, {\n    size: 's',\n    icon: 'infoCircle',\n    stroke: (defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.length) > 0 ? 'white' : 'var(--default-color-accent)',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 11\n    }\n  })), __jsx(Container, _extends({\n    className: 'dropzone-container'\n  }, getRootProps(), {\n    error: error,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 7\n    }\n  }), __jsx(\"input\", _extends({\n    accept: accept\n  }, getInputProps(), {\n    hidden: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 9\n    }\n  })), __jsx(Area, {\n    className: 'dropzone-area',\n    active: isDragActive,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 9\n    }\n  }, !defaultValue && images.length === 0 && __jsx(Placeholder, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 13\n    }\n  }, error ? \"\\u0424\\u0430\\u0439\\u043B\\u043E\\u0432 \\u043D\\u0435 \\u043C\\u043E\\u0436\\u0435\\u0442 \\u0431\\u044B\\u0442\\u044C \\u0431\\u043E\\u043B\\u044C\\u0448\\u0435 \".concat(maxFiles, \" \\u0438\\u043B\\u0438 \\u0440\\u0430\\u0432\\u043D\\u043E \\u043D\\u0443\\u043B\\u044E\") : placeholder), multiple && (Array.isArray(images) && images.length > 1 || Array.isArray(defaultValue) && (defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.length) > 1) && __jsx(PreviewList, {\n    percentage: 'minmax(196px, 1fr)',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 15\n    }\n  }, (defaultValue || images).map(function (file) {\n    return __jsx(Preview, {\n      key: v4(),\n      src: (file === null || file === void 0 ? void 0 : file.blob) || file,\n      alt: file.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 19\n      }\n    });\n  })), !multiple && (!Array.isArray(images) || defaultValue) && __jsx(Preview, {\n    src: images.blob || (defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.path) || (defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.blob),\n    alt: defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.name,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 13\n    }\n  }))));\n};\n\n_s(Dropzone, \"oe/lbu9kRLxJlUTcrq96OzFv40g=\", false, function () {\n  return [useDropzone];\n});\n\n_c9 = Dropzone;\nDropzone.defaultProps = {\n  maxFiles: 1,\n  multiple: false\n};\nexport default Dropzone;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9;\n\n$RefreshReg$(_c, \"Wrap\");\n$RefreshReg$(_c2, \"InfoTooltip\");\n$RefreshReg$(_c3, \"InfoIcon\");\n$RefreshReg$(_c4, \"Container\");\n$RefreshReg$(_c5, \"Area\");\n$RefreshReg$(_c6, \"PreviewList\");\n$RefreshReg$(_c7, \"Preview\");\n$RefreshReg$(_c8, \"Placeholder\");\n$RefreshReg$(_c9, \"Dropzone\");","map":{"version":3,"sources":["C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/atomic-ui/components/Dropzone/index.js"],"names":["React","useState","useCallback","styled","css","imageCompression","useDropzone","v4","Image","Text","Grid","Tooltip","Icon","Wrap","div","InfoTooltip","InfoIcon","Container","error","Area","PreviewList","Preview","Placeholder","getFile","file","id","blob","type","includes","URL","createObjectURL","compressedUpload","maxSizeMB","maxWidthOrHeight","useWebWorker","console","log","Dropzone","style","accept","className","defaultValue","placeholder","tooltip","multiple","maxFiles","onChange","setError","images","setImages","onDrop","droppedFiles","length","candidate","compressedFile","push","size","result","getRootProps","getInputProps","isDragActive","Array","isArray","map","path","name","defaultProps"],"mappings":"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","sourcesContent":["import React, { useState, useCallback } from 'react'\nimport styled, { css } from 'styled-components'\nimport imageCompression from 'browser-image-compression'\nimport { useDropzone } from 'react-dropzone'\nimport { v4 } from 'uuid'\n\nimport Image from '../Image'\nimport Text from '../Text'\nimport Grid from '../Grid'\nimport Tooltip from '../Tooltip'\nimport Icon from '../Icon'\n\nexport const Wrap = styled.div`\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  grid-gap: 10px;\n\n  width: 100%;\n  height: 256px;\n  min-height: 256px;\n`\n\nexport const InfoTooltip = styled(Tooltip)`\n  position: absolute;\n  right: var(--default-gap);\n  bottom: var(--default-gap);\n  z-index: var(--z-15);\n`\n\nexport const InfoIcon = styled(Icon)`\n  cursor: pointer;\n  transition: opacity 450ms ease;\n\n  &:hover {\n    opacity: 0.65;\n  }\n`\n\nexport const Container = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  position: relative;\n  z-index: var(--z-12);\n\n  font-weight: var(--font-weight-medium);\n  font-size: var(--font-size-s);\n  font-family: var(--font-family);\n  color: var(--input-placeholder-color);\n\n  width: 100%;\n  height: 100%;\n  border-radius: var(--surface-border-radius);\n  border: 2px dashed var(--input-placeholder-color);\n  outline: none;\n  overflow: hidden;\n  flex-grow: 1;\n\n  cursor: pointer;\n  transition: all 150ms ease;\n\n  ${({ error }) =>\n    error &&\n    css`\n      color: var(--default-color-red);\n      border: 2px dashed var(--default-color-red);\n    `}\n\n  &:hover {\n    color: var(--default-color-accent);\n    border: 2px dashed var(--default-color-accent);\n\n    ${({ error }) =>\n      error &&\n      css`\n        color: var(--default-color-red);\n        border: 2px dashed var(--default-color-red);\n      `}\n  }\n`\n\nexport const Area = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n`\n\nexport const PreviewList = styled(Grid)`\n  img {\n    height: 128px;\n  }\n`\n\nexport const Preview = styled(Image)`\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  border-radius: var(--surface-border-radius);\n`\n\nexport const Placeholder = styled(Text)`\n  color: inherit;\n  padding: var(--default-gap);\n  text-align: center;\n`\n\nexport function getFile(file) {\n  return { file, id: v4(), blob: file.type?.includes('image') && URL.createObjectURL(file) }\n}\n\nexport async function compressedUpload(file) {\n  try {\n    return await imageCompression(file, {\n      maxSizeMB: 1,\n      maxWidthOrHeight: 1920,\n      useWebWorker: true\n    })\n  } catch (error) {\n    console.log(error)\n  }\n}\n\nexport const Dropzone = ({\n  style,\n  accept,\n  className,\n  defaultValue,\n  placeholder,\n  tooltip,\n  multiple,\n  maxFiles,\n  onChange\n}) => {\n  const [error, setError] = useState(false)\n  const [images, setImages] = useState([])\n\n  const onDrop = useCallback(\n    async (droppedFiles) => {\n      setError(false)\n\n      if (droppedFiles.length > maxFiles || droppedFiles.length === 0) {\n        setError(true)\n        return false\n      }\n\n      const candidate = multiple ? [] : await compressedUpload(droppedFiles[0])\n\n      if (multiple) {\n        for (let file of droppedFiles) {\n          const compressedFile =\n            file.type === 'application/image' ? await compressedUpload(file) : file\n          if (compressedFile)\n            candidate.push({\n              ...getFile(compressedFile),\n              size: file.size\n            })\n        }\n      }\n\n      const result =\n        candidate.length > 1\n          ? candidate\n          : {\n              ...getFile(candidate),\n              size: droppedFiles[0].size\n            }\n\n      setImages(result)\n      if (onChange) {\n        onChange(result)\n      }\n    },\n    [setImages]\n  )\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    onDrop,\n    multiple,\n    accept\n  })\n\n  return (\n    <Wrap className={className} style={style}>\n      {tooltip && (\n        <InfoTooltip text={tooltip} maxWidth={215}>\n          <InfoIcon\n            size={'s'}\n            icon={'infoCircle'}\n            stroke={defaultValue?.length > 0 ? 'white' : 'var(--default-color-accent)'}\n          />\n        </InfoTooltip>\n      )}\n\n      <Container className={'dropzone-container'} {...getRootProps()} error={error}>\n        <input accept={accept} {...getInputProps()} hidden />\n        <Area className={'dropzone-area'} active={isDragActive}>\n          {!defaultValue && images.length === 0 && (\n            <Placeholder>\n              {error ? `Файлов не может быть больше ${maxFiles} или равно нулю` : placeholder}\n            </Placeholder>\n          )}\n\n          {multiple &&\n            ((Array.isArray(images) && images.length > 1) ||\n              (Array.isArray(defaultValue) && defaultValue?.length > 1)) && (\n              <PreviewList percentage={'minmax(196px, 1fr)'}>\n                {(defaultValue || images).map((file) => (\n                  <Preview key={v4()} src={file?.blob || file} alt={file.id} />\n                ))}\n              </PreviewList>\n            )}\n\n          {!multiple && (!Array.isArray(images) || defaultValue) && (\n            <Preview\n              src={images.blob || defaultValue?.path || defaultValue?.blob}\n              alt={defaultValue?.name}\n            />\n          )}\n        </Area>\n      </Container>\n    </Wrap>\n  )\n}\n\nDropzone.defaultProps = {\n  maxFiles: 1,\n  multiple: false\n}\n\nexport default Dropzone\n"]},"metadata":{},"sourceType":"module"}