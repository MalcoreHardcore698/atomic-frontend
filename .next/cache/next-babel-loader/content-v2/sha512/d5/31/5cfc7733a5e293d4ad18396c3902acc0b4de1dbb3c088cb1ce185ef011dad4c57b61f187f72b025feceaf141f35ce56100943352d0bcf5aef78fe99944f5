{"ast":null,"code":"var _s = $RefreshSig$();\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React, { useState, useEffect, useMemo } from 'react';\nimport styled, { css } from 'styled-components';\nimport { useQuery, useMutation } from '@apollo/react-hooks';\nimport { useSelector, useDispatch } from 'react-redux';\nimport Row from '../../atomic-ui/components/Row';\nimport Column from '../../atomic-ui/components/Column';\nimport Member from '../../atomic-ui/components/Member';\nimport Search from '../../atomic-ui/components/Search';\nimport TicketChat from '../TicketChat';\nimport Processed from '../Processed';\nimport { setDocuments } from '../../store/actions/documents';\nimport queries from '../../graphql/queries';\nexport const Wrap = styled(Row).withConfig({\n  displayName: \"TicketView__Wrap\",\n  componentId: \"sc-1wxiq0b-0\"\n})([\"height:100%;flex-grow:1;@media only screen and (max-width:568px){flex-direction:column;}\", \" \", \" \", \"\"], ({\n  appearance\n}) => appearance === 'default' && css([\"padding:var(--default-gap);background:var(--surface-background);border:var(--surface-border);border-radius:var(--surface-border-radius);box-shadow:var(--surface-shadow);\"]), ({\n  appearance\n}) => appearance === 'ghost' && css([\"padding:0;border:none;background:none;border-radius:0;box-shadow:none;\"]), ({\n  appearance\n}) => appearance === 'clear' && css([\"padding:0;border:none;background:none;border-radius:0;box-shadow:none;\"]));\n_c = Wrap;\nexport const Tickets = styled(Column).withConfig({\n  displayName: \"TicketView__Tickets\",\n  componentId: \"sc-1wxiq0b-1\"\n})([\"grid-gap:0;width:320px;@media only screen and (max-width:568px){width:100%;}\"]);\n_c2 = Tickets;\nexport const Ticket = styled(Member).withConfig({\n  displayName: \"TicketView__Ticket\",\n  componentId: \"sc-1wxiq0b-2\"\n})([\"margin:10px 0 0 0;padding:10px;border-radius:var(--surface-border-radius);\", \"\"], ({\n  active\n}) => active && css([\"background:var(--input-background);\"]));\n_c3 = Ticket;\nexport const LIMIT_TICKETS = 36;\nexport const View = ({\n  auth,\n  ticket,\n  appearance,\n  onMemberLink,\n  onReport,\n  onAttach,\n  ...props\n}) => {\n  _s();\n\n  const [currentTicket, setCurrentTicket] = useState(null); // TODO: Fetch more tickets by scrolling\n  // eslint-disable-next-line no-unused-vars\n\n  const [offsetTickets, setOffsetTickets] = useState(0);\n  const [loadingTicket, setLoadingTicket] = useState(false);\n  const [tickets, setTickets] = useState([]);\n  const documents = useSelector(state => state.documents);\n  const dispatch = useDispatch();\n  const variablesTickets = useMemo(() => ({\n    offset: offsetTickets,\n    limit: LIMIT_TICKETS\n  }), [offsetTickets]);\n  const {\n    data,\n    loading,\n    error,\n    refetch\n  } = useQuery(queries.GET_TICKET, {\n    variables: {\n      id: ticket\n    }\n  });\n  const [closeTicket, {\n    data: dataCloseTicket,\n    loading: loadingCloseTicket,\n    error: errorCloseTicket\n  }] = useMutation(queries.CLOSE_TICKET);\n  const [sendTicketMessage, {\n    data: dataSendMessage,\n    loading: loadingSendMessage\n  }] = useMutation(queries.SEND_TICKET_MESSAGE);\n  const {\n    data: dataTickets,\n    loading: loadingTickets,\n    error: errorTickets // fetchMore: updateTickets\n\n  } = useQuery(queries.GET_TICKETS, {\n    variables: variablesTickets\n  });\n  useEffect(() => {\n    if (!loading && data !== null && data !== void 0 && data.getTicket) {\n      setCurrentTicket(data.getTicket);\n    }\n\n    if (!loadingCloseTicket && dataCloseTicket !== null && dataCloseTicket !== void 0 && dataCloseTicket.closeTicket) {\n      const candidate = dataCloseTicket.closeTicket;\n      setCurrentTicket(candidate);\n      dispatch(setDocuments((documents || []).map(document => document.id === candidate.id ? candidate : document)));\n    }\n  }, [data, dataCloseTicket, loading, loadingCloseTicket]);\n  useEffect(() => {\n    if (!loadingTickets && dataTickets) {\n      setTickets(dataTickets.getTickets);\n    }\n  }, [dataTickets, loadingTickets]);\n  useEffect(() => {\n    if (!loadingSendMessage && dataSendMessage) {\n      setCurrentTicket(prev => ({ ...prev,\n        messages: dataSendMessage.sendTicketMessage\n      }));\n    }\n  }, [dataSendMessage, loadingSendMessage]);\n  return /*#__PURE__*/React.createElement(Wrap, _extends({}, props, {\n    appearance: appearance\n  }), /*#__PURE__*/React.createElement(Processed, {\n    data: data === null || data === void 0 ? void 0 : data.getTicket,\n    loading: loading,\n    error: error,\n    errorMessage: 'Упс! Не удалось загрузить информацию о обращении',\n    emptyMessage: 'Кажется такого обращения не существует'\n  }, /*#__PURE__*/React.createElement(Tickets, null, /*#__PURE__*/React.createElement(Search, {\n    appearance: 'ghost',\n    onSubmit: () => {}\n  }), /*#__PURE__*/React.createElement(Processed, {\n    data: dataTickets === null || dataTickets === void 0 ? void 0 : dataTickets.getTickets,\n    loading: loadingTickets,\n    error: errorTickets,\n    errorMessage: 'Упс! Не удалось загрузить список обращений',\n    emptyMessage: 'Список обращений пуст'\n  }, tickets.map(item => {\n    var _item$author;\n\n    return /*#__PURE__*/React.createElement(Ticket, {\n      key: item.id,\n      name: item.title,\n      position: (_item$author = item.author) === null || _item$author === void 0 ? void 0 : _item$author.name,\n      active: currentTicket && currentTicket.id === item.id,\n      onClick: async () => {\n        setLoadingTicket(true);\n        await refetch({\n          id: item.id\n        });\n        setCurrentTicket(item);\n        setLoadingTicket(false);\n      }\n    });\n  }))), /*#__PURE__*/React.createElement(TicketChat, {\n    auth: auth,\n    ticket: currentTicket,\n    loading: loading || loadingSendMessage || loadingTicket || loadingTickets || errorCloseTicket,\n    onLink: onMemberLink,\n    onFinish: () => closeTicket({\n      variables: {\n        id: ticket\n      }\n    }),\n    onReport: onReport,\n    onAttach: onAttach,\n    onSubmit: value => {\n      var _currentTicket$author;\n\n      return sendTicketMessage({\n        variables: {\n          ticket: currentTicket.id,\n          recipient: (_currentTicket$author = currentTicket.author) === null || _currentTicket$author === void 0 ? void 0 : _currentTicket$author.email,\n          text: value\n        }\n      });\n    }\n  })));\n};\n\n_s(View, \"oj0+zcRsC5rLoLUlk0kecR8vn4o=\", false, function () {\n  return [useSelector, useDispatch, useQuery, useMutation, useMutation, useQuery];\n});\n\n_c4 = View;\nView.defaultProps = {\n  appearance: 'default'\n};\nexport default View;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"Wrap\");\n$RefreshReg$(_c2, \"Tickets\");\n$RefreshReg$(_c3, \"Ticket\");\n$RefreshReg$(_c4, \"View\");","map":{"version":3,"sources":["D:/Documents/Workspace/FREELANCE/atomic/atomic-frontend/components/TicketView/index.js"],"names":["React","useState","useEffect","useMemo","styled","css","useQuery","useMutation","useSelector","useDispatch","Row","Column","Member","Search","TicketChat","Processed","setDocuments","queries","Wrap","appearance","Tickets","Ticket","active","LIMIT_TICKETS","View","auth","ticket","onMemberLink","onReport","onAttach","props","currentTicket","setCurrentTicket","offsetTickets","setOffsetTickets","loadingTicket","setLoadingTicket","tickets","setTickets","documents","state","dispatch","variablesTickets","offset","limit","data","loading","error","refetch","GET_TICKET","variables","id","closeTicket","dataCloseTicket","loadingCloseTicket","errorCloseTicket","CLOSE_TICKET","sendTicketMessage","dataSendMessage","loadingSendMessage","SEND_TICKET_MESSAGE","dataTickets","loadingTickets","errorTickets","GET_TICKETS","getTicket","candidate","map","document","getTickets","prev","messages","item","title","author","name","value","recipient","email","text","defaultProps"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useMemo } from 'react'\nimport styled, { css } from 'styled-components'\nimport { useQuery, useMutation } from '@apollo/react-hooks'\nimport { useSelector, useDispatch } from 'react-redux'\n\nimport Row from '../../atomic-ui/components/Row'\nimport Column from '../../atomic-ui/components/Column'\nimport Member from '../../atomic-ui/components/Member'\nimport Search from '../../atomic-ui/components/Search'\n\nimport TicketChat from '../TicketChat'\nimport Processed from '../Processed'\nimport { setDocuments } from '../../store/actions/documents'\nimport queries from '../../graphql/queries'\n\nexport const Wrap = styled(Row)`\n  height: 100%;\n  flex-grow: 1;\n\n  @media only screen and (max-width: 568px) {\n    flex-direction: column;\n  }\n\n  ${({ appearance }) =>\n    appearance === 'default' &&\n    css`\n      padding: var(--default-gap);\n      background: var(--surface-background);\n      border: var(--surface-border);\n      border-radius: var(--surface-border-radius);\n      box-shadow: var(--surface-shadow);\n    `}\n\n  ${({ appearance }) =>\n    appearance === 'ghost' &&\n    css`\n      padding: 0;\n      border: none;\n      background: none;\n      border-radius: 0;\n      box-shadow: none;\n    `}\n\n  ${({ appearance }) =>\n    appearance === 'clear' &&\n    css`\n      padding: 0;\n      border: none;\n      background: none;\n      border-radius: 0;\n      box-shadow: none;\n    `}\n`\n\nexport const Tickets = styled(Column)`\n  grid-gap: 0;\n  width: 320px;\n\n  @media only screen and (max-width: 568px) {\n    width: 100%;\n  }\n`\n\nexport const Ticket = styled(Member)`\n  margin: 10px 0 0 0;\n  padding: 10px;\n  border-radius: var(--surface-border-radius);\n\n  ${({ active }) =>\n    active &&\n    css`\n      background: var(--input-background);\n    `}\n`\n\nexport const LIMIT_TICKETS = 36\n\nexport const View = ({ auth, ticket, appearance, onMemberLink, onReport, onAttach, ...props }) => {\n  const [currentTicket, setCurrentTicket] = useState(null)\n  // TODO: Fetch more tickets by scrolling\n  // eslint-disable-next-line no-unused-vars\n  const [offsetTickets, setOffsetTickets] = useState(0)\n  const [loadingTicket, setLoadingTicket] = useState(false)\n  const [tickets, setTickets] = useState([])\n  const documents = useSelector((state) => state.documents)\n  const dispatch = useDispatch()\n\n  const variablesTickets = useMemo(\n    () => ({\n      offset: offsetTickets,\n      limit: LIMIT_TICKETS\n    }),\n    [offsetTickets]\n  )\n\n  const { data, loading, error, refetch } = useQuery(queries.GET_TICKET, {\n    variables: {\n      id: ticket\n    }\n  })\n\n  const [\n    closeTicket,\n    { data: dataCloseTicket, loading: loadingCloseTicket, error: errorCloseTicket }\n  ] = useMutation(queries.CLOSE_TICKET)\n\n  const [sendTicketMessage, { data: dataSendMessage, loading: loadingSendMessage }] = useMutation(\n    queries.SEND_TICKET_MESSAGE\n  )\n\n  const {\n    data: dataTickets,\n    loading: loadingTickets,\n    error: errorTickets\n    // fetchMore: updateTickets\n  } = useQuery(queries.GET_TICKETS, {\n    variables: variablesTickets\n  })\n\n  useEffect(() => {\n    if (!loading && data?.getTicket) {\n      setCurrentTicket(data.getTicket)\n    }\n\n    if (!loadingCloseTicket && dataCloseTicket?.closeTicket) {\n      const candidate = dataCloseTicket.closeTicket\n\n      setCurrentTicket(candidate)\n      dispatch(\n        setDocuments(\n          (documents || []).map((document) => (document.id === candidate.id ? candidate : document))\n        )\n      )\n    }\n  }, [data, dataCloseTicket, loading, loadingCloseTicket])\n\n  useEffect(() => {\n    if (!loadingTickets && dataTickets) {\n      setTickets(dataTickets.getTickets)\n    }\n  }, [dataTickets, loadingTickets])\n\n  useEffect(() => {\n    if (!loadingSendMessage && dataSendMessage) {\n      setCurrentTicket((prev) => ({\n        ...prev,\n        messages: dataSendMessage.sendTicketMessage\n      }))\n    }\n  }, [dataSendMessage, loadingSendMessage])\n\n  return (\n    <Wrap {...props} appearance={appearance}>\n      <Processed\n        data={data?.getTicket}\n        loading={loading}\n        error={error}\n        errorMessage={'Упс! Не удалось загрузить информацию о обращении'}\n        emptyMessage={'Кажется такого обращения не существует'}>\n        <Tickets>\n          <Search appearance={'ghost'} onSubmit={() => {}} />\n          <Processed\n            data={dataTickets?.getTickets}\n            loading={loadingTickets}\n            error={errorTickets}\n            errorMessage={'Упс! Не удалось загрузить список обращений'}\n            emptyMessage={'Список обращений пуст'}>\n            {tickets.map((item) => (\n              <Ticket\n                key={item.id}\n                name={item.title}\n                position={item.author?.name}\n                active={currentTicket && currentTicket.id === item.id}\n                onClick={async () => {\n                  setLoadingTicket(true)\n                  await refetch({ id: item.id })\n                  setCurrentTicket(item)\n                  setLoadingTicket(false)\n                }}\n              />\n            ))}\n          </Processed>\n        </Tickets>\n\n        <TicketChat\n          auth={auth}\n          ticket={currentTicket}\n          loading={\n            loading || loadingSendMessage || loadingTicket || loadingTickets || errorCloseTicket\n          }\n          onLink={onMemberLink}\n          onFinish={() =>\n            closeTicket({\n              variables: {\n                id: ticket\n              }\n            })\n          }\n          onReport={onReport}\n          onAttach={onAttach}\n          onSubmit={(value) =>\n            sendTicketMessage({\n              variables: {\n                ticket: currentTicket.id,\n                recipient: currentTicket.author?.email,\n                text: value\n              }\n            })\n          }\n        />\n      </Processed>\n    </Wrap>\n  )\n}\n\nView.defaultProps = {\n  appearance: 'default'\n}\n\nexport default View\n"]},"metadata":{},"sourceType":"module"}