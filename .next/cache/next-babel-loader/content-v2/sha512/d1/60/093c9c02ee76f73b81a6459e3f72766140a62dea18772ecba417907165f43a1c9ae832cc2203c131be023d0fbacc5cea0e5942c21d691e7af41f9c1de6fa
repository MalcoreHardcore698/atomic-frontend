{"ast":null,"code":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React, { useMemo, memo } from 'react';\nimport Head from 'next/head';\nimport Link from 'next/link';\nimport { useRouter } from 'next/router';\nimport { useQuery } from '@apollo/react-hooks';\nimport { useSelector, useDispatch } from 'react-redux';\nimport styled, { css } from 'styled-components';\nimport { v4 } from 'uuid';\nimport Image from '../atomic-ui/components/Image';\nimport Spinner from '../atomic-ui/components/Spinner';\nimport MainLayout from './main';\nimport { useMutate } from '../hooks/useMutate';\nimport { useHelper } from '../hooks/useHelper';\nimport Scaffold from '../components/Scaffold';\nimport AppBar from '../components/AppBar';\nimport Footer from '../components/Footer';\nimport { LowerLoader } from '../components/Styled';\nimport { setLogout } from '../store/actions/user';\nimport { setDrawer } from '../store/actions/drawer';\nimport { getSupportLinks, socials, contacts } from '../__mock__';\nimport { onMenu, onHelp, onNotification, onChat } from '../store/helpers';\nimport { onUserClientEdit } from '../store/helpers/user';\nimport queries from '../graphql/queries';\nconst Wrap = styled.div.withConfig({\n  displayName: \"default__Wrap\",\n  componentId: \"sc-2byuzg-0\"\n})([\"position:relative;top:-20px;display:flex;flex-direction:column;justify-content:space-between;height:100vh;z-index:2;\"]);\nconst Background = styled(Image).withConfig({\n  displayName: \"default__Background\",\n  componentId: \"sc-2byuzg-1\"\n})([\"position:absolute;top:0;left:0;width:100%;height:auto;object-fit:contain;z-index:1;\"]);\nconst Main = styled.main.withConfig({\n  displayName: \"default__Main\",\n  componentId: \"sc-2byuzg-2\"\n})([\"padding:50px var(--main-offset-l);flex-grow:100;@media only screen and (max-width:996px){padding:25px var(--main-offset-m);}@media only screen and (max-width:768px){padding:25px var(--main-offset-s);}@media only screen and (max-width:480px){padding:25px var(--main-offset-xs);}\"]);\nconst Anchor = styled.a.withConfig({\n  displayName: \"default__Anchor\",\n  componentId: \"sc-2byuzg-3\"\n})([\"border-radius:25rem;padding:5px 15px;background:transparent;color:black;transition:all 150ms ease;\", \" \", \"\"], ({\n  link\n}) => link && css([\"&:hover{opacity:0.65;}\"]), ({\n  active,\n  link\n}) => active && link && css([\"background:var(--default-color-accent-dim);color:var(--default-color-accent-link);&:hover{opacity:1;}\"]));\nconst DefaultHeader = memo(() => {\n  var _root$settings$genera;\n\n  const recall = useHelper();\n  const mutate = useMutate();\n  const router = useRouter();\n  const {\n    root,\n    user\n  } = useSelector(state => state);\n  const dispatch = useDispatch();\n  const {\n    data,\n    loading\n  } = useQuery(queries.GET_CATEGORIES);\n  const categories = useMemo(() => (data === null || data === void 0 ? void 0 : data.getCategories) || [], [data]);\n  const isProjects = router.pathname.includes('projects');\n  const categoryId = router.query.c;\n  const onSupport = recall(onHelp, {\n    mutation: queries.CREATE_USER_TICKET\n  });\n\n  if (loading) {\n    return /*#__PURE__*/React.createElement(LowerLoader, null, /*#__PURE__*/React.createElement(Spinner, null));\n  }\n\n  return /*#__PURE__*/React.createElement(AppBar, {\n    user: user.authenticated ? user : null,\n    logotype: (_root$settings$genera = root.settings.general.logotype) === null || _root$settings$genera === void 0 ? void 0 : _root$settings$genera.path,\n    link: ({\n      children,\n      href,\n      ...props\n    }) => /*#__PURE__*/React.createElement(Link, _extends({}, props, {\n      href: href\n    }), /*#__PURE__*/React.createElement(Anchor, {\n      active: router.pathname === href,\n      link: children.type.target === 'span'\n    }, children)),\n    links: [{\n      label: 'Проекты',\n      props: {\n        sublinks: categories.filter(category => category.type === 'DIVISION').map(category => ({\n          label: category.name,\n          props: {\n            active: categoryId === category.id,\n            onClick: () => router.push(`/projects?c=${category.id}`)\n          }\n        }))\n      },\n      active: isProjects\n    }, {\n      label: 'Авторы',\n      props: {\n        href: '/creators'\n      }\n    }, {\n      label: 'Новости',\n      props: {\n        href: '/articles'\n      }\n    }, {\n      label: 'О ресурсе',\n      props: {\n        href: '/about'\n      }\n    }],\n    onMenu: recall(onMenu, {\n      links: [{\n        text: 'Проекты',\n        onClick: () => {\n          dispatch(setDrawer(null));\n          router.push('/projects');\n        }\n      }, {\n        text: 'Авторы',\n        onClick: () => {\n          dispatch(setDrawer(null));\n          router.push('/creators');\n        }\n      }, {\n        text: 'Новости',\n        onClick: () => {\n          dispatch(setDrawer(null));\n          router.push('/articles');\n        }\n      }, {\n        text: 'О ресурсе',\n        onClick: () => {\n          dispatch(setDrawer(null));\n          router.push('/about');\n        }\n      }]\n    }),\n    onHelp: onSupport,\n    onChat: recall(onChat, {\n      sender: user,\n      queries: {\n        userChats: queries.GET_USER_CHATS,\n        chat: queries.GET_CHAT\n      },\n      mutations: {\n        addUserChat: queries.ADD_USER_CHAT,\n        sendMessage: queries.SEND_MESSAGE\n      }\n    }),\n    onSettings: recall(onUserClientEdit, {\n      user: user === null || user === void 0 ? void 0 : user.email,\n      mutations: {\n        del: queries.DELETE_USER,\n        forgotEmail: queries.LOGIN,\n        forgotPassword: queries.RESET,\n        changePassword: queries.UPDATE_CLIENT_USER,\n        checkResetToken: queries.CHECK_RESET_TOKEN,\n        update: queries.UPDATE_CLIENT_USER\n      }\n    }),\n    onNotification: recall(onNotification, {\n      user: user.email\n    }),\n    onProfile: () => router.push('/profile'),\n    onLogin: () => router.push('/auth'),\n    onLogout: mutate(queries.LOGOUT, {}, () => dispatch(setLogout()))\n  });\n});\nconst DefaultFooter = memo(() => {\n  const recall = useHelper();\n  const {\n    data,\n    loading\n  } = useQuery(queries.GET_CATEGORIES);\n  const categories = useMemo(() => (data === null || data === void 0 ? void 0 : data.getCategories) || [], [data]);\n  const onSupport = recall(onHelp, {\n    mutation: queries.CREATE_USER_TICKET\n  });\n\n  if (loading) {\n    return /*#__PURE__*/React.createElement(LowerLoader, null, /*#__PURE__*/React.createElement(Spinner, null));\n  }\n\n  return /*#__PURE__*/React.createElement(Footer, {\n    contacts: contacts,\n    socials: socials,\n    catalog: {\n      title: 'Каталог',\n      links: categories.filter(category => category.type === 'DIVISION').map(link => /*#__PURE__*/React.createElement(Link, {\n        key: v4(),\n        href: `/projects?c=${link.id}`\n      }, /*#__PURE__*/React.createElement(\"a\", null, link.name)))\n    },\n    support: {\n      title: 'О компании',\n      links: getSupportLinks(onSupport).map(link => ({ ...link,\n        render: () => link.path ? /*#__PURE__*/React.createElement(Link, {\n          key: v4(),\n          href: link.path\n        }, /*#__PURE__*/React.createElement(\"a\", null, link.label)) : link.label\n      }))\n    }\n  });\n});\nexport const DefaultLayout = ({\n  children,\n  title = 'Атомик',\n  scaffold,\n  background\n}) => /*#__PURE__*/React.createElement(MainLayout, null, /*#__PURE__*/React.createElement(Head, null, /*#__PURE__*/React.createElement(\"meta\", {\n  name: \"keywords\",\n  content: \"next,javascript,nextjs,react\"\n}), /*#__PURE__*/React.createElement(\"meta\", {\n  name: \"description\",\n  content: \"atomic project description\"\n}), /*#__PURE__*/React.createElement(\"title\", null, title)), /*#__PURE__*/React.createElement(Background, {\n  src: background,\n  alt: 'Background'\n}), /*#__PURE__*/React.createElement(Wrap, null, /*#__PURE__*/React.createElement(DefaultHeader, null), scaffold && /*#__PURE__*/React.createElement(Scaffold, {\n  scaffold: scaffold\n}), /*#__PURE__*/React.createElement(Main, {\n  id: 'main'\n}, children), /*#__PURE__*/React.createElement(DefaultFooter, null)));\nexport default DefaultLayout;","map":{"version":3,"sources":["/Users/malcore/Documents/workspace/freelance/atomic/atomic-frontend/layouts/default.js"],"names":["React","useMemo","memo","Head","Link","useRouter","useQuery","useSelector","useDispatch","styled","css","v4","Image","Spinner","MainLayout","useMutate","useHelper","Scaffold","AppBar","Footer","LowerLoader","setLogout","setDrawer","getSupportLinks","socials","contacts","onMenu","onHelp","onNotification","onChat","onUserClientEdit","queries","Wrap","div","Background","Main","main","Anchor","a","link","active","DefaultHeader","recall","mutate","router","root","user","state","dispatch","data","loading","GET_CATEGORIES","categories","getCategories","isProjects","pathname","includes","categoryId","query","c","onSupport","mutation","CREATE_USER_TICKET","authenticated","settings","general","logotype","path","children","href","props","type","target","label","sublinks","filter","category","map","name","id","onClick","push","links","text","sender","userChats","GET_USER_CHATS","chat","GET_CHAT","mutations","addUserChat","ADD_USER_CHAT","sendMessage","SEND_MESSAGE","email","del","DELETE_USER","forgotEmail","LOGIN","forgotPassword","RESET","changePassword","UPDATE_CLIENT_USER","checkResetToken","CHECK_RESET_TOKEN","update","LOGOUT","DefaultFooter","title","render","DefaultLayout","scaffold","background"],"mappings":"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","sourcesContent":["import React, { useMemo, memo } from 'react'\nimport Head from 'next/head'\nimport Link from 'next/link'\nimport { useRouter } from 'next/router'\nimport { useQuery } from '@apollo/react-hooks'\nimport { useSelector, useDispatch } from 'react-redux'\nimport styled, { css } from 'styled-components'\nimport { v4 } from 'uuid'\n\nimport Image from '../atomic-ui/components/Image'\nimport Spinner from '../atomic-ui/components/Spinner'\n\nimport MainLayout from './main'\nimport { useMutate } from '../hooks/useMutate'\nimport { useHelper } from '../hooks/useHelper'\nimport Scaffold from '../components/Scaffold'\nimport AppBar from '../components/AppBar'\nimport Footer from '../components/Footer'\nimport { LowerLoader } from '../components/Styled'\nimport { setLogout } from '../store/actions/user'\nimport { setDrawer } from '../store/actions/drawer'\nimport { getSupportLinks, socials, contacts } from '../__mock__'\nimport { onMenu, onHelp, onNotification, onChat } from '../store/helpers'\nimport { onUserClientEdit } from '../store/helpers/user'\nimport queries from '../graphql/queries'\n\nconst Wrap = styled.div`\n  position: relative;\n  top: -20px;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  height: 100vh;\n  z-index: 2;\n`\n\nconst Background = styled(Image)`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: auto;\n  object-fit: contain;\n  z-index: 1;\n`\n\nconst Main = styled.main`\n  padding: 50px var(--main-offset-l);\n  flex-grow: 100;\n\n  @media only screen and (max-width: 996px) {\n    padding: 25px var(--main-offset-m);\n  }\n\n  @media only screen and (max-width: 768px) {\n    padding: 25px var(--main-offset-s);\n  }\n\n  @media only screen and (max-width: 480px) {\n    padding: 25px var(--main-offset-xs);\n  }\n`\n\nconst Anchor = styled.a`\n  border-radius: 25rem;\n  padding: 5px 15px;\n  background: transparent;\n  color: black;\n  transition: all 150ms ease;\n\n  ${({ link }) =>\n    link &&\n    css`\n      &:hover {\n        opacity: 0.65;\n      }\n    `}\n\n  ${({ active, link }) =>\n    active &&\n    link &&\n    css`\n      background: var(--default-color-accent-dim);\n      color: var(--default-color-accent-link);\n\n      &:hover {\n        opacity: 1;\n      }\n    `}\n`\n\nconst DefaultHeader = memo(() => {\n  const recall = useHelper()\n  const mutate = useMutate()\n  const router = useRouter()\n  const { root, user } = useSelector((state) => state)\n  const dispatch = useDispatch()\n\n  const { data, loading } = useQuery(queries.GET_CATEGORIES)\n  const categories = useMemo(() => data?.getCategories || [], [data])\n\n  const isProjects = router.pathname.includes('projects')\n  const categoryId = router.query.c\n\n  const onSupport = recall(onHelp, {\n    mutation: queries.CREATE_USER_TICKET\n  })\n\n  if (loading) {\n    return (\n      <LowerLoader>\n        <Spinner />\n      </LowerLoader>\n    )\n  }\n\n  return (\n    <AppBar\n      user={user.authenticated ? user : null}\n      logotype={root.settings.general.logotype?.path}\n      link={({ children, href, ...props }) => (\n        <Link {...props} href={href}>\n          <Anchor active={router.pathname === href} link={children.type.target === 'span'}>\n            {children}\n          </Anchor>\n        </Link>\n      )}\n      links={[\n        {\n          label: 'Проекты',\n          props: {\n            sublinks: categories\n              .filter((category) => category.type === 'DIVISION')\n              .map((category) => ({\n                label: category.name,\n                props: {\n                  active: categoryId === category.id,\n                  onClick: () => router.push(`/projects?c=${category.id}`)\n                }\n              }))\n          },\n          active: isProjects\n        },\n        { label: 'Авторы', props: { href: '/creators' } },\n        { label: 'Новости', props: { href: '/articles' } },\n        { label: 'О ресурсе', props: { href: '/about' } }\n      ]}\n      onMenu={recall(onMenu, {\n        links: [\n          {\n            text: 'Проекты',\n            onClick: () => {\n              dispatch(setDrawer(null))\n              router.push('/projects')\n            }\n          },\n          {\n            text: 'Авторы',\n            onClick: () => {\n              dispatch(setDrawer(null))\n              router.push('/creators')\n            }\n          },\n          {\n            text: 'Новости',\n            onClick: () => {\n              dispatch(setDrawer(null))\n              router.push('/articles')\n            }\n          },\n          {\n            text: 'О ресурсе',\n            onClick: () => {\n              dispatch(setDrawer(null))\n              router.push('/about')\n            }\n          }\n        ]\n      })}\n      onHelp={onSupport}\n      onChat={recall(onChat, {\n        sender: user,\n        queries: {\n          userChats: queries.GET_USER_CHATS,\n          chat: queries.GET_CHAT\n        },\n        mutations: {\n          addUserChat: queries.ADD_USER_CHAT,\n          sendMessage: queries.SEND_MESSAGE\n        }\n      })}\n      onSettings={recall(onUserClientEdit, {\n        user: user?.email,\n        mutations: {\n          del: queries.DELETE_USER,\n          forgotEmail: queries.LOGIN,\n          forgotPassword: queries.RESET,\n          changePassword: queries.UPDATE_CLIENT_USER,\n          checkResetToken: queries.CHECK_RESET_TOKEN,\n          update: queries.UPDATE_CLIENT_USER\n        }\n      })}\n      onNotification={recall(onNotification, { user: user.email })}\n      onProfile={() => router.push('/profile')}\n      onLogin={() => router.push('/auth')}\n      onLogout={mutate(queries.LOGOUT, {}, () => dispatch(setLogout()))}\n    />\n  )\n})\n\nconst DefaultFooter = memo(() => {\n  const recall = useHelper()\n  const { data, loading } = useQuery(queries.GET_CATEGORIES)\n  const categories = useMemo(() => data?.getCategories || [], [data])\n\n  const onSupport = recall(onHelp, {\n    mutation: queries.CREATE_USER_TICKET\n  })\n\n  if (loading) {\n    return (\n      <LowerLoader>\n        <Spinner />\n      </LowerLoader>\n    )\n  }\n\n  return (\n    <Footer\n      contacts={contacts}\n      socials={socials}\n      catalog={{\n        title: 'Каталог',\n        links: categories\n          .filter((category) => category.type === 'DIVISION')\n          .map((link) => (\n            <Link key={v4()} href={`/projects?c=${link.id}`}>\n              <a>{link.name}</a>\n            </Link>\n          ))\n      }}\n      support={{\n        title: 'О компании',\n        links: getSupportLinks(onSupport).map((link) => ({\n          ...link,\n          render: () =>\n            link.path ? (\n              <Link key={v4()} href={link.path}>\n                <a>{link.label}</a>\n              </Link>\n            ) : (\n              link.label\n            )\n        }))\n      }}\n    />\n  )\n})\n\nexport const DefaultLayout = ({ children, title = 'Атомик', scaffold, background }) => (\n  <MainLayout>\n    <Head>\n      <meta name=\"keywords\" content=\"next,javascript,nextjs,react\" />\n      <meta name=\"description\" content=\"atomic project description\" />\n      <title>{title}</title>\n    </Head>\n\n    <Background src={background} alt={'Background'} />\n\n    <Wrap>\n      <DefaultHeader />\n\n      {scaffold && <Scaffold scaffold={scaffold} />}\n\n      <Main id={'main'}>{children}</Main>\n\n      <DefaultFooter />\n    </Wrap>\n  </MainLayout>\n)\n\nexport default DefaultLayout\n"]},"metadata":{},"sourceType":"module"}