{"ast":null,"code":"import React, { useCallback, useMemo, useRef } from 'react';\nimport { Controller, useForm } from 'react-hook-form';\nimport styled from 'styled-components';\nimport { v4 } from 'uuid';\nimport Column from '../../atomic-ui/components/Column';\nimport Row from '../../atomic-ui/components/Row';\nimport Switch from '../../atomic-ui/components/Switch';\nimport Divider from '../../atomic-ui/components/Divider';\nimport Transition from '../../atomic-ui/components/Transition';\nimport DatePicker from '../../atomic-ui/components/DatePicker';\nimport AsyncSelect from '../AsyncSelect';\nexport const Wrap = styled(Column).withConfig({\n  displayName: \"FilterBar__Wrap\",\n  componentId: \"sc-1lvfs1u-0\"\n})([\"width:100%;&.fade-enter{opacity:0;}&.fade-enter-active{opacity:1;transition:opacity 100ms,blur 100ms;}&.fade-exit{opacity:1;}&.fade-exit-active{opacity:0;transition:opacity 100ms,blur 100ms;}\"]);\nexport const Form = styled.form.withConfig({\n  displayName: \"FilterBar__Form\",\n  componentId: \"sc-1lvfs1u-1\"\n})([\"display:flex;flex-direction:column;grid-gap:var(--default-gap);width:100%;\"]);\nexport const List = styled(Row).withConfig({\n  displayName: \"FilterBar__List\",\n  componentId: \"sc-1lvfs1u-2\"\n})([\"display:grid;grid-template-columns:repeat(auto-fit,minmax(256px,1fr));@media only screen and (max-width:480px){grid-gap:var(--default-gap);}\"]);\nexport const Filter = ({\n  isOpen = true,\n  duration,\n  sort,\n  filter\n}) => {\n  const {\n    control,\n    getValues,\n    handleSubmit\n  } = useForm();\n  const formRef = useRef(null);\n  const form = useMemo(() => formRef === null || formRef === void 0 ? void 0 : formRef.current, [formRef]);\n  const decorate = useCallback(callback => value => {\n    if (callback) callback(value);\n    if (form) form.submit();\n    console.log(getValues());\n  }, [form, getValues]);\n\n  const onSubmit = form => {\n    console.log(form);\n  };\n\n  const filters = useMemo(() => (filter || []).map(filter => {\n    switch (filter.type) {\n      case 'DATEPICKER':\n        return /*#__PURE__*/React.createElement(Controller, {\n          key: v4(),\n          control: control,\n          name: filter.name,\n          render: ({\n            value,\n            onChange\n          }) => /*#__PURE__*/React.createElement(DatePicker, {\n            defaultValue: value,\n            placeholder: filter.label,\n            onChange: decorate(onChange),\n            withNavigate: true\n          })\n        });\n\n      case 'SELECT':\n        return /*#__PURE__*/React.createElement(Controller, {\n          key: v4(),\n          control: control,\n          name: filter.name,\n          render: ({\n            value,\n            onChange\n          }) => /*#__PURE__*/React.createElement(AsyncSelect, {\n            defaultValue: value,\n            query: filter.query,\n            type: filter.queryType,\n            variables: filter.variables,\n            placeholder: filter.label,\n            onChange: decorate(onChange)\n          })\n        });\n\n      default:\n        return null;\n    }\n  }), [filter]);\n  const options = useMemo(() => sort || [], [sort]);\n  return /*#__PURE__*/React.createElement(Transition, {\n    in: isOpen,\n    animation: 'fade',\n    timeout: duration\n  }, /*#__PURE__*/React.createElement(Wrap, null, /*#__PURE__*/React.createElement(Form, {\n    ref: formRef,\n    onSubmit: handleSubmit(onSubmit)\n  }, /*#__PURE__*/React.createElement(Divider, {\n    clear: true\n  }), filters && filters.length > 0 && /*#__PURE__*/React.createElement(List, null, filters.map(filter => filter)), options && options.length > 0 && /*#__PURE__*/React.createElement(Row, null, /*#__PURE__*/React.createElement(Controller, {\n    key: v4(),\n    name: 'sort',\n    control: control,\n    defaultValue: options[0],\n    render: ({\n      value,\n      onChange\n    }) => /*#__PURE__*/React.createElement(Switch, {\n      defaultValue: value,\n      onChange: decorate(onChange),\n      options: options,\n      stretch: true\n    })\n  })), /*#__PURE__*/React.createElement(Divider, {\n    clear: true\n  }))));\n};\nFilter.defaultProps = {\n  duration: 150\n};\nexport default Filter;","map":{"version":3,"sources":["D:/Documents/Workspace/FREELANCE/atomic/atomic-frontend/components/FilterBar/index.js"],"names":["React","useCallback","useMemo","useRef","Controller","useForm","styled","v4","Column","Row","Switch","Divider","Transition","DatePicker","AsyncSelect","Wrap","Form","form","List","Filter","isOpen","duration","sort","filter","control","getValues","handleSubmit","formRef","current","decorate","callback","value","submit","console","log","onSubmit","filters","map","type","name","onChange","label","query","queryType","variables","options","length","defaultProps"],"mappings":"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","sourcesContent":["import React, { useCallback, useMemo, useRef } from 'react'\nimport { Controller, useForm } from 'react-hook-form'\nimport styled from 'styled-components'\nimport { v4 } from 'uuid'\n\nimport Column from '../../atomic-ui/components/Column'\nimport Row from '../../atomic-ui/components/Row'\nimport Switch from '../../atomic-ui/components/Switch'\nimport Divider from '../../atomic-ui/components/Divider'\nimport Transition from '../../atomic-ui/components/Transition'\nimport DatePicker from '../../atomic-ui/components/DatePicker'\n\nimport AsyncSelect from '../AsyncSelect'\n\nexport const Wrap = styled(Column)`\n  width: 100%;\n\n  &.fade-enter {\n    opacity: 0;\n  }\n\n  &.fade-enter-active {\n    opacity: 1;\n    transition: opacity 100ms, blur 100ms;\n  }\n\n  &.fade-exit {\n    opacity: 1;\n  }\n\n  &.fade-exit-active {\n    opacity: 0;\n    transition: opacity 100ms, blur 100ms;\n  }\n`\n\nexport const Form = styled.form`\n  display: flex;\n  flex-direction: column;\n  grid-gap: var(--default-gap);\n  width: 100%;\n`\n\nexport const List = styled(Row)`\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(256px, 1fr));\n\n  @media only screen and (max-width: 480px) {\n    grid-gap: var(--default-gap);\n  }\n`\n\nexport const Filter = ({ isOpen = true, duration, sort, filter }) => {\n  const { control, getValues, handleSubmit } = useForm()\n  const formRef = useRef(null)\n\n  const form = useMemo(() => formRef?.current, [formRef])\n\n  const decorate = useCallback(\n   (callback) =>\n      (value) => {\n        if (callback) callback(value)\n        if (form) form.submit()\n        console.log(getValues())\n      },\n    [form, getValues]\n  )\n\n  const onSubmit = (form) => {\n    console.log(form)\n  }\n\n  const filters = useMemo(() => (filter || []).map((filter) => {\n    switch (filter.type) {\n      case 'DATEPICKER':\n        return (\n          <Controller\n            key={v4()}\n            control={control}\n            name={filter.name}\n            render={({ value, onChange }) => (\n              <DatePicker\n                defaultValue={value}\n                placeholder={filter.label}\n                onChange={decorate(onChange)}\n                withNavigate\n              />\n            )}\n          />\n        )\n      case 'SELECT':\n        return (\n          <Controller\n            key={v4()}\n            control={control}\n            name={filter.name}\n            render={({ value, onChange }) => (\n              <AsyncSelect\n                defaultValue={value}\n                query={filter.query}\n                type={filter.queryType}\n                variables={filter.variables}\n                placeholder={filter.label}\n                onChange={decorate(onChange)}\n              />\n            )}\n          />\n        )\n      default:\n        return null\n    }\n  }), [filter])\n\n  const options = useMemo(() => sort || [], [sort])\n\n  return (\n    <Transition in={isOpen} animation={'fade'} timeout={duration}>\n      <Wrap>\n        <Form ref={formRef} onSubmit={handleSubmit(onSubmit)}>\n          <Divider clear />\n          {filters && filters.length > 0 && <List>{filters.map((filter) => filter)}</List>}\n          {options && options.length > 0 && (\n            <Row>\n              <Controller\n               key={v4()}\n               name={'sort'}\n               control={control}\n               defaultValue={options[0]}\n               render={({ value, onChange }) => (\n                <Switch\n                  defaultValue={value}\n                  onChange={decorate(onChange)}\n                  options={options}\n                  stretch\n                />\n               )}\n              />\n            </Row>\n          )}\n          <Divider clear />\n        </Form>\n      </Wrap>\n    </Transition>\n  )\n}\n\nFilter.defaultProps = {\n  duration: 150\n}\n\nexport default Filter\n"]},"metadata":{},"sourceType":"module"}