{"ast":null,"code":"import _extends from \"C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/node_modules/@babel/runtime/helpers/esm/extends\";\nimport _regeneratorRuntime from \"C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/node_modules/@babel/runtime/regenerator\";\nimport _defineProperty from \"C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _taggedTemplateLiteral from \"C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\dan82\\\\Documents\\\\workspace\\\\FREELANCE\\\\atomic\\\\atomic-frontend\\\\atomic-ui\\\\components\\\\Dropzone\\\\index.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _templateObject14() {\n  var data = _taggedTemplateLiteral([\"\\n  color: inherit;\\n  padding: var(--default-gap);\\n  text-align: center;\\n\"]);\n\n  _templateObject14 = function _templateObject14() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject13() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  object-fit: cover;\\n  border-radius: var(--surface-border-radius);\\n\"]);\n\n  _templateObject13 = function _templateObject13() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject12() {\n  var data = _taggedTemplateLiteral([\"\\n  img {\\n    height: 128px;\\n  }\\n\"]);\n\n  _templateObject12 = function _templateObject12() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject11() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: space-between;\\n  margin-top: 0.5rem;\\n\"]);\n\n  _templateObject11 = function _templateObject11() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject10() {\n  var data = _taggedTemplateLiteral([\"\\n  input {\\n    width: 100%;\\n  }\\n\"]);\n\n  _templateObject10 = function _templateObject10() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject9() {\n  var data = _taggedTemplateLiteral([\"\\n  margin: 0 auto;\\n  text-align: center;\\n\"]);\n\n  _templateObject9 = function _templateObject9() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject8() {\n  var data = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  z-index: 999;\\n  padding: 1rem;\\n  background: #fff;\\n  width: fit-content;\\n  border: 1px solid rgba(0, 0, 0, 15%);\\n\"]);\n\n  _templateObject8 = function _templateObject8() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject7() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  width: 100%;\\n  height: 100%;\\n\\n  & > span {\\n    height: 100%;\\n  }\\n\"]);\n\n  _templateObject7 = function _templateObject7() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6() {\n  var data = _taggedTemplateLiteral([\"\\n        color: var(--default-color-red);\\n        border: 2px dashed var(--default-color-red);\\n      \"]);\n\n  _templateObject6 = function _templateObject6() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5() {\n  var data = _taggedTemplateLiteral([\"\\n      color: var(--default-color-red);\\n      border: 2px dashed var(--default-color-red);\\n    \"]);\n\n  _templateObject5 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n\\n  position: relative;\\n  z-index: var(--z-12);\\n\\n  font-weight: var(--font-weight-medium);\\n  font-size: var(--font-size-s);\\n  font-family: var(--font-family);\\n  color: var(--input-placeholder-color);\\n\\n  width: 100%;\\n  height: 100%;\\n  border-radius: var(--surface-border-radius);\\n  border: 2px dashed var(--input-placeholder-color);\\n  outline: none;\\n  overflow: hidden;\\n  flex-grow: 1;\\n\\n  cursor: pointer;\\n  transition: all 150ms ease;\\n\\n  \", \"\\n\\n  &:hover {\\n    color: var(--default-color-accent);\\n    border: 2px dashed var(--default-color-accent);\\n\\n    \", \"\\n  }\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n  cursor: pointer;\\n  transition: opacity 450ms ease;\\n\\n  &:hover {\\n    opacity: 0.65;\\n  }\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  right: var(--default-gap);\\n  bottom: var(--default-gap);\\n  z-index: var(--z-15);\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  position: relative;\\n  display: flex;\\n  flex-direction: column;\\n  grid-gap: 10px;\\n\\n  width: 100%;\\n  height: 256px;\\n  min-height: 256px;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, useCallback } from 'react';\nimport AvatarEditor from 'react-avatar-editor';\nimport styled, { css } from 'styled-components';\nimport imageCompression from 'browser-image-compression';\nimport { useDropzone } from 'react-dropzone';\nimport { v4 } from 'uuid';\nimport Image from '../Image';\nimport Text from '../Text';\nimport Button from '../Button';\nimport Grid from '../Grid';\nimport Tooltip from '../Tooltip';\nimport Icon from '../Icon';\nexport var Wrap = styled.div(_templateObject());\n_c = Wrap;\nexport var InfoTooltip = styled(Tooltip)(_templateObject2());\n_c2 = InfoTooltip;\nexport var InfoIcon = styled(Icon)(_templateObject3());\n_c3 = InfoIcon;\nexport var Container = styled.div(_templateObject4(), function (_ref) {\n  var error = _ref.error;\n  return error && css(_templateObject5());\n}, function (_ref2) {\n  var error = _ref2.error;\n  return error && css(_templateObject6());\n});\n_c4 = Container;\nexport var Area = styled.div(_templateObject7());\n_c5 = Area;\nvar Overlay = styled.div(_templateObject8());\n_c6 = Overlay;\nvar MiddleOriented = styled.div(_templateObject9());\n_c7 = MiddleOriented;\nvar ActionsLayout = styled.div(_templateObject10());\n_c8 = ActionsLayout;\nvar ButtonsLayout = styled.div(_templateObject11());\n_c9 = ButtonsLayout;\nexport var PreviewList = styled(Grid)(_templateObject12());\n_c10 = PreviewList;\nexport var Preview = styled(Image)(_templateObject13());\n_c11 = Preview;\nexport var Placeholder = styled(Text)(_templateObject14());\n_c12 = Placeholder;\nexport function getFile(file) {\n  var _file$type;\n\n  return {\n    file: file,\n    id: v4(),\n    blob: ((_file$type = file.type) === null || _file$type === void 0 ? void 0 : _file$type.includes('image')) && URL.createObjectURL(file)\n  };\n}\nexport function compressedUpload(_x) {\n  return _compressedUpload.apply(this, arguments);\n}\n\nfunction _compressedUpload() {\n  _compressedUpload = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(file) {\n    var maxWidthOrHeight,\n        _args2 = arguments;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            maxWidthOrHeight = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : 1366;\n            _context2.prev = 1;\n            _context2.next = 4;\n            return imageCompression(file, {\n              maxSizeMB: 1,\n              maxWidthOrHeight: maxWidthOrHeight,\n              useWebWorker: true\n            });\n\n          case 4:\n            return _context2.abrupt(\"return\", _context2.sent);\n\n          case 7:\n            _context2.prev = 7;\n            _context2.t0 = _context2[\"catch\"](1);\n            console.log(_context2.t0);\n\n          case 10:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[1, 7]]);\n  }));\n  return _compressedUpload.apply(this, arguments);\n}\n\nexport var Dropzone = function Dropzone(_ref3) {\n  _s();\n\n  var style = _ref3.style,\n      accept = _ref3.accept,\n      avatar = _ref3.avatar,\n      className = _ref3.className,\n      defaultValue = _ref3.defaultValue,\n      placeholder = _ref3.placeholder,\n      tooltip = _ref3.tooltip,\n      multiple = _ref3.multiple,\n      maxFiles = _ref3.maxFiles,\n      onChange = _ref3.onChange;\n\n  var _useState = useState(false),\n      error = _useState[0],\n      setError = _useState[1];\n\n  var _useState2 = useState([]),\n      images = _useState2[0],\n      setImages = _useState2[1];\n\n  var _useState3 = useState([0.8]),\n      initScale = _useState3[0],\n      setScale = _useState3[1];\n\n  var _useState4 = useState([]),\n      avatarState = _useState4[0],\n      setAvatar = _useState4[1];\n\n  var _useState5 = useState([]),\n      avatarHistory = _useState5[0],\n      setHistory = _useState5[1];\n\n  var onDrop = useCallback( /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(droppedFiles) {\n      var candidate, _iterator, _step, _file$type2, file, compressedFile, miniature, result;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setError(false);\n\n              if (avatar) {\n                setAvatar(true);\n              }\n\n              if (!(droppedFiles.length > maxFiles || droppedFiles.length === 0)) {\n                _context.next = 5;\n                break;\n              }\n\n              setError(true);\n              return _context.abrupt(\"return\", false);\n\n            case 5:\n              if (!multiple) {\n                _context.next = 9;\n                break;\n              }\n\n              _context.t0 = [];\n              _context.next = 12;\n              break;\n\n            case 9:\n              _context.next = 11;\n              return compressedUpload(droppedFiles[0]);\n\n            case 11:\n              _context.t0 = _context.sent;\n\n            case 12:\n              candidate = _context.t0;\n\n              if (!multiple) {\n                _context.next = 42;\n                break;\n              }\n\n              _iterator = _createForOfIteratorHelper(droppedFiles);\n              _context.prev = 15;\n\n              _iterator.s();\n\n            case 17:\n              if ((_step = _iterator.n()).done) {\n                _context.next = 34;\n                break;\n              }\n\n              file = _step.value;\n              compressedFile = void 0;\n              miniature = void 0;\n\n              if (!((_file$type2 = file.type) !== null && _file$type2 !== void 0 && _file$type2.includes('image'))) {\n                _context.next = 30;\n                break;\n              }\n\n              _context.next = 24;\n              return compressedUpload(file);\n\n            case 24:\n              compressedFile = _context.sent;\n              _context.next = 27;\n              return compressedUpload(file, 185);\n\n            case 27:\n              miniature = _context.sent;\n              _context.next = 31;\n              break;\n\n            case 30:\n              compressedFile = file;\n\n            case 31:\n              if (compressedFile) {\n                candidate.push(_objectSpread(_objectSpread({}, getFile(compressedFile)), {}, {\n                  size: compressedFile.size,\n                  miniature: _objectSpread(_objectSpread({}, getFile(miniature)), {}, {\n                    size: miniature.size\n                  })\n                }));\n              }\n\n            case 32:\n              _context.next = 17;\n              break;\n\n            case 34:\n              _context.next = 39;\n              break;\n\n            case 36:\n              _context.prev = 36;\n              _context.t1 = _context[\"catch\"](15);\n\n              _iterator.e(_context.t1);\n\n            case 39:\n              _context.prev = 39;\n\n              _iterator.f();\n\n              return _context.finish(39);\n\n            case 42:\n              result = candidate.length > 1 ? candidate : _objectSpread(_objectSpread({}, getFile(candidate)), {}, {\n                size: droppedFiles[0].size\n              });\n              setImages(result);\n\n              if (onChange) {\n                onChange(result);\n              }\n\n            case 45:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[15, 36, 39, 42]]);\n    }));\n\n    return function (_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }(), [setImages]);\n  var imageScaled = null;\n\n  var handleScale = function handleScale(e) {\n    var scale = parseFloat(e.target.value);\n    setScale(scale);\n  };\n\n  var clearImages = function clearImages() {\n    setAvatar(false);\n\n    if (!avatarHistory) {\n      setImages('');\n    } else {\n      setImages(avatarHistory);\n    }\n  };\n\n  var onClickSave = function onClickSave() {\n    if (imageScaled) {\n      var canvasScaled = imageScaled.getImageScaledToCanvas();\n      images.blob = canvasScaled.toDataURL('image/png');\n      setImages(images);\n      setAvatar(false);\n      setHistory(images);\n    }\n  };\n\n  var setEditorRef = function setEditorRef(editor) {\n    return imageScaled = editor;\n  };\n\n  var _useDropzone = useDropzone({\n    onDrop: onDrop,\n    multiple: multiple,\n    avatar: avatar,\n    accept: accept,\n    initScale: initScale,\n    handleScale: handleScale,\n    clearImages: clearImages,\n    onClickSave: onClickSave,\n    setEditorRef: setEditorRef\n  }),\n      getRootProps = _useDropzone.getRootProps,\n      getInputProps = _useDropzone.getInputProps,\n      isDragActive = _useDropzone.isDragActive;\n\n  return __jsx(Wrap, {\n    className: className,\n    style: style,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 5\n    }\n  }, tooltip && __jsx(InfoTooltip, {\n    text: tooltip,\n    maxWidth: 215,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 9\n    }\n  }, __jsx(InfoIcon, {\n    size: 's',\n    icon: 'infoCircle',\n    stroke: (defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.length) > 0 ? 'white' : 'var(--default-color-accent)',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 11\n    }\n  })), avatarState && images.blob && __jsx(Overlay, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 9\n    }\n  }, __jsx(MiddleOriented, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 11\n    }\n  }, __jsx(AvatarEditor, {\n    image: images.blob || (defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.path) || (defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.blob),\n    width: 220,\n    height: 256,\n    border: 10,\n    color: [255, 255, 255, 0.6],\n    scale: parseFloat(initScale),\n    rotate: 0,\n    ref: setEditorRef,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 13\n    }\n  })), __jsx(ActionsLayout, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 11\n    }\n  }, __jsx(\"input\", {\n    name: \"scale\",\n    type: \"range\",\n    onChange: handleScale,\n    min: \"0.8\",\n    max: \"2\",\n    step: \"0.01\",\n    defaultValue: \"0.8\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 13\n    }\n  }), __jsx(ButtonsLayout, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 13\n    }\n  }, __jsx(Button, {\n    appearance: 'default',\n    onClick: onClickSave,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 15\n    }\n  }, \"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"), __jsx(Button, {\n    appearance: 'outlined',\n    onClick: clearImages,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 15\n    }\n  }, \"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\")))), __jsx(Container, _extends({\n    className: 'dropzone-container'\n  }, getRootProps(), {\n    error: error,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 7\n    }\n  }), __jsx(\"input\", _extends({\n    accept: accept\n  }, getInputProps(), {\n    hidden: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 9\n    }\n  })), __jsx(Area, {\n    className: 'dropzone-area',\n    active: isDragActive,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 9\n    }\n  }, !defaultValue && images.length === 0 && __jsx(Placeholder, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 13\n    }\n  }, error ? \"\\u0424\\u0430\\u0439\\u043B\\u043E\\u0432 \\u043D\\u0435 \\u043C\\u043E\\u0436\\u0435\\u0442 \\u0431\\u044B\\u0442\\u044C \\u0431\\u043E\\u043B\\u044C\\u0448\\u0435 \".concat(maxFiles, \" \\u0438\\u043B\\u0438 \\u0440\\u0430\\u0432\\u043D\\u043E \\u043D\\u0443\\u043B\\u044E\") : placeholder), multiple && (Array.isArray(images) && images.length > 1 || Array.isArray(defaultValue) && (defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.length) > 1) && __jsx(PreviewList, {\n    percentage: 'minmax(196px, 1fr)',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 15\n    }\n  }, (defaultValue || images).map(function (file) {\n    return __jsx(Preview, {\n      key: v4(),\n      src: (file === null || file === void 0 ? void 0 : file.blob) || file,\n      alt: file.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 19\n      }\n    });\n  })), !multiple && (!Array.isArray(images) || defaultValue) && __jsx(Preview, {\n    src: images.blob || (defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.path) || (defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.blob),\n    alt: defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.name,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 13\n    }\n  }))));\n};\n\n_s(Dropzone, \"tBwa3aHFiuNMebt2ZjEFgC7joZw=\", false, function () {\n  return [useDropzone];\n});\n\n_c13 = Dropzone;\nDropzone.defaultProps = {\n  maxFiles: 1,\n  multiple: false\n};\nexport default Dropzone;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10, _c11, _c12, _c13;\n\n$RefreshReg$(_c, \"Wrap\");\n$RefreshReg$(_c2, \"InfoTooltip\");\n$RefreshReg$(_c3, \"InfoIcon\");\n$RefreshReg$(_c4, \"Container\");\n$RefreshReg$(_c5, \"Area\");\n$RefreshReg$(_c6, \"Overlay\");\n$RefreshReg$(_c7, \"MiddleOriented\");\n$RefreshReg$(_c8, \"ActionsLayout\");\n$RefreshReg$(_c9, \"ButtonsLayout\");\n$RefreshReg$(_c10, \"PreviewList\");\n$RefreshReg$(_c11, \"Preview\");\n$RefreshReg$(_c12, \"Placeholder\");\n$RefreshReg$(_c13, \"Dropzone\");","map":{"version":3,"sources":["C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/atomic-ui/components/Dropzone/index.js"],"names":["React","useState","useCallback","AvatarEditor","styled","css","imageCompression","useDropzone","v4","Image","Text","Button","Grid","Tooltip","Icon","Wrap","div","InfoTooltip","InfoIcon","Container","error","Area","Overlay","MiddleOriented","ActionsLayout","ButtonsLayout","PreviewList","Preview","Placeholder","getFile","file","id","blob","type","includes","URL","createObjectURL","compressedUpload","maxWidthOrHeight","maxSizeMB","useWebWorker","console","log","Dropzone","style","accept","avatar","className","defaultValue","placeholder","tooltip","multiple","maxFiles","onChange","setError","images","setImages","initScale","setScale","avatarState","setAvatar","avatarHistory","setHistory","onDrop","droppedFiles","length","candidate","compressedFile","miniature","push","size","result","imageScaled","handleScale","e","scale","parseFloat","target","value","clearImages","onClickSave","canvasScaled","getImageScaledToCanvas","toDataURL","setEditorRef","editor","getRootProps","getInputProps","isDragActive","path","Array","isArray","map","name","defaultProps"],"mappings":"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","sourcesContent":["import React, { useState, useCallback } from 'react'\nimport AvatarEditor from 'react-avatar-editor'\nimport styled, { css } from 'styled-components'\nimport imageCompression from 'browser-image-compression'\nimport { useDropzone } from 'react-dropzone'\nimport { v4 } from 'uuid'\n\nimport Image from '../Image'\nimport Text from '../Text'\nimport Button from '../Button'\nimport Grid from '../Grid'\nimport Tooltip from '../Tooltip'\nimport Icon from '../Icon'\n\nexport const Wrap = styled.div`\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  grid-gap: 10px;\n\n  width: 100%;\n  height: 256px;\n  min-height: 256px;\n`\n\nexport const InfoTooltip = styled(Tooltip)`\n  position: absolute;\n  right: var(--default-gap);\n  bottom: var(--default-gap);\n  z-index: var(--z-15);\n`\n\nexport const InfoIcon = styled(Icon)`\n  cursor: pointer;\n  transition: opacity 450ms ease;\n\n  &:hover {\n    opacity: 0.65;\n  }\n`\n\nexport const Container = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  position: relative;\n  z-index: var(--z-12);\n\n  font-weight: var(--font-weight-medium);\n  font-size: var(--font-size-s);\n  font-family: var(--font-family);\n  color: var(--input-placeholder-color);\n\n  width: 100%;\n  height: 100%;\n  border-radius: var(--surface-border-radius);\n  border: 2px dashed var(--input-placeholder-color);\n  outline: none;\n  overflow: hidden;\n  flex-grow: 1;\n\n  cursor: pointer;\n  transition: all 150ms ease;\n\n  ${({ error }) =>\n    error &&\n    css`\n      color: var(--default-color-red);\n      border: 2px dashed var(--default-color-red);\n    `}\n\n  &:hover {\n    color: var(--default-color-accent);\n    border: 2px dashed var(--default-color-accent);\n\n    ${({ error }) =>\n      error &&\n      css`\n        color: var(--default-color-red);\n        border: 2px dashed var(--default-color-red);\n      `}\n  }\n`\n\nexport const Area = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n\n  & > span {\n    height: 100%;\n  }\n`\n\nconst Overlay = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 999;\n  padding: 1rem;\n  background: #fff;\n  width: fit-content;\n  border: 1px solid rgba(0, 0, 0, 15%);\n`\n\nconst MiddleOriented = styled.div`\n  margin: 0 auto;\n  text-align: center;\n`\n\nconst ActionsLayout = styled.div`\n  input {\n    width: 100%;\n  }\n`\n\nconst ButtonsLayout = styled.div`\n  display: flex;\n  justify-content: space-between;\n  margin-top: 0.5rem;\n`\n\nexport const PreviewList = styled(Grid)`\n  img {\n    height: 128px;\n  }\n`\n\nexport const Preview = styled(Image)`\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  border-radius: var(--surface-border-radius);\n`\n\nexport const Placeholder = styled(Text)`\n  color: inherit;\n  padding: var(--default-gap);\n  text-align: center;\n`\n\nexport function getFile(file) {\n  return { file, id: v4(), blob: file.type?.includes('image') && URL.createObjectURL(file) }\n}\n\nexport async function compressedUpload(file, maxWidthOrHeight = 1366) {\n  try {\n    return await imageCompression(file, {\n      maxSizeMB: 1,\n      maxWidthOrHeight,\n      useWebWorker: true\n    })\n  } catch (error) {\n    console.log(error)\n  }\n}\n\nexport const Dropzone = ({\n  style,\n  accept,\n  avatar,\n  className,\n  defaultValue,\n  placeholder,\n  tooltip,\n  multiple,\n  maxFiles,\n  onChange\n}) => {\n  const [error, setError] = useState(false)\n  const [images, setImages] = useState([])\n  const [initScale, setScale] = useState([0.8])\n  const [avatarState, setAvatar] = useState([])\n  const [avatarHistory, setHistory] = useState([])\n\n  const onDrop = useCallback(\n    async (droppedFiles) => {\n      setError(false)\n\n      if (avatar) {\n        setAvatar(true)\n      }\n\n      if (droppedFiles.length > maxFiles || droppedFiles.length === 0) {\n        setError(true)\n        return false\n      }\n\n      const candidate = multiple ? [] : await compressedUpload(droppedFiles[0])\n\n      if (multiple) {\n        for (let file of droppedFiles) {\n          let compressedFile\n          let miniature\n\n          if (file.type?.includes('image')) {\n            compressedFile = await compressedUpload(file)\n            miniature = await compressedUpload(file, 185)\n          } else {\n            compressedFile = file\n          }\n\n          if (compressedFile) {\n            candidate.push({\n              ...getFile(compressedFile),\n              size: compressedFile.size,\n              miniature: {\n                ...getFile(miniature),\n                size: miniature.size\n              }\n            })\n          }\n        }\n      }\n\n      const result =\n        candidate.length > 1\n          ? candidate\n          : {\n              ...getFile(candidate),\n              size: droppedFiles[0].size\n            }\n\n      setImages(result)\n      if (onChange) {\n        onChange(result)\n      }\n    },\n    [setImages]\n  )\n\n  let imageScaled = null\n  const handleScale = (e) => {\n    const scale = parseFloat(e.target.value)\n    setScale(scale)\n  }\n\n  const clearImages = () => {\n    setAvatar(false)\n    if (!avatarHistory) {\n      setImages('')\n    } else {\n      setImages(avatarHistory)\n    }\n  }\n\n  const onClickSave = () => {\n    if (imageScaled) {\n      const canvasScaled = imageScaled.getImageScaledToCanvas()\n      images.blob = canvasScaled.toDataURL('image/png')\n      setImages(images)\n      setAvatar(false)\n      setHistory(images)\n    }\n  }\n\n  const setEditorRef = (editor) => (imageScaled = editor)\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    onDrop,\n    multiple,\n    avatar,\n    accept,\n    initScale,\n    handleScale,\n    clearImages,\n    onClickSave,\n    setEditorRef\n  })\n\n  return (\n    <Wrap className={className} style={style}>\n      {tooltip && (\n        <InfoTooltip text={tooltip} maxWidth={215}>\n          <InfoIcon\n            size={'s'}\n            icon={'infoCircle'}\n            stroke={defaultValue?.length > 0 ? 'white' : 'var(--default-color-accent)'}\n          />\n        </InfoTooltip>\n      )}\n\n      {avatarState && images.blob && (\n        <Overlay>\n          <MiddleOriented>\n            <AvatarEditor\n              image={images.blob || defaultValue?.path || defaultValue?.blob}\n              width={220}\n              height={256}\n              border={10}\n              color={[255, 255, 255, 0.6]}\n              scale={parseFloat(initScale)}\n              rotate={0}\n              ref={setEditorRef}\n            />\n          </MiddleOriented>\n          <ActionsLayout>\n            <input\n              name=\"scale\"\n              type=\"range\"\n              onChange={handleScale}\n              min=\"0.8\"\n              max=\"2\"\n              step=\"0.01\"\n              defaultValue=\"0.8\"\n            />\n            <ButtonsLayout>\n              <Button appearance={'default'} onClick={onClickSave}>\n                Сохранить\n              </Button>\n              <Button appearance={'outlined'} onClick={clearImages}>\n                Отмена\n              </Button>\n            </ButtonsLayout>\n          </ActionsLayout>\n        </Overlay>\n      )}\n\n      <Container className={'dropzone-container'} {...getRootProps()} error={error}>\n        <input accept={accept} {...getInputProps()} hidden />\n        <Area className={'dropzone-area'} active={isDragActive}>\n          {!defaultValue && images.length === 0 && (\n            <Placeholder>\n              {error ? `Файлов не может быть больше ${maxFiles} или равно нулю` : placeholder}\n            </Placeholder>\n          )}\n\n          {multiple &&\n            ((Array.isArray(images) && images.length > 1) ||\n              (Array.isArray(defaultValue) && defaultValue?.length > 1)) && (\n              <PreviewList percentage={'minmax(196px, 1fr)'}>\n                {(defaultValue || images).map((file) => (\n                  <Preview key={v4()} src={file?.blob || file} alt={file.id} />\n                ))}\n              </PreviewList>\n            )}\n\n          {!multiple && (!Array.isArray(images) || defaultValue) && (\n            <Preview\n              src={images.blob || defaultValue?.path || defaultValue?.blob}\n              alt={defaultValue?.name}\n            />\n          )}\n        </Area>\n      </Container>\n    </Wrap>\n  )\n}\n\nDropzone.defaultProps = {\n  maxFiles: 1,\n  multiple: false\n}\n\nexport default Dropzone\n"]},"metadata":{},"sourceType":"module"}