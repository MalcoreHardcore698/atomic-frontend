{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport React, { useMemo } from 'react';\nimport { useRouter } from 'next/router';\nimport { useSelector } from 'react-redux';\nimport styled, { css } from 'styled-components';\nimport Row from '../../atomic-ui/components/Row';\nimport Column from '../../atomic-ui/components/Column';\nimport Title from '../../atomic-ui/components/Title';\nimport Meta from '../../atomic-ui/components/Meta';\nimport More from '../../atomic-ui/components/More';\nimport Image from '../../atomic-ui/components/Image';\nimport { b64EncodeUnicode } from '../../atomic-ui/utils/functions';\nimport { Surface } from '../Styled';\nimport CardActions from '../CardActions';\nimport { onArticleDelete, onArticleEdit } from '../../store/helpers/article';\nimport { useHelper } from '../../hooks/useHelper';\nimport queries from '../../graphql/queries';\nimport config from '../../config';\nconst HOST_URL = config.get('host-url');\nexport const Wrap = styled(Surface).withConfig({\n  displayName: \"ArticleCard__Wrap\",\n  componentId: \"sc-17tznl7-0\"\n})([\"display:grid;grid-template-columns:1fr 2fr;height:inherit;& > span{display:flex;}\", \" @media only screen and (max-width:480px){display:flex;flex-direction:column;grid-gap:var(--default-gap);}\"], ({\n  layout\n}) => layout === 'column' && css([\"display:flex;flex-wrap:wrap;grid-gap:var(--default-gap);& > span{height:128px;}\"]));\n_c = Wrap;\nexport const Poster = styled(Image).withConfig({\n  displayName: \"ArticleCard__Poster\",\n  componentId: \"sc-17tznl7-1\"\n})([\"object-fit:cover;width:100%;height:100%;border-radius:var(--surface-border-radius);border:1px solid var(--ghost-color-background);\", \"\"], ({\n  layout\n}) => layout === 'column' && css([\"height:128px;\"]));\n_c2 = Poster;\nexport const Header = styled(Row).withConfig({\n  displayName: \"ArticleCard__Header\",\n  componentId: \"sc-17tznl7-2\"\n})([\"justify-content:space-between;align-items:center;\"]);\n_c3 = Header;\nexport const Actions = styled(Row).withConfig({\n  displayName: \"ArticleCard__Actions\",\n  componentId: \"sc-17tznl7-3\"\n})([\"grid-gap:5px;height:100%;\"]);\nexport const Name = styled(Title).withConfig({\n  displayName: \"ArticleCard__Name\",\n  componentId: \"sc-17tznl7-4\"\n})([\"transition:opacity 150ms ease;\", \"\"], ({\n  onClick\n}) => onClick && css([\"cursor:pointer;&:hover{opacity:0.45;}\"]));\n_c4 = Name;\nexport const MoreButton = styled(More).withConfig({\n  displayName: \"ArticleCard__MoreButton\",\n  componentId: \"sc-17tznl7-5\"\n})([\"align-items:flex-end;flex-grow:100;\"]);\n_c5 = MoreButton;\nexport const HTMLView = ({\n  content,\n  className\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: className,\n  dangerouslySetInnerHTML: {\n    __html: content\n  }\n});\n_c6 = HTMLView;\nexport const ShortText = styled(HTMLView).withConfig({\n  displayName: \"ArticleCard__ShortText\",\n  componentId: \"sc-17tznl7-6\"\n})([\"display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;p{font-size:var(--font-size-m);font-weight:var(--font-weight-regular);color:var(--default-color-text);strong,b,i{font-style:normal;font-weight:inherit;}}\"]);\n_c7 = ShortText;\nexport const Card = ({\n  layout,\n  article,\n  preview,\n  checked,\n  appearance,\n  onLink,\n  onChecked,\n  onEdit,\n  onDelete,\n  withSocials\n}) => {\n  _s();\n\n  var _article$preview, _article$category;\n\n  const router = useRouter();\n  const recall = useHelper();\n  const user = useSelector(state => state.user);\n  const canEditStatus = useMemo(() => {\n    var _user$role;\n\n    return user && (user === null || user === void 0 ? void 0 : (_user$role = user.role) === null || _user$role === void 0 ? void 0 : _user$role.name) === 'ADMIN';\n  }, [user]);\n\n  const handleClick = async () => {\n    await router.push({\n      pathname: router.pathname,\n      query: {\n        article: b64EncodeUnicode(article.id)\n      }\n    }, undefined, {\n      shallow: true\n    });\n    if (onLink) onLink();\n  };\n\n  const handleEdit = () => {\n    recall(onArticleEdit, {\n      id: article.id,\n      canEditStatus,\n      mutation: queries.UPDATE_ARTICLE\n    })();\n    if (onEdit) onEdit();\n  };\n\n  const handleDelete = () => {\n    recall(onArticleDelete, {\n      id: article.id,\n      article,\n      mutation: queries.DELETE_ARTICLE\n    })();\n    if (onDelete) onDelete();\n  };\n\n  return /*#__PURE__*/React.createElement(Wrap, {\n    checked: checked,\n    appearance: appearance,\n    layout: layout\n  }, article.preview && /*#__PURE__*/React.createElement(Poster, {\n    src: (_article$preview = article.preview) === null || _article$preview === void 0 ? void 0 : _article$preview.path,\n    alt: article.title,\n    effect: 'opacity',\n    layout: layout\n  }), /*#__PURE__*/React.createElement(Column, {\n    style: {\n      gridGap: 5,\n      width: '100%',\n      gridColumn: !article.preview && '1 / 3'\n    }\n  }, /*#__PURE__*/React.createElement(Header, null, /*#__PURE__*/React.createElement(Meta, {\n    shareTitle: withSocials && (article === null || article === void 0 ? void 0 : article.title),\n    shareUrl: true && withSocials ? location.href : HOST_URL,\n    category: article === null || article === void 0 ? void 0 : (_article$category = article.category) === null || _article$category === void 0 ? void 0 : _article$category.name,\n    date: article === null || article === void 0 ? void 0 : article.createdAt,\n    short: true\n  }), /*#__PURE__*/React.createElement(CardActions, {\n    typeText: 'статью',\n    checked: checked,\n    onEdit: onEdit && handleEdit,\n    onDelete: onDelete && handleDelete,\n    onChecked: onChecked\n  })), /*#__PURE__*/React.createElement(Name, {\n    tag: 'h4',\n    onClick: handleClick\n  }, article.title), article.body && /*#__PURE__*/React.createElement(ShortText, {\n    content: article.body\n  }), !onChecked && !preview && /*#__PURE__*/React.createElement(MoreButton, {\n    onClick: onLink,\n    withButton: true\n  })));\n};\n\n_s(Card, \"qtlheUjA907br8+g8UYMGUzbsew=\", false, function () {\n  return [useRouter, useHelper, useSelector];\n});\n\n_c8 = Card;\nCard.defaultProps = {\n  appearance: 'default'\n};\nexport default Card;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8;\n\n$RefreshReg$(_c, \"Wrap\");\n$RefreshReg$(_c2, \"Poster\");\n$RefreshReg$(_c3, \"Header\");\n$RefreshReg$(_c4, \"Name\");\n$RefreshReg$(_c5, \"MoreButton\");\n$RefreshReg$(_c6, \"HTMLView\");\n$RefreshReg$(_c7, \"ShortText\");\n$RefreshReg$(_c8, \"Card\");","map":{"version":3,"sources":["C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/components/ArticleCard/index.js"],"names":["React","useMemo","useRouter","useSelector","styled","css","Row","Column","Title","Meta","More","Image","b64EncodeUnicode","Surface","CardActions","onArticleDelete","onArticleEdit","useHelper","queries","config","HOST_URL","get","Wrap","layout","Poster","Header","Actions","Name","onClick","MoreButton","HTMLView","content","className","__html","ShortText","Card","article","preview","checked","appearance","onLink","onChecked","onEdit","onDelete","withSocials","router","recall","user","state","canEditStatus","role","name","handleClick","push","pathname","query","id","undefined","shallow","handleEdit","mutation","UPDATE_ARTICLE","handleDelete","DELETE_ARTICLE","path","title","gridGap","width","gridColumn","location","href","category","createdAt","body","defaultProps"],"mappings":"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","sourcesContent":["import React, { useMemo } from 'react'\nimport { useRouter } from 'next/router'\nimport { useSelector } from 'react-redux'\nimport styled, { css } from 'styled-components'\n\nimport Row from '../../atomic-ui/components/Row'\nimport Column from '../../atomic-ui/components/Column'\nimport Title from '../../atomic-ui/components/Title'\nimport Meta from '../../atomic-ui/components/Meta'\nimport More from '../../atomic-ui/components/More'\nimport Image from '../../atomic-ui/components/Image'\nimport { b64EncodeUnicode } from '../../atomic-ui/utils/functions'\n\nimport { Surface } from '../Styled'\nimport CardActions from '../CardActions'\nimport { onArticleDelete, onArticleEdit } from '../../store/helpers/article'\nimport { useHelper } from '../../hooks/useHelper'\nimport queries from '../../graphql/queries'\nimport config from '../../config'\n\nconst HOST_URL = config.get('host-url')\n\nexport const Wrap = styled(Surface)`\n  display: grid;\n  grid-template-columns: 1fr 2fr;\n  height: inherit;\n\n  & > span {\n    display: flex;\n  }\n\n  ${({ layout }) =>\n    layout === 'column' &&\n    css`\n      display: flex;\n      flex-wrap: wrap;\n      grid-gap: var(--default-gap);\n\n      & > span {\n        height: 128px;\n      }\n    `}\n\n  @media only screen and (max-width: 480px) {\n    display: flex;\n    flex-direction: column;\n    grid-gap: var(--default-gap);\n  }\n`\n\nexport const Poster = styled(Image)`\n  object-fit: cover;\n  width: 100%;\n  height: 100%;\n  border-radius: var(--surface-border-radius);\n  border: 1px solid var(--ghost-color-background);\n\n  ${({ layout }) =>\n    layout === 'column' &&\n    css`\n      height: 128px;\n    `}\n`\n\nexport const Header = styled(Row)`\n  justify-content: space-between;\n  align-items: center;\n`\n\nexport const Actions = styled(Row)`\n  grid-gap: 5px;\n  height: 100%;\n`\n\nexport const Name = styled(Title)`\n  transition: opacity 150ms ease;\n\n  ${({ onClick }) =>\n    onClick &&\n    css`\n      cursor: pointer;\n\n      &:hover {\n        opacity: 0.45;\n      }\n    `}\n`\n\nexport const MoreButton = styled(More)`\n  align-items: flex-end;\n  flex-grow: 100;\n`\n\nexport const HTMLView = ({ content, className }) => (\n  <div className={className} dangerouslySetInnerHTML={{ __html: content }} />\n)\n\nexport const ShortText = styled(HTMLView)`\n  display: -webkit-box;\n  -webkit-line-clamp: 3;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  text-overflow: ellipsis;\n\n  p {\n    font-size: var(--font-size-m);\n    font-weight: var(--font-weight-regular);\n    color: var(--default-color-text);\n\n    strong,\n    b,\n    i {\n      font-style: normal;\n      font-weight: inherit;\n    }\n  }\n`\n\nexport const Card = ({\n  layout,\n  article,\n  preview,\n  checked,\n  appearance,\n  onLink,\n  onChecked,\n  onEdit,\n  onDelete,\n  withSocials\n}) => {\n  const router = useRouter()\n  const recall = useHelper()\n  const user = useSelector((state) => state.user)\n\n  const canEditStatus = useMemo(() => user && user?.role?.name === 'ADMIN', [user])\n\n  const handleClick = async () => {\n    await router.push(\n      {\n        pathname: router.pathname,\n        query: {\n          article: b64EncodeUnicode(article.id)\n        }\n      },\n      undefined,\n      { shallow: true }\n    )\n    if (onLink) onLink()\n  }\n\n  const handleEdit = () => {\n    recall(onArticleEdit, {\n      id: article.id,\n      canEditStatus,\n      mutation: queries.UPDATE_ARTICLE\n    })()\n    if (onEdit) onEdit()\n  }\n\n  const handleDelete = () => {\n    recall(onArticleDelete, {\n      id: article.id,\n      article,\n      mutation: queries.DELETE_ARTICLE\n    })()\n    if (onDelete) onDelete()\n  }\n\n  return (\n    <Wrap checked={checked} appearance={appearance} layout={layout}>\n      {article.preview && (\n        <Poster\n          src={article.preview?.path}\n          alt={article.title}\n          effect={'opacity'}\n          layout={layout}\n        />\n      )}\n      <Column\n        style={{\n          gridGap: 5,\n          width: '100%',\n          gridColumn: !article.preview && '1 / 3'\n        }}>\n        <Header>\n          <Meta\n            shareTitle={withSocials && article?.title}\n            shareUrl={typeof window !== 'undefined' && withSocials ? location.href : HOST_URL}\n            category={article?.category?.name}\n            date={article?.createdAt}\n            short\n          />\n\n          <CardActions\n            typeText={'статью'}\n            checked={checked}\n            onEdit={onEdit && handleEdit}\n            onDelete={onDelete && handleDelete}\n            onChecked={onChecked}\n          />\n        </Header>\n\n        <Name tag={'h4'} onClick={handleClick}>\n          {article.title}\n        </Name>\n\n        {article.body && <ShortText content={article.body} />}\n        {!onChecked && !preview && <MoreButton onClick={onLink} withButton />}\n      </Column>\n    </Wrap>\n  )\n}\n\nCard.defaultProps = {\n  appearance: 'default'\n}\n\nexport default Card\n"]},"metadata":{},"sourceType":"module"}