{"ast":null,"code":"import React, { memo } from 'react';\nimport { useRouter } from 'next/router';\nimport { useLazyQuery } from '@apollo/react-hooks';\nimport GlobalSearch from '../../atomic-ui/components/GlobalSearch';\nimport { b64EncodeUnicode } from '../../atomic-ui/utils/functions';\nimport { Card } from '../../layouts/dashboard/content';\nexport const Query = memo(({\n  data,\n  loading,\n  search,\n  entity,\n  entities,\n  onHide,\n  onJump,\n  onChange,\n  onSubmit\n}) => {\n  const router = useRouter();\n\n  const redirectById = (item, path) => router.push(`${path}/${b64EncodeUnicode(item.id)}`);\n\n  const onClick = async (item, path, singlePath) => {\n    if (onHide) onHide();\n    await redirectById(item, `${path}/${singlePath}`);\n  };\n\n  const onEdit = async (item, path) => {\n    if (onHide) onHide();\n    await redirectById(item, `${path}/edit`);\n  };\n\n  return /*#__PURE__*/React.createElement(GlobalSearch, {\n    search: search,\n    loading: loading,\n    result: search && data && entity && data[entity === null || entity === void 0 ? void 0 : entity.value],\n    initialEntity: entity,\n    entities: (entities || []).map(elem => ({ ...elem,\n      render: item => /*#__PURE__*/React.createElement(Card, {\n        key: item.id || item.email,\n        item: item,\n        appearance: 'clear',\n        component: elem.render(item),\n        onLink: document => onClick(document, (elem === null || elem === void 0 ? void 0 : elem.originPath) || '', (elem === null || elem === void 0 ? void 0 : elem.singlePath) || ''),\n        onEdit: document => onEdit(document, (elem === null || elem === void 0 ? void 0 : elem.originPath) || ''),\n        onDelete: document => onJump('/delete', {\n          item: document,\n          entity: elem\n        }),\n        withoutChecked: true\n      })\n    })),\n    onSubmit: onSubmit,\n    onChange: onChange\n  });\n});\nexport const QuerySearch = memo(({\n  search,\n  entity,\n  entities,\n  setSearch,\n  onHide,\n  onJump,\n  onChange\n}) => {\n  const initialResult = [null, {\n    data: null,\n    loading: false,\n    refetch: null\n  }];\n  const [load, {\n    data,\n    loading,\n    refetch\n  }] = entity ? useLazyQuery(entity.query) : initialResult;\n\n  const onSubmit = value => {\n    const variables = {\n      search: value\n    };\n    if (setSearch) setSearch(value);\n\n    if (value) {\n      if (refetch) {\n        refetch(variables);\n      }\n\n      if (load) {\n        load({\n          variables\n        });\n      }\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(Query, {\n    data: data,\n    entity: entity,\n    search: search,\n    loading: loading,\n    entities: entities,\n    onHide: onHide,\n    onJump: onJump,\n    onChange: onChange,\n    onSubmit: onSubmit\n  });\n});\nexport default QuerySearch;","map":{"version":3,"sources":["C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/components/QuerySearch/index.js"],"names":["React","memo","useRouter","useLazyQuery","GlobalSearch","b64EncodeUnicode","Card","Query","data","loading","search","entity","entities","onHide","onJump","onChange","onSubmit","router","redirectById","item","path","push","id","onClick","singlePath","onEdit","value","map","elem","render","email","document","originPath","QuerySearch","setSearch","initialResult","refetch","load","query","variables"],"mappings":"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","sourcesContent":["import React, { memo } from 'react'\nimport { useRouter } from 'next/router'\nimport { useLazyQuery } from '@apollo/react-hooks'\n\nimport GlobalSearch from '../../atomic-ui/components/GlobalSearch'\nimport { b64EncodeUnicode } from '../../atomic-ui/utils/functions'\n\nimport { Card } from '../../layouts/dashboard/content'\n\nexport const Query = memo(\n  ({ data, loading, search, entity, entities, onHide, onJump, onChange, onSubmit }) => {\n    const router = useRouter()\n\n    const redirectById = (item, path) => router.push(`${path}/${b64EncodeUnicode(item.id)}`)\n\n    const onClick = async (item, path, singlePath) => {\n      if (onHide) onHide()\n      await redirectById(item, `${path}/${singlePath}`)\n    }\n\n    const onEdit = async (item, path) => {\n      if (onHide) onHide()\n      await redirectById(item, `${path}/edit`)\n    }\n\n    return (\n      <GlobalSearch\n        search={search}\n        loading={loading}\n        result={search && data && entity && data[entity?.value]}\n        initialEntity={entity}\n        entities={(entities || []).map((elem) => ({\n          ...elem,\n          render: (item) => (\n            <Card\n              key={item.id || item.email}\n              item={item}\n              appearance={'clear'}\n              component={elem.render(item)}\n              onLink={(document) =>\n                onClick(document, elem?.originPath || '', elem?.singlePath || '')\n              }\n              onEdit={(document) => onEdit(document, elem?.originPath || '')}\n              onDelete={(document) => onJump('/delete', { item: document, entity: elem })}\n              withoutChecked\n            />\n          )\n        }))}\n        onSubmit={onSubmit}\n        onChange={onChange}\n      />\n    )\n  }\n)\n\nexport const QuerySearch = memo(\n  ({ search, entity, entities, setSearch, onHide, onJump, onChange }) => {\n    const initialResult = [null, { data: null, loading: false, refetch: null }]\n    const [load, { data, loading, refetch }] = entity ? useLazyQuery(entity.query) : initialResult\n\n    const onSubmit = (value) => {\n      const variables = { search: value }\n\n      if (setSearch) setSearch(value)\n\n      if (value) {\n        if (refetch) {\n          refetch(variables)\n        }\n        if (load) {\n          load({ variables })\n        }\n      }\n    }\n\n    return (\n      <Query\n        data={data}\n        entity={entity}\n        search={search}\n        loading={loading}\n        entities={entities}\n        onHide={onHide}\n        onJump={onJump}\n        onChange={onChange}\n        onSubmit={onSubmit}\n      />\n    )\n  }\n)\n\nexport default QuerySearch\n"]},"metadata":{},"sourceType":"module"}