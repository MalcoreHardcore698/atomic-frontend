{"ast":null,"code":"import React, { useState, useMemo, useRef } from 'react';\nimport styled, { css } from 'styled-components';\nimport Row from '../Row';\nimport Column from '../Column';\nimport Avatar from '../Avatar';\nimport Text from '../Text';\nimport DateText from '../DateText';\nimport Button from '../Button';\nimport Icon from '../Icon';\nimport Tooltip from '../Tooltip';\nimport Checkbox from '../Checkbox';\nimport TextArea from '../TextArea';\nexport const Wrap = styled(Row).withConfig({\n  displayName: \"Comment__Wrap\",\n  componentId: \"sc-16gyxu7-0\"\n})([\"position:relative;margin:0;padding:0;\", \"\"], ({\n  checked\n}) => checked && css([\"opacity:0.45;\"]));\nexport const MiniAvatar = styled(Avatar).withConfig({\n  displayName: \"Comment__MiniAvatar\",\n  componentId: \"sc-16gyxu7-1\"\n})([\"width:var(--input-height-xs);height:var(--input-height-xs);min-width:var(--input-height-xs);min-height:var(--input-height-xs);border-radius:var(--surface-border-radius);\"]);\nexport const Name = styled(Text).withConfig({\n  displayName: \"Comment__Name\",\n  componentId: \"sc-16gyxu7-2\"\n})([\"font-weight:var(--font-weight-medium);color:var(--default-color-accent);transition:opacity 150ms ease;\", \" \", \"\"], ({\n  compact\n}) => compact && css([\"display:flex;align-items:center;grid-gap:10px;margin-bottom:5px;\"]), ({\n  onClick\n}) => onClick && css([\"cursor:pointer;&:hover{opacity:0.65;}\"]));\nexport const MessageTextArea = styled(TextArea).withConfig({\n  displayName: \"Comment__MessageTextArea\",\n  componentId: \"sc-16gyxu7-3\"\n})([\"height:128px;\"]);\nexport const MessageText = styled(Text).withConfig({\n  displayName: \"Comment__MessageText\",\n  componentId: \"sc-16gyxu7-4\"\n})([\"color:black;\"]);\nexport const Content = styled(Column).withConfig({\n  displayName: \"Comment__Content\",\n  componentId: \"sc-16gyxu7-5\"\n})([\"grid-gap:0;width:100%;\"]);\nexport const Meta = styled(Row).withConfig({\n  displayName: \"Comment__Meta\",\n  componentId: \"sc-16gyxu7-6\"\n})([\"grid-gap:5px;\"]);\nexport const Line = styled(Row).withConfig({\n  displayName: \"Comment__Line\",\n  componentId: \"sc-16gyxu7-7\"\n})([\"justify-content:space-between;align-items:center;\"]);\nexport const Actions = styled(Row).withConfig({\n  displayName: \"Comment__Actions\",\n  componentId: \"sc-16gyxu7-8\"\n})([\"position:absolute;top:0;right:0;grid-gap:10px;\"]);\nexport const DispatchUpdatedDate = styled(DateText).withConfig({\n  displayName: \"Comment__DispatchUpdatedDate\",\n  componentId: \"sc-16gyxu7-9\"\n})([\"font-size:var(--font-size-s);color:var(--default-color-text);\"]);\nexport const DispatchTime = styled(DateText).withConfig({\n  displayName: \"Comment__DispatchTime\",\n  componentId: \"sc-16gyxu7-10\"\n})([\"font-size:var(--font-size-s);color:var(--default-color-text);\"]);\nexport const ReplyButton = styled(Button).withConfig({\n  displayName: \"Comment__ReplyButton\",\n  componentId: \"sc-16gyxu7-11\"\n})([\"color:var(--default-color-accent);font-size:var(--font-size-s);font-weight:var(--font-weight-regular);\"]);\nexport const Likes = styled(Row).withConfig({\n  displayName: \"Comment__Likes\",\n  componentId: \"sc-16gyxu7-12\"\n})([\"align-items:center;grid-gap:0;\"]);\nexport const LikesButton = styled(Button).withConfig({\n  displayName: \"Comment__LikesButton\",\n  componentId: \"sc-16gyxu7-13\"\n})([\"span{color:var(--default-color-text);transition:color 150ms ease;}&:hover{span{color:var(--default-color-accent);}}\"]);\nexport const LikeButton = styled(Button).withConfig({\n  displayName: \"Comment__LikeButton\",\n  componentId: \"sc-16gyxu7-14\"\n})([\"&:hover{svg{path,circle{stroke:var(--default-color-accent);}}}\"]);\nexport const Comment = ({\n  user,\n  message,\n  likes,\n  time,\n  className,\n  style,\n  compact,\n  isLiked: initialLiked,\n  isUpdated,\n  isChecked,\n  onLink,\n  onReply,\n  onChecked,\n  onShowLikes,\n  onDelete,\n  onEdit,\n  onLike\n}) => {\n  var _user$avatar$path, _user$avatar, _user$avatar$path2, _user$avatar2;\n\n  const [updatedAt, setUpdatedAt] = useState(isUpdated ? time : null);\n  const [checked, setChecked] = useState(isChecked);\n  const [count, setCount] = useState(likes);\n  const [isEdit, setEdit] = useState(false);\n  const [isLiked, setLiked] = useState(initialLiked);\n  const color = useMemo(() => isLiked ? 'var(--default-color-accent)' : 'var(--default-color-text)', [isLiked]);\n  const textLikes = useMemo(() => count === 1 ? 'человеку' : 'людям', [count]);\n  const [comment, setComment] = useState(message);\n  const commentRef = useRef(null);\n\n  const onClick = () => {\n    const value = !isLiked;\n    if (onLike) onLike(value);\n    setCount(prev => prev + (value ? 1 : -1));\n    setLiked(value);\n  };\n\n  const handleToggleEdit = () => setEdit(prev => !prev);\n\n  const handleChecked = e => {\n    const value = e.target.checked;\n    if (onChecked) onChecked(value);\n    setChecked(value);\n  };\n\n  const handleApplyChanges = () => {\n    var _commentRef$current;\n\n    const value = commentRef === null || commentRef === void 0 ? void 0 : (_commentRef$current = commentRef.current) === null || _commentRef$current === void 0 ? void 0 : _commentRef$current.value;\n\n    if (value) {\n      if (onEdit) onEdit(value);\n      setUpdatedAt(new Date());\n      setComment(value);\n    }\n\n    handleToggleEdit();\n  };\n\n  return /*#__PURE__*/React.createElement(Wrap, {\n    checked: checked,\n    style: style,\n    className: className\n  }, !compact && /*#__PURE__*/React.createElement(Avatar, {\n    src: (_user$avatar$path = user === null || user === void 0 ? void 0 : (_user$avatar = user.avatar) === null || _user$avatar === void 0 ? void 0 : _user$avatar.path) !== null && _user$avatar$path !== void 0 ? _user$avatar$path : ''\n  }), /*#__PURE__*/React.createElement(Content, null, /*#__PURE__*/React.createElement(Name, {\n    compact: compact,\n    onClick: onLink\n  }, compact && /*#__PURE__*/React.createElement(MiniAvatar, {\n    src: (_user$avatar$path2 = user === null || user === void 0 ? void 0 : (_user$avatar2 = user.avatar) === null || _user$avatar2 === void 0 ? void 0 : _user$avatar2.path) !== null && _user$avatar$path2 !== void 0 ? _user$avatar$path2 : ''\n  }), user.name), isEdit ? /*#__PURE__*/React.createElement(MessageTextArea, {\n    ref: commentRef,\n    defaultValue: comment,\n    appearance: 'ghost'\n  }) : /*#__PURE__*/React.createElement(MessageText, null, comment), compact && onEdit && onDelete && /*#__PURE__*/React.createElement(Actions, null, !isEdit ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Tooltip, {\n    text: 'Удалить комментарий'\n  }, /*#__PURE__*/React.createElement(Button, {\n    kind: 'icon',\n    size: 'xs',\n    disabled: checked,\n    appearance: 'red',\n    onClick: onDelete\n  }, /*#__PURE__*/React.createElement(Icon, {\n    icon: 'delete',\n    size: 'xs',\n    stroke: 'white'\n  }))), /*#__PURE__*/React.createElement(Tooltip, {\n    text: 'Редактировать комментарий'\n  }, /*#__PURE__*/React.createElement(Button, {\n    kind: 'icon',\n    size: 'xs',\n    disabled: checked,\n    onClick: handleToggleEdit\n  }, /*#__PURE__*/React.createElement(Icon, {\n    icon: 'edit',\n    size: 'xs',\n    stroke: 'white'\n  }))), /*#__PURE__*/React.createElement(Tooltip, {\n    text: 'Отметить комментарий',\n    self: true\n  }, /*#__PURE__*/React.createElement(Checkbox, {\n    checked: checked,\n    onChange: handleChecked\n  }))) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Tooltip, {\n    text: 'Применить изменения',\n    self: true\n  }, /*#__PURE__*/React.createElement(Button, {\n    kind: 'icon',\n    size: 'xs',\n    disabled: checked,\n    appearance: 'green',\n    onClick: handleApplyChanges\n  }, /*#__PURE__*/React.createElement(Icon, {\n    icon: 'check',\n    size: 'xs',\n    stroke: 'white'\n  }))), /*#__PURE__*/React.createElement(Tooltip, {\n    text: 'Отменить изменения',\n    self: true\n  }, /*#__PURE__*/React.createElement(Button, {\n    kind: 'icon',\n    size: 'xs',\n    disabled: checked,\n    appearance: 'red',\n    onClick: handleToggleEdit\n  }, /*#__PURE__*/React.createElement(Icon, {\n    icon: 'closeSquare',\n    size: 'xs',\n    stroke: 'white'\n  }))))), /*#__PURE__*/React.createElement(Line, null, /*#__PURE__*/React.createElement(Meta, null, updatedAt ? /*#__PURE__*/React.createElement(DispatchUpdatedDate, null, \"\\u041E\\u0442\\u0440\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u043E\", ' ', new Date(updatedAt).toLocaleString('ru-RU', {\n    day: 'numeric',\n    month: 'long',\n    year: 'numeric'\n  })) : /*#__PURE__*/React.createElement(DispatchTime, {\n    text: time\n  }), onReply && /*#__PURE__*/React.createElement(ReplyButton, {\n    appearance: 'clear',\n    onClick: onReply\n  }, \"\\u041E\\u0442\\u0432\\u0435\\u0442\\u0438\\u0442\\u044C\")), /*#__PURE__*/React.createElement(Likes, null, count > 0 && /*#__PURE__*/React.createElement(Tooltip, {\n    text: `${count} ${textLikes} это нравится`\n  }, /*#__PURE__*/React.createElement(LikesButton, {\n    type: 'button',\n    onClick: onShowLikes,\n    appearance: 'clear',\n    size: 'xs'\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      color\n    }\n  }, count))), /*#__PURE__*/React.createElement(Tooltip, {\n    text: 'Мне нравится'\n  }, /*#__PURE__*/React.createElement(LikeButton, {\n    type: 'button',\n    onClick: onClick,\n    appearance: 'clear',\n    size: 'xs'\n  }, /*#__PURE__*/React.createElement(Icon, {\n    icon: 'heart',\n    size: 'xs',\n    stroke: color,\n    fill: isLiked ? 'var(--default-color-accent)' : 'none'\n  })))))));\n};\nexport default Comment;","map":{"version":3,"sources":["C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/atomic-ui/components/Comment/index.js"],"names":["React","useState","useMemo","useRef","styled","css","Row","Column","Avatar","Text","DateText","Button","Icon","Tooltip","Checkbox","TextArea","Wrap","checked","MiniAvatar","Name","compact","onClick","MessageTextArea","MessageText","Content","Meta","Line","Actions","DispatchUpdatedDate","DispatchTime","ReplyButton","Likes","LikesButton","LikeButton","Comment","user","message","likes","time","className","style","isLiked","initialLiked","isUpdated","isChecked","onLink","onReply","onChecked","onShowLikes","onDelete","onEdit","onLike","updatedAt","setUpdatedAt","setChecked","count","setCount","isEdit","setEdit","setLiked","color","textLikes","comment","setComment","commentRef","value","prev","handleToggleEdit","handleChecked","e","target","handleApplyChanges","current","Date","avatar","path","name","toLocaleString","day","month","year"],"mappings":"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","sourcesContent":["import React, { useState, useMemo, useRef } from 'react'\nimport styled, { css } from 'styled-components'\n\nimport Row from '../Row'\nimport Column from '../Column'\nimport Avatar from '../Avatar'\nimport Text from '../Text'\nimport DateText from '../DateText'\nimport Button from '../Button'\nimport Icon from '../Icon'\nimport Tooltip from '../Tooltip'\nimport Checkbox from '../Checkbox'\nimport TextArea from '../TextArea'\n\nexport const Wrap = styled(Row)`\n  position: relative;\n  margin: 0;\n  padding: 0;\n\n  ${({ checked }) =>\n    checked &&\n    css`\n      opacity: 0.45;\n    `}\n`\n\nexport const MiniAvatar = styled(Avatar)`\n  width: var(--input-height-xs);\n  height: var(--input-height-xs);\n  min-width: var(--input-height-xs);\n  min-height: var(--input-height-xs);\n  border-radius: var(--surface-border-radius);\n`\n\nexport const Name = styled(Text)`\n  font-weight: var(--font-weight-medium);\n  color: var(--default-color-accent);\n  transition: opacity 150ms ease;\n\n  ${({ compact }) =>\n    compact &&\n    css`\n      display: flex;\n      align-items: center;\n      grid-gap: 10px;\n      margin-bottom: 5px;\n    `}\n\n  ${({ onClick }) =>\n    onClick &&\n    css`\n      cursor: pointer;\n\n      &:hover {\n        opacity: 0.65;\n      }\n    `}\n`\n\nexport const MessageTextArea = styled(TextArea)`\n  height: 128px;\n`\n\nexport const MessageText = styled(Text)`\n  color: black;\n`\n\nexport const Content = styled(Column)`\n  grid-gap: 0;\n  width: 100%;\n`\n\nexport const Meta = styled(Row)`\n  grid-gap: 5px;\n`\n\nexport const Line = styled(Row)`\n  justify-content: space-between;\n  align-items: center;\n`\n\nexport const Actions = styled(Row)`\n  position: absolute;\n  top: 0;\n  right: 0;\n  grid-gap: 10px;\n`\n\nexport const DispatchUpdatedDate = styled(DateText)`\n  font-size: var(--font-size-s);\n  color: var(--default-color-text);\n`\n\nexport const DispatchTime = styled(DateText)`\n  font-size: var(--font-size-s);\n  color: var(--default-color-text);\n`\n\nexport const ReplyButton = styled(Button)`\n  color: var(--default-color-accent);\n  font-size: var(--font-size-s);\n  font-weight: var(--font-weight-regular);\n`\n\nexport const Likes = styled(Row)`\n  align-items: center;\n  grid-gap: 0;\n`\n\nexport const LikesButton = styled(Button)`\n  span {\n    color: var(--default-color-text);\n    transition: color 150ms ease;\n  }\n\n  &:hover {\n    span {\n      color: var(--default-color-accent);\n    }\n  }\n`\n\nexport const LikeButton = styled(Button)`\n  &:hover {\n    svg {\n      path,\n      circle {\n        stroke: var(--default-color-accent);\n      }\n    }\n  }\n`\n\nexport const Comment = ({\n  user,\n  message,\n  likes,\n  time,\n  className,\n  style,\n  compact,\n  isLiked: initialLiked,\n  isUpdated,\n  isChecked,\n  onLink,\n  onReply,\n  onChecked,\n  onShowLikes,\n  onDelete,\n  onEdit,\n  onLike\n}) => {\n  const [updatedAt, setUpdatedAt] = useState(isUpdated ? time : null)\n  const [checked, setChecked] = useState(isChecked)\n  const [count, setCount] = useState(likes)\n  const [isEdit, setEdit] = useState(false)\n  const [isLiked, setLiked] = useState(initialLiked)\n  const color = useMemo(\n    () => (isLiked ? 'var(--default-color-accent)' : 'var(--default-color-text)'),\n    [isLiked]\n  )\n  const textLikes = useMemo(() => (count === 1 ? 'человеку' : 'людям'), [count])\n  const [comment, setComment] = useState(message)\n  const commentRef = useRef(null)\n\n  const onClick = () => {\n    const value = !isLiked\n    if (onLike) onLike(value)\n    setCount((prev) => prev + (value ? 1 : -1))\n    setLiked(value)\n  }\n\n  const handleToggleEdit = () => setEdit((prev) => !prev)\n\n  const handleChecked = (e) => {\n    const value = e.target.checked\n    if (onChecked) onChecked(value)\n    setChecked(value)\n  }\n\n  const handleApplyChanges = () => {\n    const value = commentRef?.current?.value\n\n    if (value) {\n      if (onEdit) onEdit(value)\n      setUpdatedAt(new Date())\n      setComment(value)\n    }\n    handleToggleEdit()\n  }\n\n  return (\n    <Wrap checked={checked} style={style} className={className}>\n      {!compact && <Avatar src={user?.avatar?.path ?? ''} />}\n\n      <Content>\n        <Name compact={compact} onClick={onLink}>\n          {compact && <MiniAvatar src={user?.avatar?.path ?? ''} />}\n          {user.name}\n        </Name>\n\n        {isEdit ? (\n          <MessageTextArea ref={commentRef} defaultValue={comment} appearance={'ghost'} />\n        ) : (\n          <MessageText>{comment}</MessageText>\n        )}\n\n        {compact && onEdit && onDelete && (\n          <Actions>\n            {!isEdit ? (\n              <React.Fragment>\n                <Tooltip text={'Удалить комментарий'}>\n                  <Button\n                    kind={'icon'}\n                    size={'xs'}\n                    disabled={checked}\n                    appearance={'red'}\n                    onClick={onDelete}>\n                    <Icon icon={'delete'} size={'xs'} stroke={'white'} />\n                  </Button>\n                </Tooltip>\n                <Tooltip text={'Редактировать комментарий'}>\n                  <Button kind={'icon'} size={'xs'} disabled={checked} onClick={handleToggleEdit}>\n                    <Icon icon={'edit'} size={'xs'} stroke={'white'} />\n                  </Button>\n                </Tooltip>\n                <Tooltip text={'Отметить комментарий'} self>\n                  <Checkbox checked={checked} onChange={handleChecked} />\n                </Tooltip>\n              </React.Fragment>\n            ) : (\n              <React.Fragment>\n                <Tooltip text={'Применить изменения'} self>\n                  <Button\n                    kind={'icon'}\n                    size={'xs'}\n                    disabled={checked}\n                    appearance={'green'}\n                    onClick={handleApplyChanges}>\n                    <Icon icon={'check'} size={'xs'} stroke={'white'} />\n                  </Button>\n                </Tooltip>\n                <Tooltip text={'Отменить изменения'} self>\n                  <Button\n                    kind={'icon'}\n                    size={'xs'}\n                    disabled={checked}\n                    appearance={'red'}\n                    onClick={handleToggleEdit}>\n                    <Icon icon={'closeSquare'} size={'xs'} stroke={'white'} />\n                  </Button>\n                </Tooltip>\n              </React.Fragment>\n            )}\n          </Actions>\n        )}\n\n        <Line>\n          <Meta>\n            {updatedAt ? (\n              <DispatchUpdatedDate>\n                Отредактировано{' '}\n                {new Date(updatedAt).toLocaleString('ru-RU', {\n                  day: 'numeric',\n                  month: 'long',\n                  year: 'numeric'\n                })}\n              </DispatchUpdatedDate>\n            ) : (\n              <DispatchTime text={time} />\n            )}\n\n            {onReply && (\n              <ReplyButton appearance={'clear'} onClick={onReply}>\n                Ответить\n              </ReplyButton>\n            )}\n          </Meta>\n\n          <Likes>\n            {count > 0 && (\n              <Tooltip text={`${count} ${textLikes} это нравится`}>\n                <LikesButton type={'button'} onClick={onShowLikes} appearance={'clear'} size={'xs'}>\n                  <span style={{ color }}>{count}</span>\n                </LikesButton>\n              </Tooltip>\n            )}\n            <Tooltip text={'Мне нравится'}>\n              <LikeButton type={'button'} onClick={onClick} appearance={'clear'} size={'xs'}>\n                <Icon\n                  icon={'heart'}\n                  size={'xs'}\n                  stroke={color}\n                  fill={isLiked ? 'var(--default-color-accent)' : 'none'}\n                />\n              </LikeButton>\n            </Tooltip>\n          </Likes>\n        </Line>\n      </Content>\n    </Wrap>\n  )\n}\n\nexport default Comment\n"]},"metadata":{},"sourceType":"module"}