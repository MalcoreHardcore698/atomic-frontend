{"ast":null,"code":"import React, { useEffect } from 'react';\nimport styled from 'styled-components';\nimport { useMutation } from '@apollo/react-hooks';\nimport { GoogleLogin } from 'react-google-login';\nimport FacebookLogin from 'react-facebook-login/dist/facebook-login-render-props';\nimport Container from '../../atomic-ui/components/Container';\nimport Row from '../../atomic-ui/components/Row';\nimport Column from '../../atomic-ui/components/Column';\nimport Title from '../../atomic-ui/components/Title';\nimport Input from '../../atomic-ui/components/Input';\nimport Button from '../../atomic-ui/components/Button';\nimport Divider from '../../atomic-ui/components/Divider';\nimport Icon from '../../atomic-ui/components/Icon';\nimport Alert from '../../atomic-ui/components/Alert';\nimport Form from '../Form';\nconst GOOGLE_CLIENT_ID = '1008300307671-dvv5no8uimgk2lodr76m9rnnva8g0lii.apps.googleusercontent.com';\nconst FACEBOOK_APP_ID = 697333197849130;\nexport const StretchButton = styled(Button).withConfig({\n  displayName: \"FormCheckin__StretchButton\",\n  componentId: \"sc-115b6b6-0\"\n})([\"flex-grow:1;\"]);\nexport const SocialButtons = styled(Row).withConfig({\n  displayName: \"FormCheckin__SocialButtons\",\n  componentId: \"sc-115b6b6-1\"\n})([\"justify-content:center;\"]);\nexport const GoogleButton = styled(Button).withConfig({\n  displayName: \"FormCheckin__GoogleButton\",\n  componentId: \"sc-115b6b6-2\"\n})([\"background:#c5331e;height:var(--input-height-m);min-height:var(--input-height-m);&:hover{background:#c5331e;opacity:0.65;}\"]);\nexport const FacebookButton = styled(Button).withConfig({\n  displayName: \"FormCheckin__FacebookButton\",\n  componentId: \"sc-115b6b6-3\"\n})([\"background:#4e6297;height:var(--input-height-m);min-height:var(--input-height-m);&:hover{background:#4e6297;opacity:0.65;}\"]);\nexport const GoogleAuthButton = ({\n  mutation,\n  onError,\n  onFinally,\n  onSubmit\n}) => {\n  const [isLoading, setLoading] = React.useState(false);\n  const [auth, {\n    data,\n    error\n  }] = useMutation(mutation);\n  useEffect(() => {\n    if (data && data.googleAuth && data.googleAuth) {\n      setLoading(false);\n      if (onFinally) onFinally(data.googleAuth);\n    }\n  }, [data, onFinally]);\n  useEffect(() => {\n    if (error) {\n      console.log('GoogleAuthButton error', error);\n      setLoading(false);\n    }\n  }, [error]);\n  return /*#__PURE__*/React.createElement(GoogleLogin, {\n    clientId: GOOGLE_CLIENT_ID,\n    onSuccess: response => onSubmit(response, auth),\n    onFailure: onError,\n    onRequest: () => setLoading(true),\n    cookiePolicy: 'single_host_origin',\n    render: ({\n      onClick\n    }) => /*#__PURE__*/React.createElement(GoogleButton, {\n      type: 'button',\n      kind: 'icon',\n      appearance: 'clear',\n      onClick: onClick,\n      disabled: isLoading\n    }, /*#__PURE__*/React.createElement(Icon, {\n      icon: 'google',\n      stroke: 'none',\n      fill: 'white'\n    }))\n  });\n};\nexport const FacebookAuthButton = ({\n  mutation,\n  onError,\n  onFinally,\n  onSubmit\n}) => {\n  const [isLoading, setLoading] = React.useState(false);\n  const [auth, {\n    error,\n    data\n  }] = useMutation(mutation);\n  useEffect(() => {\n    if (data && data.facebookAuth && data.facebookAuth) {\n      setLoading(false);\n      if (onFinally) onFinally(data.facebookAuth);\n    }\n  }, [data, onFinally]);\n  useEffect(() => {\n    if (error) {\n      console.log('FacebookAuthButton error', error);\n      setLoading(false);\n      if (onError) onError(error);\n    }\n  }, [error, onError]);\n\n  const onClick = (event, renderProps) => {\n    event.preventDefault();\n    renderProps.onClick(event);\n    setLoading(true);\n  };\n\n  return /*#__PURE__*/React.createElement(FacebookLogin, {\n    appId: FACEBOOK_APP_ID,\n    autoLoad: false,\n    callback: response => onSubmit(response, auth),\n    render: props => /*#__PURE__*/React.createElement(FacebookButton, {\n      type: 'button',\n      kind: 'icon',\n      appearance: 'clear',\n      onClick: event => onClick(event, props),\n      disabled: isLoading\n    }, /*#__PURE__*/React.createElement(Icon, {\n      icon: 'facebook',\n      stroke: 'none',\n      fill: 'white'\n    }))\n  });\n};\nexport const Checkin = ({\n  title = true,\n  mutations,\n  appearance,\n  className,\n  onGoogleError,\n  onFacebookError,\n  onGoogleFinally,\n  onFacebookFinally,\n  onGoogleSubmit,\n  onFacebookSubmit,\n  onForgot,\n  onCreate,\n  onSubmit\n}) => /*#__PURE__*/React.createElement(Form, {\n  className: className,\n  appearance: appearance,\n  mutation: mutations.checkin,\n  onSubmit: onSubmit\n}, ({\n  watch,\n  register,\n  errors,\n  loading\n}) => {\n  const login = watch('login');\n  return /*#__PURE__*/React.createElement(React.Fragment, null, title && /*#__PURE__*/React.createElement(Container, null, /*#__PURE__*/React.createElement(Title, {\n    style: {\n      textAlign: 'center'\n    },\n    tag: 'h4'\n  }, \"\\u0412\\u0445\\u043E\\u0434\")), /*#__PURE__*/React.createElement(Column, null, errors && errors.login && /*#__PURE__*/React.createElement(Alert, {\n    style: {\n      width: '100%'\n    },\n    appearance: 'error'\n  }, \"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u043E \\u0443\\u043A\\u0430\\u0437\\u0430\\u043D\\u043E \\u0438\\u043B\\u0438 \\u043D\\u0435 \\u0443\\u043A\\u0430\\u0437\\u0430\\u043D\\u043E \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D/\\u044D\\u043B. \\u043F\\u043E\\u0447\\u0442\\u0430\"), /*#__PURE__*/React.createElement(Input, {\n    type: 'text',\n    name: 'login',\n    ref: register({\n      required: true\n    }),\n    placeholder: 'Телефон или адрес эл. почты',\n    appearance: 'ghost',\n    disabled: loading,\n    required: true\n  }), /*#__PURE__*/React.createElement(Button, {\n    type: 'button',\n    appearance: 'link',\n    onClick: onForgot\n  }, \"\\u0417\\u0430\\u0431\\u044B\\u043B\\u0438 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C ?\")), /*#__PURE__*/React.createElement(Row, null, /*#__PURE__*/React.createElement(StretchButton, {\n    type: 'button',\n    disabled: loading,\n    onClick: onCreate\n  }, \"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C \\u0430\\u043A\\u043A\\u0430\\u0443\\u043D\\u0442\"), /*#__PURE__*/React.createElement(StretchButton, {\n    style: {\n      flexGrow: 1\n    },\n    type: 'submit',\n    disabled: !login || loading\n  }, \"\\u0414\\u0430\\u043B\\u0435\\u0435\")), /*#__PURE__*/React.createElement(Divider, null), /*#__PURE__*/React.createElement(SocialButtons, null, /*#__PURE__*/React.createElement(GoogleAuthButton, {\n    mutation: mutations.googleAuth,\n    onError: onGoogleError,\n    onFinally: onGoogleFinally,\n    onSubmit: onGoogleSubmit\n  }), /*#__PURE__*/React.createElement(FacebookAuthButton, {\n    mutation: mutations.facebookAuth,\n    onError: onFacebookError,\n    onFinally: onFacebookFinally,\n    onSubmit: onFacebookSubmit\n  })));\n});\nexport default Checkin;","map":null,"metadata":{},"sourceType":"module"}