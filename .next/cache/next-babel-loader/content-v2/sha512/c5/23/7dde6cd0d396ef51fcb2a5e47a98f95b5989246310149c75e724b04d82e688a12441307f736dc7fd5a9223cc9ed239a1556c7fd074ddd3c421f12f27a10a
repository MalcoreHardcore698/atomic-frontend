{"ast":null,"code":"function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport React, { useMemo, useState } from 'react';\nimport styled from 'styled-components';\nimport { useSelector, useDispatch } from 'react-redux';\nimport Title from '../atomic-ui/components/Title';\nimport ProjectList from '../components/ProjectList';\nimport ArticleList from '../components/ArticleList';\nimport UserList from '../components/UserList';\nimport { useHelper } from '../hooks/useHelper';\nimport { useMutate } from '../hooks/useMutate';\nimport ContentLayout from '../layouts/content';\nimport { updateUser } from '../store/actions/user';\nimport { onProjectLink, onProjectAdd, onProjectScreenshot } from '../store/helpers/project';\nimport { onUserAboutMore, onUserLink } from '../store/helpers/user';\nimport queries from '../graphql/queries';\nimport { initializeApollo } from '../apollo';\nvar TITLE = 'Атомик';\nvar START_OFFSET = 13;\nvar LIMIT = 5;\nvar Container = styled.div.withConfig({\n  displayName: \"pages__Container\",\n  componentId: \"sc-1kp8388-0\"\n})([\"display:grid;grid-template-columns:1fr min-content;grid-gap:var(--default-gap);margin-bottom:80px;@media only screen and (max-width:1196px){grid-template-columns:1fr;}\"]);\nvar Aside = styled.aside.withConfig({\n  displayName: \"pages__Aside\",\n  componentId: \"sc-1kp8388-1\"\n})([\"display:flex;flex-direction:column;grid-gap:var(--default-gap);width:394px;@media only screen and (max-width:1196px){width:auto;}\"]);\n\nvar Home = function Home(_ref) {\n  var store = _ref.store;\n  var recall = useHelper();\n  var mutate = useMutate();\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      search = _useState2[0],\n      setSearch = _useState2[1];\n\n  var user = useSelector(function (state) {\n    return state.user;\n  });\n  var dispatch = useDispatch();\n  var scaffold = useMemo(function () {\n    var _store$projects, _store$projects2;\n\n    return {\n      title: 'Создавай школу будущего с нами',\n      background: '/images/main-background.png',\n      primary: ((_store$projects = store.projects) === null || _store$projects === void 0 ? void 0 : _store$projects.length) > 0 && store.projects[0],\n      residue: ((_store$projects2 = store.projects) === null || _store$projects2 === void 0 ? void 0 : _store$projects2.length) === 3 && store.projects.slice(1, 3),\n      onLink: function onLink(project, owned) {\n        return recall(onProjectLink, {\n          id: project.id,\n          auth: user === null || user === void 0 ? void 0 : user.email,\n          project: project,\n          liked: !!((user === null || user === void 0 ? void 0 : user.likedProjects) || []).find(function (item) {\n            return item.id === project.id;\n          }),\n          onLike: user.email && mutate(queries.LIKE_PROJECT, {\n            id: project.id\n          }, function (response) {\n            return dispatch(updateUser(response.data.likeProject));\n          }),\n          onAdd: user.email && recall(onProjectAdd, {\n            id: project.id,\n            project: project,\n            folders: user === null || user === void 0 ? void 0 : user.folders,\n            mutations: {\n              addProject: queries.ADD_USER_PROJECT,\n              createFolder: queries.ADD_USER_FOLDER\n            }\n          }),\n          owned: owned\n        })();\n      },\n      onLike: user.email && function (project) {\n        return mutate(queries.LIKE_PROJECT, {\n          id: project.id\n        }, function (response) {\n          return dispatch(updateUser(response.data.likeProject));\n        })();\n      },\n      onAdd: user.email && function (project) {\n        return recall(onProjectAdd, {\n          id: project.id,\n          project: project,\n          folders: user === null || user === void 0 ? void 0 : user.folders,\n          mutations: {\n            addProject: queries.ADD_USER_PROJECT,\n            createFolder: queries.ADD_USER_FOLDER\n          }\n        })();\n      },\n      onSearch: function onSearch(value) {\n        return setSearch(value);\n      },\n      onAboutMore: function onAboutMore(project) {\n        return recall(onUserAboutMore, {\n          user: project\n        });\n      },\n      onCompanyLink: function onCompanyLink(project) {\n        var _project$company;\n\n        return recall(onUserLink, {\n          id: (_project$company = project.company) === null || _project$company === void 0 ? void 0 : _project$company.email,\n          auth: user\n        })();\n      },\n      onScreenshotClick: function onScreenshotClick(project, key) {\n        return recall(onProjectScreenshot, {\n          screenshots: [project.preview].concat(_toConsumableArray(project.screenshots)),\n          key: key\n        })();\n      }\n    };\n  }, []);\n  return /*#__PURE__*/React.createElement(ContentLayout, {\n    title: TITLE,\n    limit: LIMIT,\n    research: search,\n    scaffold: scaffold,\n    startOffset: START_OFFSET,\n    query: queries.GET_PROJECTS,\n    variables: {\n      status: 'PUBLISHED'\n    },\n    initialize: true\n  }, function (_ref2) {\n    var documents = _ref2.documents;\n    return /*#__PURE__*/React.createElement(Container, null, /*#__PURE__*/React.createElement(ProjectList, {\n      initialList: documents,\n      layout: true\n    }), /*#__PURE__*/React.createElement(Aside, null, /*#__PURE__*/React.createElement(Title, {\n      tag: 'h4'\n    }, \"\\u0410\\u0432\\u0442\\u043E\\u0440\\u044B\"), /*#__PURE__*/React.createElement(UserList, {\n      variables: {\n        offset: 0,\n        limit: 3\n      }\n    }), /*#__PURE__*/React.createElement(Title, {\n      tag: 'h4'\n    }, \"\\u041D\\u043E\\u0432\\u043E\\u0441\\u0442\\u0438\"), /*#__PURE__*/React.createElement(ArticleList, {\n      variables: {\n        offset: 0,\n        limit: 2\n      }\n    })));\n  });\n};\n\nexport function getServerSideProps() {\n  return _getServerSideProps.apply(this, arguments);\n}\n\nfunction _getServerSideProps() {\n  _getServerSideProps = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n    var client, projects, response;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            client = initializeApollo();\n            projects = [];\n            _context.prev = 2;\n            _context.next = 5;\n            return client.query({\n              query: queries.GET_PROJECTS,\n              variables: {\n                offset: 0,\n                limit: 3\n              }\n            });\n\n          case 5:\n            response = _context.sent;\n\n            if (response && response.data) {\n              projects = response.data.getProjects;\n            }\n\n            _context.next = 12;\n            break;\n\n          case 9:\n            _context.prev = 9;\n            _context.t0 = _context[\"catch\"](2);\n            console.log(_context.t0);\n\n          case 12:\n            return _context.abrupt(\"return\", {\n              props: {\n                store: {\n                  projects: projects\n                }\n              }\n            });\n\n          case 13:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[2, 9]]);\n  }));\n  return _getServerSideProps.apply(this, arguments);\n}\n\nexport default Home;","map":{"version":3,"sources":["C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/pages/index.js"],"names":["React","useMemo","useState","styled","useSelector","useDispatch","Title","ProjectList","ArticleList","UserList","useHelper","useMutate","ContentLayout","updateUser","onProjectLink","onProjectAdd","onProjectScreenshot","onUserAboutMore","onUserLink","queries","initializeApollo","TITLE","START_OFFSET","LIMIT","Container","div","Aside","aside","Home","store","recall","mutate","search","setSearch","user","state","dispatch","scaffold","title","background","primary","projects","length","residue","slice","onLink","project","owned","id","auth","email","liked","likedProjects","find","item","onLike","LIKE_PROJECT","response","data","likeProject","onAdd","folders","mutations","addProject","ADD_USER_PROJECT","createFolder","ADD_USER_FOLDER","onSearch","value","onAboutMore","onCompanyLink","company","onScreenshotClick","key","screenshots","preview","GET_PROJECTS","status","documents","offset","limit","getServerSideProps","client","query","variables","getProjects","console","log","props"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,OAAhB,EAAyBC,QAAzB,QAAyC,OAAzC;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AAEA,OAAOC,KAAP,MAAkB,+BAAlB;AAEA,OAAOC,WAAP,MAAwB,2BAAxB;AACA,OAAOC,WAAP,MAAwB,2BAAxB;AACA,OAAOC,QAAP,MAAqB,wBAArB;AACA,SAASC,SAAT,QAA0B,oBAA1B;AACA,SAASC,SAAT,QAA0B,oBAA1B;AACA,OAAOC,aAAP,MAA0B,oBAA1B;AACA,SAASC,UAAT,QAA2B,uBAA3B;AACA,SAASC,aAAT,EAAwBC,YAAxB,EAAsCC,mBAAtC,QAAiE,0BAAjE;AACA,SAASC,eAAT,EAA0BC,UAA1B,QAA4C,uBAA5C;AACA,OAAOC,OAAP,MAAoB,oBAApB;AACA,SAASC,gBAAT,QAAiC,WAAjC;AAEA,IAAMC,KAAK,GAAG,QAAd;AACA,IAAMC,YAAY,GAAG,EAArB;AACA,IAAMC,KAAK,GAAG,CAAd;AAEA,IAAMC,SAAS,GAAGrB,MAAM,CAACsB,GAAV;AAAA;AAAA;AAAA,+KAAf;AAWA,IAAMC,KAAK,GAAGvB,MAAM,CAACwB,KAAV;AAAA;AAAA;AAAA,yIAAX;;AAWA,IAAMC,IAAI,GAAG,SAAPA,IAAO,OAAe;AAAA,MAAZC,KAAY,QAAZA,KAAY;AAC1B,MAAMC,MAAM,GAAGpB,SAAS,EAAxB;AACA,MAAMqB,MAAM,GAAGpB,SAAS,EAAxB;;AAF0B,kBAGET,QAAQ,CAAC,IAAD,CAHV;AAAA;AAAA,MAGnB8B,MAHmB;AAAA,MAGXC,SAHW;;AAI1B,MAAMC,IAAI,GAAG9B,WAAW,CAAC,UAAC+B,KAAD;AAAA,WAAWA,KAAK,CAACD,IAAjB;AAAA,GAAD,CAAxB;AACA,MAAME,QAAQ,GAAG/B,WAAW,EAA5B;AAEA,MAAMgC,QAAQ,GAAGpC,OAAO,CACtB;AAAA;;AAAA,WAAO;AACLqC,MAAAA,KAAK,EAAE,gCADF;AAELC,MAAAA,UAAU,EAAE,6BAFP;AAGLC,MAAAA,OAAO,EAAE,oBAAAX,KAAK,CAACY,QAAN,oEAAgBC,MAAhB,IAAyB,CAAzB,IAA8Bb,KAAK,CAACY,QAAN,CAAe,CAAf,CAHlC;AAILE,MAAAA,OAAO,EAAE,qBAAAd,KAAK,CAACY,QAAN,sEAAgBC,MAAhB,MAA2B,CAA3B,IAAgCb,KAAK,CAACY,QAAN,CAAeG,KAAf,CAAqB,CAArB,EAAwB,CAAxB,CAJpC;AAKLC,MAAAA,MAAM,EAAE,gBAACC,OAAD,EAAUC,KAAV;AAAA,eACNjB,MAAM,CAAChB,aAAD,EAAgB;AACpBkC,UAAAA,EAAE,EAAEF,OAAO,CAACE,EADQ;AAEpBC,UAAAA,IAAI,EAAEf,IAAF,aAAEA,IAAF,uBAAEA,IAAI,CAAEgB,KAFQ;AAGpBJ,UAAAA,OAAO,EAAPA,OAHoB;AAIpBK,UAAAA,KAAK,EAAE,CAAC,CAAC,CAAC,CAAAjB,IAAI,SAAJ,IAAAA,IAAI,WAAJ,YAAAA,IAAI,CAAEkB,aAAN,KAAuB,EAAxB,EAA4BC,IAA5B,CAAiC,UAACC,IAAD;AAAA,mBAAUA,IAAI,CAACN,EAAL,KAAYF,OAAO,CAACE,EAA9B;AAAA,WAAjC,CAJW;AAKpBO,UAAAA,MAAM,EACJrB,IAAI,CAACgB,KAAL,IACAnB,MAAM,CAACZ,OAAO,CAACqC,YAAT,EAAuB;AAAER,YAAAA,EAAE,EAAEF,OAAO,CAACE;AAAd,WAAvB,EAA2C,UAACS,QAAD;AAAA,mBAC/CrB,QAAQ,CAACvB,UAAU,CAAC4C,QAAQ,CAACC,IAAT,CAAcC,WAAf,CAAX,CADuC;AAAA,WAA3C,CAPY;AAUpBC,UAAAA,KAAK,EACH1B,IAAI,CAACgB,KAAL,IACApB,MAAM,CAACf,YAAD,EAAe;AACnBiC,YAAAA,EAAE,EAAEF,OAAO,CAACE,EADO;AAEnBF,YAAAA,OAAO,EAAPA,OAFmB;AAGnBe,YAAAA,OAAO,EAAE3B,IAAF,aAAEA,IAAF,uBAAEA,IAAI,CAAE2B,OAHI;AAInBC,YAAAA,SAAS,EAAE;AACTC,cAAAA,UAAU,EAAE5C,OAAO,CAAC6C,gBADX;AAETC,cAAAA,YAAY,EAAE9C,OAAO,CAAC+C;AAFb;AAJQ,WAAf,CAZY;AAqBpBnB,UAAAA,KAAK,EAALA;AArBoB,SAAhB,CAAN,EADM;AAAA,OALH;AA6BLQ,MAAAA,MAAM,EACJrB,IAAI,CAACgB,KAAL,IACC,UAACJ,OAAD;AAAA,eACCf,MAAM,CAACZ,OAAO,CAACqC,YAAT,EAAuB;AAAER,UAAAA,EAAE,EAAEF,OAAO,CAACE;AAAd,SAAvB,EAA2C,UAACS,QAAD;AAAA,iBAC/CrB,QAAQ,CAACvB,UAAU,CAAC4C,QAAQ,CAACC,IAAT,CAAcC,WAAf,CAAX,CADuC;AAAA,SAA3C,CAAN,EADD;AAAA,OA/BE;AAmCLC,MAAAA,KAAK,EACH1B,IAAI,CAACgB,KAAL,IACC,UAACJ,OAAD;AAAA,eACChB,MAAM,CAACf,YAAD,EAAe;AACnBiC,UAAAA,EAAE,EAAEF,OAAO,CAACE,EADO;AAEnBF,UAAAA,OAAO,EAAPA,OAFmB;AAGnBe,UAAAA,OAAO,EAAE3B,IAAF,aAAEA,IAAF,uBAAEA,IAAI,CAAE2B,OAHI;AAInBC,UAAAA,SAAS,EAAE;AACTC,YAAAA,UAAU,EAAE5C,OAAO,CAAC6C,gBADX;AAETC,YAAAA,YAAY,EAAE9C,OAAO,CAAC+C;AAFb;AAJQ,SAAf,CAAN,EADD;AAAA,OArCE;AA+CLC,MAAAA,QAAQ,EAAE,kBAACC,KAAD;AAAA,eAAWnC,SAAS,CAACmC,KAAD,CAApB;AAAA,OA/CL;AAgDLC,MAAAA,WAAW,EAAE,qBAACvB,OAAD;AAAA,eAAahB,MAAM,CAACb,eAAD,EAAkB;AAAEiB,UAAAA,IAAI,EAAEY;AAAR,SAAlB,CAAnB;AAAA,OAhDR;AAiDLwB,MAAAA,aAAa,EAAE,uBAACxB,OAAD;AAAA;;AAAA,eAAahB,MAAM,CAACZ,UAAD,EAAa;AAAE8B,UAAAA,EAAE,sBAAEF,OAAO,CAACyB,OAAV,qDAAE,iBAAiBrB,KAAvB;AAA8BD,UAAAA,IAAI,EAAEf;AAApC,SAAb,CAAN,EAAb;AAAA,OAjDV;AAkDLsC,MAAAA,iBAAiB,EAAE,2BAAC1B,OAAD,EAAU2B,GAAV;AAAA,eACjB3C,MAAM,CAACd,mBAAD,EAAsB;AAC1B0D,UAAAA,WAAW,GAAG5B,OAAO,CAAC6B,OAAX,4BAAuB7B,OAAO,CAAC4B,WAA/B,EADe;AAE1BD,UAAAA,GAAG,EAAHA;AAF0B,SAAtB,CAAN,EADiB;AAAA;AAlDd,KAAP;AAAA,GADsB,EAyDtB,EAzDsB,CAAxB;AA4DA,sBACE,oBAAC,aAAD;AACE,IAAA,KAAK,EAAEpD,KADT;AAEE,IAAA,KAAK,EAAEE,KAFT;AAGE,IAAA,QAAQ,EAAES,MAHZ;AAIE,IAAA,QAAQ,EAAEK,QAJZ;AAKE,IAAA,WAAW,EAAEf,YALf;AAME,IAAA,KAAK,EAAEH,OAAO,CAACyD,YANjB;AAOE,IAAA,SAAS,EAAE;AAAEC,MAAAA,MAAM,EAAE;AAAV,KAPb;AAQE,IAAA,UAAU;AARZ,KASG;AAAA,QAAGC,SAAH,SAAGA,SAAH;AAAA,wBACC,oBAAC,SAAD,qBACE,oBAAC,WAAD;AAAa,MAAA,WAAW,EAAEA,SAA1B;AAAqC,MAAA,MAAM;AAA3C,MADF,eAGE,oBAAC,KAAD,qBACE,oBAAC,KAAD;AAAO,MAAA,GAAG,EAAE;AAAZ,8CADF,eAEE,oBAAC,QAAD;AAAU,MAAA,SAAS,EAAE;AAAEC,QAAAA,MAAM,EAAE,CAAV;AAAaC,QAAAA,KAAK,EAAE;AAApB;AAArB,MAFF,eAIE,oBAAC,KAAD;AAAO,MAAA,GAAG,EAAE;AAAZ,oDAJF,eAKE,oBAAC,WAAD;AAAa,MAAA,SAAS,EAAE;AAAED,QAAAA,MAAM,EAAE,CAAV;AAAaC,QAAAA,KAAK,EAAE;AAApB;AAAxB,MALF,CAHF,CADD;AAAA,GATH,CADF;AAyBD,CA5FD;;AA8FA,gBAAsBC,kBAAtB;AAAA;AAAA;;;gFAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AACCC,YAAAA,MADD,GACU9D,gBAAgB,EAD1B;AAGDqB,YAAAA,QAHC,GAGU,EAHV;AAAA;AAAA;AAAA,mBAMoByC,MAAM,CAACC,KAAP,CAAa;AAClCA,cAAAA,KAAK,EAAEhE,OAAO,CAACyD,YADmB;AAElCQ,cAAAA,SAAS,EAAE;AACTL,gBAAAA,MAAM,EAAE,CADC;AAETC,gBAAAA,KAAK,EAAE;AAFE;AAFuB,aAAb,CANpB;;AAAA;AAMGvB,YAAAA,QANH;;AAcH,gBAAIA,QAAQ,IAAIA,QAAQ,CAACC,IAAzB,EAA+B;AAC7BjB,cAAAA,QAAQ,GAAGgB,QAAQ,CAACC,IAAT,CAAc2B,WAAzB;AACD;;AAhBE;AAAA;;AAAA;AAAA;AAAA;AAkBHC,YAAAA,OAAO,CAACC,GAAR;;AAlBG;AAAA,6CAqBE;AACLC,cAAAA,KAAK,EAAE;AACL3D,gBAAAA,KAAK,EAAE;AACLY,kBAAAA,QAAQ,EAARA;AADK;AADF;AADF,aArBF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;AA8BP,eAAeb,IAAf","sourcesContent":["import React, { useMemo, useState } from 'react'\nimport styled from 'styled-components'\nimport { useSelector, useDispatch } from 'react-redux'\n\nimport Title from '../atomic-ui/components/Title'\n\nimport ProjectList from '../components/ProjectList'\nimport ArticleList from '../components/ArticleList'\nimport UserList from '../components/UserList'\nimport { useHelper } from '../hooks/useHelper'\nimport { useMutate } from '../hooks/useMutate'\nimport ContentLayout from '../layouts/content'\nimport { updateUser } from '../store/actions/user'\nimport { onProjectLink, onProjectAdd, onProjectScreenshot } from '../store/helpers/project'\nimport { onUserAboutMore, onUserLink } from '../store/helpers/user'\nimport queries from '../graphql/queries'\nimport { initializeApollo } from '../apollo'\n\nconst TITLE = 'Атомик'\nconst START_OFFSET = 13\nconst LIMIT = 5\n\nconst Container = styled.div`\n  display: grid;\n  grid-template-columns: 1fr min-content;\n  grid-gap: var(--default-gap);\n  margin-bottom: 80px;\n\n  @media only screen and (max-width: 1196px) {\n    grid-template-columns: 1fr;\n  }\n`\n\nconst Aside = styled.aside`\n  display: flex;\n  flex-direction: column;\n  grid-gap: var(--default-gap);\n  width: 394px;\n\n  @media only screen and (max-width: 1196px) {\n    width: auto;\n  }\n`\n\nconst Home = ({ store }) => {\n  const recall = useHelper()\n  const mutate = useMutate()\n  const [search, setSearch] = useState(null)\n  const user = useSelector((state) => state.user)\n  const dispatch = useDispatch()\n\n  const scaffold = useMemo(\n    () => ({\n      title: 'Создавай школу будущего с нами',\n      background: '/images/main-background.png',\n      primary: store.projects?.length > 0 && store.projects[0],\n      residue: store.projects?.length === 3 && store.projects.slice(1, 3),\n      onLink: (project, owned) =>\n        recall(onProjectLink, {\n          id: project.id,\n          auth: user?.email,\n          project,\n          liked: !!(user?.likedProjects || []).find((item) => item.id === project.id),\n          onLike:\n            user.email &&\n            mutate(queries.LIKE_PROJECT, { id: project.id }, (response) =>\n              dispatch(updateUser(response.data.likeProject))\n            ),\n          onAdd:\n            user.email &&\n            recall(onProjectAdd, {\n              id: project.id,\n              project,\n              folders: user?.folders,\n              mutations: {\n                addProject: queries.ADD_USER_PROJECT,\n                createFolder: queries.ADD_USER_FOLDER\n              }\n            }),\n          owned\n        })(),\n      onLike:\n        user.email &&\n        ((project) =>\n          mutate(queries.LIKE_PROJECT, { id: project.id }, (response) =>\n            dispatch(updateUser(response.data.likeProject))\n          )()),\n      onAdd:\n        user.email &&\n        ((project) =>\n          recall(onProjectAdd, {\n            id: project.id,\n            project,\n            folders: user?.folders,\n            mutations: {\n              addProject: queries.ADD_USER_PROJECT,\n              createFolder: queries.ADD_USER_FOLDER\n            }\n          })()),\n      onSearch: (value) => setSearch(value),\n      onAboutMore: (project) => recall(onUserAboutMore, { user: project }),\n      onCompanyLink: (project) => recall(onUserLink, { id: project.company?.email, auth: user })(),\n      onScreenshotClick: (project, key) =>\n        recall(onProjectScreenshot, {\n          screenshots: [project.preview, ...project.screenshots],\n          key\n        })()\n    }),\n    []\n  )\n\n  return (\n    <ContentLayout\n      title={TITLE}\n      limit={LIMIT}\n      research={search}\n      scaffold={scaffold}\n      startOffset={START_OFFSET}\n      query={queries.GET_PROJECTS}\n      variables={{ status: 'PUBLISHED' }}\n      initialize>\n      {({ documents }) => (\n        <Container>\n          <ProjectList initialList={documents} layout />\n\n          <Aside>\n            <Title tag={'h4'}>Авторы</Title>\n            <UserList variables={{ offset: 0, limit: 3 }} />\n\n            <Title tag={'h4'}>Новости</Title>\n            <ArticleList variables={{ offset: 0, limit: 2 }} />\n          </Aside>\n        </Container>\n      )}\n    </ContentLayout>\n  )\n}\n\nexport async function getServerSideProps() {\n  const client = initializeApollo()\n\n  let projects = []\n\n  try {\n    const response = await client.query({\n      query: queries.GET_PROJECTS,\n      variables: {\n        offset: 0,\n        limit: 3\n      }\n    })\n\n    if (response && response.data) {\n      projects = response.data.getProjects\n    }\n  } catch (err) {\n    console.log(err)\n  }\n\n  return {\n    props: {\n      store: {\n        projects\n      }\n    }\n  }\n}\n\nexport default Home\n"]},"metadata":{},"sourceType":"module"}