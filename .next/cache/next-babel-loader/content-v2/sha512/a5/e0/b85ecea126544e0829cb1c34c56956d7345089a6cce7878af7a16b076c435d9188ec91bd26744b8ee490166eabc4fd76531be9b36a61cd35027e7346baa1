{"ast":null,"code":"var _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport styled from 'styled-components';\nimport { useLazyQuery } from '@apollo/react-hooks';\nimport { useSelector } from 'react-redux';\nimport Column from '../../atomic-ui/components/Column';\nimport Table from '../../atomic-ui/components/Table';\nimport Alert from '../../atomic-ui/components/Alert';\nimport Spinner from '../../atomic-ui/components/Spinner';\nimport { GridAside as Container, LowerLoader } from '../Styled';\nimport LazyLoad from '../LazyLoad';\nimport InfiniteScroll from 'react-infinite-scroller';\nimport { useRouter } from 'next/router';\nexport const Wrap = styled(Column).withConfig({\n  displayName: \"List__Wrap\",\n  componentId: \"sc-1jo6mxw-0\"\n})([\"\"]);\nexport const CenterAlert = styled(Alert).withConfig({\n  displayName: \"List__CenterAlert\",\n  componentId: \"sc-1jo6mxw-1\"\n})([\"width:100%;text-align:center;\"]);\nexport const Content = ({\n  load,\n  type,\n  limit,\n  template,\n  component,\n  variables,\n  loading,\n  refetch,\n  startOffset,\n  onChecked,\n  onClick,\n  onEdit,\n  onDelete\n}) => {\n  _s();\n\n  const router = useRouter();\n  const displayMethod = useSelector(state => state.root.displayMethod);\n  const pageStart = useMemo(() => {\n    var _router$query;\n\n    return Number((_router$query = router.query) === null || _router$query === void 0 ? void 0 : _router$query.page) || 1;\n  }, [router]);\n  const [offset, setOffset] = useState(startOffset);\n  const [items, setItems] = useState([]);\n  const [isEnd, setIsEnd] = useState(false);\n  const onCompleted = useCallback(data => {\n    const list = data[type];\n    if (list.length === 0) setIsEnd(true);\n    if (list.length > 0) setItems(prev => [...prev, ...list]);\n    if (limit) setOffset(prev => prev + limit);\n  }, [type, limit, setIsEnd, setOffset, setItems]);\n  console.log(items, offset);\n  const loadMore = useCallback(() => {\n    if (!isEnd && !loading && refetch) {\n      refetch({ ...variables,\n        offset,\n        limit\n      }).then(response => response.data && onCompleted(response.data));\n    }\n  }, [offset, limit, loading, variables, refetch, isEnd]);\n  const renderContent = useCallback(() => {\n    if (displayMethod === 'grid') {\n      return /*#__PURE__*/React.createElement(Container, null, (items || []).map(item => /*#__PURE__*/React.createElement(LazyLoad, {\n        key: item.id || item.email\n      }, component(item))));\n    }\n\n    return /*#__PURE__*/React.createElement(Table, {\n      data: items,\n      template: template,\n      onChecked: onChecked,\n      onClick: onClick,\n      onEdit: onEdit,\n      onDelete: onDelete\n    });\n  }, [items, displayMethod, onChecked, onClick, onEdit, onDelete]);\n\n  const renderLoader = () => /*#__PURE__*/React.createElement(LowerLoader, {\n    key: 'loader'\n  }, /*#__PURE__*/React.createElement(Spinner, null));\n\n  useEffect(() => {\n    const fetching = async () => {\n      if (load && !loading && !refetch && items.length === 0) {\n        const response = await load({\n          variables: { ...variables,\n            offset,\n            limit\n          }\n        });\n        if (response !== null && response !== void 0 && response.data) onCompleted(response.data);\n      }\n    };\n\n    fetching().then();\n  }, [load, loading, items, variables, offset, limit, refetch, onCompleted]);\n  return /*#__PURE__*/React.createElement(InfiniteScroll, {\n    hasMore: !isEnd,\n    pageStart: pageStart || 0,\n    loadMore: loadMore,\n    loader: renderLoader()\n  }, renderContent());\n};\n\n_s(Content, \"ILHvHvKsk/7FGwTGEUD4mHpFjOk=\", false, function () {\n  return [useRouter, useSelector];\n});\n\n_c = Content;\nexport const List = ({\n  type,\n  query,\n  template,\n  variables,\n  component,\n  limit = 6,\n  startOffset = 6,\n  setCheckedList,\n  onChecked,\n  onClick,\n  onEdit,\n  onDelete\n}) => {\n  _s2();\n\n  const [load, {\n    loading,\n    refetch\n  }] = useLazyQuery(query, {\n    variables: { ...variables,\n      offset: 0,\n      limit\n    }\n  });\n  return /*#__PURE__*/React.createElement(Content, {\n    load: load,\n    type: type,\n    limit: limit,\n    refetch: refetch,\n    loading: loading,\n    startOffset: startOffset,\n    template: template,\n    component: component,\n    setcheckedList: setCheckedList,\n    onChecked: onChecked,\n    onClick: onClick,\n    onEdit: onEdit,\n    onDelete: onDelete\n  });\n};\n\n_s2(List, \"aa55gX/xywZDus7SkSwq0YmtBNw=\", false, function () {\n  return [useLazyQuery];\n});\n\n_c2 = List;\nexport default List;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Content\");\n$RefreshReg$(_c2, \"List\");","map":{"version":3,"sources":["C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/components/List/index.js"],"names":["React","useState","useEffect","useCallback","useMemo","styled","useLazyQuery","useSelector","Column","Table","Alert","Spinner","GridAside","Container","LowerLoader","LazyLoad","InfiniteScroll","useRouter","Wrap","CenterAlert","Content","load","type","limit","template","component","variables","loading","refetch","startOffset","onChecked","onClick","onEdit","onDelete","router","displayMethod","state","root","pageStart","Number","query","page","offset","setOffset","items","setItems","isEnd","setIsEnd","onCompleted","data","list","length","prev","console","log","loadMore","then","response","renderContent","map","item","id","email","renderLoader","fetching","List","setCheckedList"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback, useMemo } from 'react'\nimport styled from 'styled-components'\nimport { useLazyQuery } from '@apollo/react-hooks'\nimport { useSelector } from 'react-redux'\n\nimport Column from '../../atomic-ui/components/Column'\nimport Table from '../../atomic-ui/components/Table'\nimport Alert from '../../atomic-ui/components/Alert'\nimport Spinner from '../../atomic-ui/components/Spinner'\n\nimport { GridAside as Container, LowerLoader } from '../Styled'\nimport LazyLoad from '../LazyLoad'\nimport InfiniteScroll from 'react-infinite-scroller'\nimport { useRouter } from 'next/router'\n\nexport const Wrap = styled(Column)``\n\nexport const CenterAlert = styled(Alert)`\n  width: 100%;\n  text-align: center;\n`\n\nexport const Content = ({\n  load,\n  type,\n  limit,\n  template,\n  component,\n  variables,\n  loading,\n  refetch,\n  startOffset,\n  onChecked,\n  onClick,\n  onEdit,\n  onDelete\n}) => {\n  const router = useRouter()\n  const displayMethod = useSelector((state) => state.root.displayMethod)\n\n  const pageStart = useMemo(() => Number(router.query?.page) || 1, [router])\n\n  const [offset, setOffset] = useState(startOffset)\n  const [items, setItems] = useState([])\n  const [isEnd, setIsEnd] = useState(false)\n\n  const onCompleted = useCallback(\n    (data) => {\n      const list = data[type]\n      if (list.length === 0) setIsEnd(true)\n      if (list.length > 0) setItems((prev) => [...prev, ...list])\n      if (limit) setOffset((prev) => prev + limit)\n    },\n    [type, limit, setIsEnd, setOffset, setItems]\n  )\n\n  console.log(items, offset)\n\n  const loadMore = useCallback(() => {\n    if (!isEnd && !loading && refetch) {\n      refetch({ ...variables, offset, limit }).then(\n        (response) => response.data && onCompleted(response.data)\n      )\n    }\n  }, [offset, limit, loading, variables, refetch, isEnd])\n\n  const renderContent = useCallback(() => {\n    if (displayMethod === 'grid') {\n      return (\n        <Container>\n          {(items || []).map((item) => (\n            <LazyLoad key={item.id || item.email}>{component(item)}</LazyLoad>\n          ))}\n        </Container>\n      )\n    }\n    return (\n      <Table\n        data={items}\n        template={template}\n        onChecked={onChecked}\n        onClick={onClick}\n        onEdit={onEdit}\n        onDelete={onDelete}\n      />\n    )\n  }, [items, displayMethod, onChecked, onClick, onEdit, onDelete])\n\n  const renderLoader = () => (\n    <LowerLoader key={'loader'}>\n      <Spinner />\n    </LowerLoader>\n  )\n\n  useEffect(() => {\n    const fetching = async () => {\n      if (load && !loading && !refetch && items.length === 0) {\n        const response = await load({ variables: { ...variables, offset, limit } })\n        if (response?.data) onCompleted(response.data)\n      }\n    }\n    fetching().then()\n  }, [load, loading, items, variables, offset, limit, refetch, onCompleted])\n\n  return (\n    <InfiniteScroll\n      hasMore={!isEnd}\n      pageStart={pageStart || 0}\n      loadMore={loadMore}\n      loader={renderLoader()}>\n      {renderContent()}\n    </InfiniteScroll>\n  )\n}\n\nexport const List = ({\n  type,\n  query,\n  template,\n  variables,\n  component,\n  limit = 6,\n  startOffset = 6,\n  setCheckedList,\n  onChecked,\n  onClick,\n  onEdit,\n  onDelete\n}) => {\n  const [load, { loading, refetch }] = useLazyQuery(query, {\n    variables: {\n      ...variables,\n      offset: 0,\n      limit\n    }\n  })\n\n  return (\n    <Content\n      load={load}\n      type={type}\n      limit={limit}\n      refetch={refetch}\n      loading={loading}\n      startOffset={startOffset}\n      template={template}\n      component={component}\n      setcheckedList={setCheckedList}\n      onChecked={onChecked}\n      onClick={onClick}\n      onEdit={onEdit}\n      onDelete={onDelete}\n    />\n  )\n}\n\nexport default List\n"]},"metadata":{},"sourceType":"module"}