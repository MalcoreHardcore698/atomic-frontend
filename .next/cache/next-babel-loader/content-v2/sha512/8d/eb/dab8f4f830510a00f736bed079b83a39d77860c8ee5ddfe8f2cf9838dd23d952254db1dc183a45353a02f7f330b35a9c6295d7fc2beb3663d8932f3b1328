{"ast":null,"code":"import { useCallback } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { onProjectAdd, onProjectLink, onProjectRemove, onProjectScreenshot } from '../store/helpers/project';\nimport { onUserAboutMore, onUserLink } from '../store/helpers/user';\nimport { setUserFolder, updateUser } from '../store/actions/user';\nimport { useHelper } from './useHelper';\nimport { useMutate } from './useMutate';\nimport queries from '../graphql/queries';\nimport { getProjectLinkProps } from './useEntityQuery';\nexport const useProject = () => {\n  const recall = useHelper();\n  const mutate = useMutate();\n  const {\n    user,\n    folder\n  } = useSelector(state => ({\n    user: state.user,\n    folder: state.root.folder\n  }));\n  const dispatch = useDispatch();\n  const hasAdded = useCallback(project => {\n    var _user$folders;\n\n    return !!(user !== null && user !== void 0 && (_user$folders = user.folders) !== null && _user$folders !== void 0 && _user$folders.find(folder => !!(folder !== null && folder !== void 0 && folder.projects.find(item => item === project.id))));\n  }, [user]);\n  const hasLiked = useCallback(project => !!(project.rating || []).find(item => item.email === user.email), [user]);\n  const onAdd = useCallback(project => recall(onProjectAdd, {\n    id: project.id,\n    folders: user === null || user === void 0 ? void 0 : user.folders,\n    mutations: {\n      addProject: queries.ADD_USER_PROJECT,\n      createFolder: queries.ADD_USER_FOLDER\n    },\n    callback: item => {\n      const result = { ...item,\n        projects: [...item.projects, project.id]\n      };\n      dispatch(setUserFolder(result));\n    }\n  })(), [user, recall, dispatch]);\n  const onLike = useCallback(project => {\n    if (user.email) {\n      mutate(queries.LIKE_PROJECT, {\n        id: project.id\n      }, response => dispatch(updateUser(response.data.likeProject)));\n    }\n  }, [user, mutate, dispatch]);\n  const onLink = useCallback(project => {\n    var _user$projects;\n\n    const owned = user === null || user === void 0 ? void 0 : (_user$projects = user.projects) === null || _user$projects === void 0 ? void 0 : _user$projects.find(candidate => candidate.id === project.id);\n    recall(onProjectLink, getProjectLinkProps(project.id, user, owned, dispatch, mutate, recall, item => {\n      const result = { ...item,\n        projects: [...item.projects, project.id]\n      };\n      dispatch(setUserFolder(result));\n    }))();\n  }, [user, dispatch, mutate, recall]);\n  const onRemove = useCallback(project => recall(onProjectRemove, {\n    id: project.id,\n    folder,\n    mutation: queries.REMOVE_USER_PROJECT\n  })(), [user, recall]);\n  const onAboutMore = useCallback(project => {\n    recall(onUserAboutMore, {\n      user: project\n    })();\n  }, [recall]);\n  const onCompanyLink = useCallback(project => {\n    var _project$company;\n\n    recall(onUserLink, {\n      id: (_project$company = project.company) === null || _project$company === void 0 ? void 0 : _project$company.email,\n      auth: user === null || user === void 0 ? void 0 : user.email,\n      recipient: project.author,\n      query: queries.GET_USER_CHATS,\n      mutation: queries.SEND_MESSAGE\n    })();\n  }, [user, recall]);\n  const onScreenshotClick = useCallback((project, key) => {\n    recall(onProjectScreenshot, {\n      screenshots: [project.preview, ...project.screenshots],\n      key\n    })();\n  }, [recall]);\n  return {\n    user,\n    hasAdded,\n    hasLiked,\n    onAdd,\n    onLike,\n    onLink,\n    onRemove,\n    onAboutMore,\n    onCompanyLink,\n    onScreenshotClick\n  };\n};","map":{"version":3,"sources":["C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/hooks/useProject.js"],"names":["useCallback","useDispatch","useSelector","onProjectAdd","onProjectLink","onProjectRemove","onProjectScreenshot","onUserAboutMore","onUserLink","setUserFolder","updateUser","useHelper","useMutate","queries","getProjectLinkProps","useProject","recall","mutate","user","folder","state","root","dispatch","hasAdded","project","folders","find","projects","item","id","hasLiked","rating","email","onAdd","mutations","addProject","ADD_USER_PROJECT","createFolder","ADD_USER_FOLDER","callback","result","onLike","LIKE_PROJECT","response","data","likeProject","onLink","owned","candidate","onRemove","mutation","REMOVE_USER_PROJECT","onAboutMore","onCompanyLink","company","auth","recipient","author","query","GET_USER_CHATS","SEND_MESSAGE","onScreenshotClick","key","screenshots","preview"],"mappings":"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","sourcesContent":["import { useCallback } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\n\nimport {\n  onProjectAdd,\n  onProjectLink,\n  onProjectRemove,\n  onProjectScreenshot\n} from '../store/helpers/project'\nimport { onUserAboutMore, onUserLink } from '../store/helpers/user'\nimport { setUserFolder, updateUser } from '../store/actions/user'\nimport { useHelper } from './useHelper'\nimport { useMutate } from './useMutate'\nimport queries from '../graphql/queries'\nimport { getProjectLinkProps } from './useEntityQuery'\n\nexport const useProject = () => {\n  const recall = useHelper()\n  const mutate = useMutate()\n  const { user, folder } = useSelector((state) => ({\n    user: state.user,\n    folder: state.root.folder\n  }))\n  const dispatch = useDispatch()\n\n  const hasAdded = useCallback(\n    (project) =>\n      !!user?.folders?.find((folder) => !!folder?.projects.find((item) => item === project.id)),\n    [user]\n  )\n\n  const hasLiked = useCallback(\n    (project) => !!(project.rating || []).find((item) => item.email === user.email),\n    [user]\n  )\n\n  const onAdd = useCallback(\n    (project) =>\n      recall(onProjectAdd, {\n        id: project.id,\n        folders: user?.folders,\n        mutations: {\n          addProject: queries.ADD_USER_PROJECT,\n          createFolder: queries.ADD_USER_FOLDER\n        },\n        callback: (item) => {\n          const result = { ...item, projects: [...item.projects, project.id] }\n          dispatch(setUserFolder(result))\n        }\n      })(),\n    [user, recall, dispatch]\n  )\n\n  const onLike = useCallback(\n    (project) => {\n      if (user.email) {\n        mutate(queries.LIKE_PROJECT, { id: project.id }, (response) =>\n          dispatch(updateUser(response.data.likeProject))\n        )\n      }\n    },\n    [user, mutate, dispatch]\n  )\n\n  const onLink = useCallback(\n    (project) => {\n      const owned = user?.projects?.find((candidate) => candidate.id === project.id)\n      recall(\n        onProjectLink,\n        getProjectLinkProps(project.id, user, owned, dispatch, mutate, recall, (item) => {\n          const result = { ...item, projects: [...item.projects, project.id] }\n          dispatch(setUserFolder(result))\n        })\n      )()\n    },\n    [user, dispatch, mutate, recall]\n  )\n\n  const onRemove = useCallback(\n    (project) =>\n      recall(onProjectRemove, {\n        id: project.id,\n        folder,\n        mutation: queries.REMOVE_USER_PROJECT\n      })(),\n    [user, recall]\n  )\n\n  const onAboutMore = useCallback(\n    (project) => {\n      recall(onUserAboutMore, { user: project })()\n    },\n    [recall]\n  )\n\n  const onCompanyLink = useCallback(\n    (project) => {\n      recall(onUserLink, {\n        id: project.company?.email,\n        auth: user?.email,\n        recipient: project.author,\n        query: queries.GET_USER_CHATS,\n        mutation: queries.SEND_MESSAGE\n      })()\n    },\n    [user, recall]\n  )\n\n  const onScreenshotClick = useCallback(\n    (project, key) => {\n      recall(onProjectScreenshot, {\n        screenshots: [project.preview, ...project.screenshots],\n        key\n      })()\n    },\n    [recall]\n  )\n\n  return {\n    user,\n    hasAdded,\n    hasLiked,\n    onAdd,\n    onLike,\n    onLink,\n    onRemove,\n    onAboutMore,\n    onCompanyLink,\n    onScreenshotClick\n  }\n}\n"]},"metadata":{},"sourceType":"module"}