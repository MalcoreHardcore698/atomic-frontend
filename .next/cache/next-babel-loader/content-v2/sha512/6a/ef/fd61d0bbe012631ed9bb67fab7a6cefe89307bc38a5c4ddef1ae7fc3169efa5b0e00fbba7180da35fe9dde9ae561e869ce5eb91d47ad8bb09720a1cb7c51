{"ast":null,"code":"import _extends from \"C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/node_modules/@babel/runtime/helpers/esm/extends\";\nimport _regeneratorRuntime from \"C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/node_modules/@babel/runtime/regenerator\";\nimport _defineProperty from \"C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _taggedTemplateLiteral from \"C:/Users/dan82/Documents/workspace/FREELANCE/atomic/atomic-frontend/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _templateObject10() {\n  var data = _taggedTemplateLiteral([\"\\n  color: inherit;\\n  padding: var(--default-gap);\\n  text-align: center;\\n\"]);\n\n  _templateObject10 = function _templateObject10() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject9() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  object-fit: cover;\\n  border-radius: var(--surface-border-radius);\\n\"]);\n\n  _templateObject9 = function _templateObject9() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject8() {\n  var data = _taggedTemplateLiteral([\"\\n  img {\\n    height: 128px;\\n  }\\n\"]);\n\n  _templateObject8 = function _templateObject8() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject7() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  width: 100%;\\n  height: 100%;\\n\\n  & > span {\\n    height: 100%;\\n  }\\n\"]);\n\n  _templateObject7 = function _templateObject7() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6() {\n  var data = _taggedTemplateLiteral([\"\\n        color: var(--default-color-red);\\n        border: 2px dashed var(--default-color-red);\\n      \"]);\n\n  _templateObject6 = function _templateObject6() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5() {\n  var data = _taggedTemplateLiteral([\"\\n      color: var(--default-color-red);\\n      border: 2px dashed var(--default-color-red);\\n    \"]);\n\n  _templateObject5 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n\\n  position: relative;\\n  z-index: var(--z-12);\\n\\n  font-weight: var(--font-weight-medium);\\n  font-size: var(--font-size-s);\\n  font-family: var(--font-family);\\n  color: var(--input-placeholder-color);\\n\\n  width: 100%;\\n  height: 100%;\\n  border-radius: var(--surface-border-radius);\\n  border: 2px dashed var(--input-placeholder-color);\\n  outline: none;\\n  overflow: hidden;\\n  flex-grow: 1;\\n\\n  cursor: pointer;\\n  transition: all 150ms ease;\\n\\n  \", \"\\n\\n  &:hover {\\n    color: var(--default-color-accent);\\n    border: 2px dashed var(--default-color-accent);\\n\\n    \", \"\\n  }\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n  cursor: pointer;\\n  transition: opacity 450ms ease;\\n\\n  &:hover {\\n    opacity: 0.65;\\n  }\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  right: var(--default-gap);\\n  bottom: var(--default-gap);\\n  z-index: var(--z-15);\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  position: relative;\\n  display: flex;\\n  flex-direction: column;\\n  grid-gap: 10px;\\n\\n  width: 100%;\\n  height: 256px;\\n  min-height: 256px;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, useCallback } from 'react';\nimport styled, { css } from 'styled-components';\nimport imageCompression from 'browser-image-compression';\nimport { useDropzone } from 'react-dropzone';\nimport { v4 } from 'uuid';\nimport Image from '../Image';\nimport Text from '../Text';\nimport Grid from '../Grid';\nimport Tooltip from '../Tooltip';\nimport Icon from '../Icon';\nexport var Wrap = styled.div(_templateObject());\nexport var InfoTooltip = styled(Tooltip)(_templateObject2());\nexport var InfoIcon = styled(Icon)(_templateObject3());\nexport var Container = styled.div(_templateObject4(), function (_ref) {\n  var error = _ref.error;\n  return error && css(_templateObject5());\n}, function (_ref2) {\n  var error = _ref2.error;\n  return error && css(_templateObject6());\n});\nexport var Area = styled.div(_templateObject7());\nexport var PreviewList = styled(Grid)(_templateObject8());\nexport var Preview = styled(Image)(_templateObject9());\nexport var Placeholder = styled(Text)(_templateObject10());\nexport function getFile(file) {\n  var _file$type;\n\n  return {\n    file: file,\n    id: v4(),\n    blob: ((_file$type = file.type) === null || _file$type === void 0 ? void 0 : _file$type.includes('image')) && URL.createObjectURL(file)\n  };\n}\nexport function compressedUpload(_x) {\n  return _compressedUpload.apply(this, arguments);\n}\n\nfunction _compressedUpload() {\n  _compressedUpload = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(file) {\n    var maxWidthOrHeight,\n        _args2 = arguments;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            maxWidthOrHeight = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : 1366;\n            _context2.prev = 1;\n            _context2.next = 4;\n            return imageCompression(file, {\n              maxSizeMB: 1,\n              maxWidthOrHeight: maxWidthOrHeight,\n              useWebWorker: true\n            });\n\n          case 4:\n            return _context2.abrupt(\"return\", _context2.sent);\n\n          case 7:\n            _context2.prev = 7;\n            _context2.t0 = _context2[\"catch\"](1);\n            console.log(_context2.t0);\n\n          case 10:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[1, 7]]);\n  }));\n  return _compressedUpload.apply(this, arguments);\n}\n\nexport var Dropzone = function Dropzone(_ref3) {\n  var style = _ref3.style,\n      accept = _ref3.accept,\n      className = _ref3.className,\n      defaultValue = _ref3.defaultValue,\n      placeholder = _ref3.placeholder,\n      tooltip = _ref3.tooltip,\n      multiple = _ref3.multiple,\n      maxFiles = _ref3.maxFiles,\n      onChange = _ref3.onChange;\n\n  var _useState = useState(false),\n      error = _useState[0],\n      setError = _useState[1];\n\n  var _useState2 = useState([]),\n      images = _useState2[0],\n      setImages = _useState2[1];\n\n  var onDrop = useCallback( /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(droppedFiles) {\n      var candidate, _iterator, _step, _file$type2, file, compressedFile, miniature, result;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setError(false);\n\n              if (!(droppedFiles.length > maxFiles || droppedFiles.length === 0)) {\n                _context.next = 4;\n                break;\n              }\n\n              setError(true);\n              return _context.abrupt(\"return\", false);\n\n            case 4:\n              if (!multiple) {\n                _context.next = 8;\n                break;\n              }\n\n              _context.t0 = [];\n              _context.next = 11;\n              break;\n\n            case 8:\n              _context.next = 10;\n              return compressedUpload(droppedFiles[0]);\n\n            case 10:\n              _context.t0 = _context.sent;\n\n            case 11:\n              candidate = _context.t0;\n\n              if (!multiple) {\n                _context.next = 41;\n                break;\n              }\n\n              _iterator = _createForOfIteratorHelper(droppedFiles);\n              _context.prev = 14;\n\n              _iterator.s();\n\n            case 16:\n              if ((_step = _iterator.n()).done) {\n                _context.next = 33;\n                break;\n              }\n\n              file = _step.value;\n              compressedFile = void 0;\n              miniature = void 0;\n\n              if (!((_file$type2 = file.type) !== null && _file$type2 !== void 0 && _file$type2.includes('image'))) {\n                _context.next = 29;\n                break;\n              }\n\n              _context.next = 23;\n              return compressedUpload(file);\n\n            case 23:\n              compressedFile = _context.sent;\n              _context.next = 26;\n              return compressedUpload(file, 185);\n\n            case 26:\n              miniature = _context.sent;\n              _context.next = 30;\n              break;\n\n            case 29:\n              compressedFile = file;\n\n            case 30:\n              if (compressedFile) {\n                candidate.push(_objectSpread(_objectSpread({}, getFile(compressedFile)), {}, {\n                  size: compressedFile.size,\n                  miniature: _objectSpread(_objectSpread({}, getFile(miniature)), {}, {\n                    size: miniature.size\n                  })\n                }));\n              }\n\n            case 31:\n              _context.next = 16;\n              break;\n\n            case 33:\n              _context.next = 38;\n              break;\n\n            case 35:\n              _context.prev = 35;\n              _context.t1 = _context[\"catch\"](14);\n\n              _iterator.e(_context.t1);\n\n            case 38:\n              _context.prev = 38;\n\n              _iterator.f();\n\n              return _context.finish(38);\n\n            case 41:\n              result = candidate.length > 1 ? candidate : _objectSpread(_objectSpread({}, getFile(candidate)), {}, {\n                size: droppedFiles[0].size\n              });\n              setImages(result);\n\n              if (onChange) {\n                onChange(result);\n              }\n\n            case 44:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[14, 35, 38, 41]]);\n    }));\n\n    return function (_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }(), [setImages]);\n\n  var _useDropzone = useDropzone({\n    onDrop: onDrop,\n    multiple: multiple,\n    accept: accept\n  }),\n      getRootProps = _useDropzone.getRootProps,\n      getInputProps = _useDropzone.getInputProps,\n      isDragActive = _useDropzone.isDragActive;\n\n  return __jsx(Wrap, {\n    className: className,\n    style: style\n  }, tooltip && __jsx(InfoTooltip, {\n    text: tooltip,\n    maxWidth: 215\n  }, __jsx(InfoIcon, {\n    size: 's',\n    icon: 'infoCircle',\n    stroke: (defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.length) > 0 ? 'white' : 'var(--default-color-accent)'\n  })), __jsx(Container, _extends({\n    className: 'dropzone-container'\n  }, getRootProps(), {\n    error: error\n  }), __jsx(\"input\", _extends({\n    accept: accept\n  }, getInputProps(), {\n    hidden: true\n  })), __jsx(Area, {\n    className: 'dropzone-area',\n    active: isDragActive\n  }, !defaultValue && images.length === 0 && __jsx(Placeholder, null, error ? \"\\u0424\\u0430\\u0439\\u043B\\u043E\\u0432 \\u043D\\u0435 \\u043C\\u043E\\u0436\\u0435\\u0442 \\u0431\\u044B\\u0442\\u044C \\u0431\\u043E\\u043B\\u044C\\u0448\\u0435 \".concat(maxFiles, \" \\u0438\\u043B\\u0438 \\u0440\\u0430\\u0432\\u043D\\u043E \\u043D\\u0443\\u043B\\u044E\") : placeholder), multiple && (Array.isArray(images) && images.length > 1 || Array.isArray(defaultValue) && (defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.length) > 1) && __jsx(PreviewList, {\n    percentage: 'minmax(196px, 1fr)'\n  }, (defaultValue || images).map(function (file) {\n    return __jsx(Preview, {\n      key: v4(),\n      src: (file === null || file === void 0 ? void 0 : file.blob) || file,\n      alt: file.id\n    });\n  })), !multiple && (!Array.isArray(images) || defaultValue) && __jsx(Preview, {\n    src: images.blob || (defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.path) || (defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.blob),\n    alt: defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.name\n  }))));\n};\nDropzone.defaultProps = {\n  maxFiles: 1,\n  multiple: false\n};\nexport default Dropzone;","map":null,"metadata":{},"sourceType":"module"}