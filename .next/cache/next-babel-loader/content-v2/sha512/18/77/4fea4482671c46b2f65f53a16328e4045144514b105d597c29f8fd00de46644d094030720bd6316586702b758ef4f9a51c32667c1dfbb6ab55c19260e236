{"ast":null,"code":"import React, { memo } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useLazyQuery } from '@apollo/react-hooks';\nimport GlobalSearch from '../../atomic-ui/components/GlobalSearch';\nimport { Card } from '../../layouts/dashboard/content';\nimport { setModal } from '../../store/actions/modal';\nimport { useArticle } from '../../hooks/useArticle';\nimport { useProject } from '../../hooks/useProject';\nimport { useUser } from '../../hooks/useUser';\nconst hooks = {\n  getUsers: useUser,\n  // getCategories: useCategory\n  getArticles: useArticle,\n  getProjects: useProject // getTickets: useTicket,\n  // getRoles: useRole\n\n};\n\nconst CardWrapper = ({\n  item,\n  elem,\n  onJump\n}) => {\n  const props = hooks[elem.value] ? hooks[elem.value]() : {};\n  const dispatch = useDispatch();\n\n  const hideModal = () => dispatch(setModal(null));\n\n  return /*#__PURE__*/React.createElement(Card, {\n    key: item.id || item.email,\n    item: item,\n    appearance: 'clear',\n    component: elem.render(item, { ...props,\n      onAboutMore: value => {\n        console.log(value);\n        onJump('/detail', value);\n      }\n    }),\n    onLink: hideModal,\n    onEdit: hideModal,\n    onDelete: hideModal,\n    withoutChecked: true\n  });\n};\n\nexport const Query = memo(({\n  data,\n  loading,\n  search,\n  entity,\n  entities,\n  onChange,\n  onJump,\n  onSubmit\n}) => /*#__PURE__*/React.createElement(GlobalSearch, {\n  search: search,\n  loading: loading,\n  initialEntity: entity,\n  result: search && data && entity && data[entity === null || entity === void 0 ? void 0 : entity.value],\n  entities: (entities || []).map(elem => ({ ...elem,\n    render: item => /*#__PURE__*/React.createElement(CardWrapper, {\n      item: item,\n      elem: elem,\n      onJump: onJump\n    })\n  })),\n  onSubmit: onSubmit,\n  onChange: onChange\n}));\nexport const QuerySearch = memo(({\n  search,\n  entity,\n  entities,\n  setSearch,\n  onHide,\n  onChange,\n  onJump\n}) => {\n  const initialResult = [null, {\n    data: null,\n    loading: false,\n    refetch: null\n  }];\n  const [load, {\n    data,\n    loading,\n    refetch\n  }] = entity ? useLazyQuery(entity.query) : initialResult;\n\n  const onSubmit = value => {\n    const variables = {\n      search: value\n    };\n    if (setSearch) setSearch(value);\n\n    if (value) {\n      if (refetch) {\n        refetch(variables);\n      }\n\n      if (load) {\n        load({\n          variables\n        });\n      }\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(Query, {\n    data: data,\n    entity: entity,\n    search: search,\n    loading: loading,\n    entities: entities,\n    onHide: onHide,\n    onJump: onJump,\n    onChange: onChange,\n    onSubmit: onSubmit\n  });\n});\nexport default QuerySearch;","map":{"version":3,"sources":["/Users/malcore/Documents/workspace/freelance/atomic/atomic-frontend/components/QuerySearch/index.js"],"names":["React","memo","useDispatch","useLazyQuery","GlobalSearch","Card","setModal","useArticle","useProject","useUser","hooks","getUsers","getArticles","getProjects","CardWrapper","item","elem","onJump","props","value","dispatch","hideModal","id","email","render","onAboutMore","console","log","Query","data","loading","search","entity","entities","onChange","onSubmit","map","QuerySearch","setSearch","onHide","initialResult","refetch","load","query","variables"],"mappings":"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","sourcesContent":["import React, { memo } from 'react'\nimport { useDispatch } from 'react-redux'\nimport { useLazyQuery } from '@apollo/react-hooks'\n\nimport GlobalSearch from '../../atomic-ui/components/GlobalSearch'\n\nimport { Card } from '../../layouts/dashboard/content'\nimport { setModal } from '../../store/actions/modal'\nimport { useArticle } from '../../hooks/useArticle'\nimport { useProject } from '../../hooks/useProject'\nimport { useUser } from '../../hooks/useUser'\n\nconst hooks = {\n  getUsers: useUser,\n  // getCategories: useCategory\n  getArticles: useArticle,\n  getProjects: useProject\n  // getTickets: useTicket,\n  // getRoles: useRole\n}\n\nconst CardWrapper = ({ item, elem, onJump }) => {\n  const props = hooks[elem.value] ? hooks[elem.value]() : {}\n  const dispatch = useDispatch()\n\n  const hideModal = () => dispatch(setModal(null))\n\n  return (\n    <Card\n      key={item.id || item.email}\n      item={item}\n      appearance={'clear'}\n      component={elem.render(item, {\n        ...props,\n        onAboutMore: (value) => {\n            console.log(value)\n            onJump('/detail', value)\n        }\n      })}\n      onLink={hideModal}\n      onEdit={hideModal}\n      onDelete={hideModal}\n      withoutChecked\n    />\n  )\n}\n\nexport const Query = memo(\n  ({ data, loading, search, entity, entities, onChange, onJump, onSubmit }) => (\n    <GlobalSearch\n      search={search}\n      loading={loading}\n      initialEntity={entity}\n      result={search && data && entity && data[entity?.value]}\n      entities={(entities || []).map((elem) => ({\n        ...elem,\n        render: (item) => <CardWrapper item={item} elem={elem} onJump={onJump} />\n      }))}\n      onSubmit={onSubmit}\n      onChange={onChange}\n    />\n  )\n)\n\nexport const QuerySearch = memo(\n  ({ search, entity, entities, setSearch, onHide, onChange, onJump }) => {\n    const initialResult = [null, { data: null, loading: false, refetch: null }]\n    const [load, { data, loading, refetch }] = entity ? useLazyQuery(entity.query) : initialResult\n\n    const onSubmit = (value) => {\n      const variables = { search: value }\n\n      if (setSearch) setSearch(value)\n\n      if (value) {\n        if (refetch) {\n          refetch(variables)\n        }\n        if (load) {\n          load({ variables })\n        }\n      }\n    }\n\n    return (\n      <Query\n        data={data}\n        entity={entity}\n        search={search}\n        loading={loading}\n        entities={entities}\n        onHide={onHide}\n        onJump={onJump}\n        onChange={onChange}\n        onSubmit={onSubmit}\n      />\n    )\n  }\n)\n\nexport default QuerySearch\n"]},"metadata":{},"sourceType":"module"}