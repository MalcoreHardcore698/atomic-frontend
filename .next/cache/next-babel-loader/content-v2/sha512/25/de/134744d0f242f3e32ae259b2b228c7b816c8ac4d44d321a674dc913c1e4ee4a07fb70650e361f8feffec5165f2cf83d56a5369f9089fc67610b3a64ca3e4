{"ast":null,"code":"import React, { useMemo } from 'react';\nimport { useRouter } from 'next/router';\nimport { useSelector } from 'react-redux';\nimport styled, { css } from 'styled-components';\nimport Row from '../../atomic-ui/components/Row';\nimport Column from '../../atomic-ui/components/Column';\nimport Title from '../../atomic-ui/components/Title';\nimport Meta from '../../atomic-ui/components/Meta';\nimport More from '../../atomic-ui/components/More';\nimport Image from '../../atomic-ui/components/Image';\nimport { b64EncodeUnicode } from '../../atomic-ui/utils/functions';\nimport { Surface } from '../Styled';\nimport CardActions from '../CardActions';\nimport { onArticleDelete, onArticleEdit } from '../../store/helpers/article';\nimport { useHelper } from '../../hooks/useHelper';\nimport queries from '../../graphql/queries';\nimport config from '../../config';\nconst HOST_URL = config.get('host-url');\nexport const Wrap = styled(Surface).withConfig({\n  displayName: \"ArticleCard__Wrap\",\n  componentId: \"sc-17tznl7-0\"\n})([\"display:grid;grid-template-columns:1fr 2fr;height:inherit;& > span{display:flex;}\", \" @media only screen and (max-width:480px){display:flex;flex-direction:column;grid-gap:var(--default-gap);}\"], ({\n  layout\n}) => layout === 'column' && css([\"display:flex;flex-wrap:wrap;grid-gap:var(--default-gap);& > span{height:128px;}\"]));\nexport const Poster = styled(Image).withConfig({\n  displayName: \"ArticleCard__Poster\",\n  componentId: \"sc-17tznl7-1\"\n})([\"object-fit:cover;width:100%;height:100%;border-radius:var(--surface-border-radius);border:1px solid var(--ghost-color-background);\", \"\"], ({\n  layout\n}) => layout === 'column' && css([\"height:128px;\"]));\nexport const Header = styled(Row).withConfig({\n  displayName: \"ArticleCard__Header\",\n  componentId: \"sc-17tznl7-2\"\n})([\"justify-content:space-between;align-items:center;\"]);\nexport const Actions = styled(Row).withConfig({\n  displayName: \"ArticleCard__Actions\",\n  componentId: \"sc-17tznl7-3\"\n})([\"grid-gap:5px;height:100%;\"]);\nexport const Name = styled(Title).withConfig({\n  displayName: \"ArticleCard__Name\",\n  componentId: \"sc-17tznl7-4\"\n})([\"transition:opacity 150ms ease;\", \"\"], ({\n  onClick\n}) => onClick && css([\"cursor:pointer;&:hover{opacity:0.45;}\"]));\nexport const MoreButton = styled(More).withConfig({\n  displayName: \"ArticleCard__MoreButton\",\n  componentId: \"sc-17tznl7-5\"\n})([\"align-items:flex-end;flex-grow:100;\"]);\nexport const HTMLView = ({\n  content,\n  className\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: className,\n  dangerouslySetInnerHTML: {\n    __html: content\n  }\n});\nexport const ShortText = styled(HTMLView).withConfig({\n  displayName: \"ArticleCard__ShortText\",\n  componentId: \"sc-17tznl7-6\"\n})([\"display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;p{font-size:var(--font-size-m);font-weight:var(--font-weight-regular);color:var(--default-color-text);strong,b,i{font-style:normal;font-weight:inherit;}}\"]);\nexport const Card = ({\n  layout,\n  article,\n  preview,\n  checked,\n  appearance,\n  onLink,\n  onChecked,\n  onEdit,\n  onDelete,\n  withSocials\n}) => {\n  var _article$preview, _article$category;\n\n  const router = useRouter();\n  const recall = useHelper();\n  const user = useSelector(state => state.user);\n  const canEditStatus = useMemo(() => {\n    var _user$role;\n\n    return user && (user === null || user === void 0 ? void 0 : (_user$role = user.role) === null || _user$role === void 0 ? void 0 : _user$role.name) === 'ADMIN';\n  }, [user]);\n\n  const handleClick = async () => {\n    await router.push({\n      pathname: router.pathname,\n      query: {\n        article: b64EncodeUnicode(article.id)\n      }\n    }, undefined, {\n      shallow: true\n    });\n    if (onLink) onLink();\n  };\n\n  const handleEdit = () => {\n    recall(onArticleEdit, {\n      id: article.id,\n      canEditStatus,\n      mutation: queries.UPDATE_ARTICLE\n    })();\n    if (onEdit) onEdit();\n  };\n\n  const handleDelete = () => {\n    recall(onArticleDelete, {\n      id: article.id,\n      article,\n      mutation: queries.DELETE_ARTICLE\n    })();\n    if (onDelete) onDelete();\n  };\n\n  return /*#__PURE__*/React.createElement(Wrap, {\n    checked: checked,\n    appearance: appearance,\n    layout: layout\n  }, article.preview && /*#__PURE__*/React.createElement(Poster, {\n    src: (_article$preview = article.preview) === null || _article$preview === void 0 ? void 0 : _article$preview.path,\n    alt: article.title,\n    effect: 'opacity',\n    layout: layout\n  }), /*#__PURE__*/React.createElement(Column, {\n    style: {\n      gridGap: 5,\n      width: '100%',\n      gridColumn: !article.preview && '1 / 3'\n    }\n  }, /*#__PURE__*/React.createElement(Header, null, /*#__PURE__*/React.createElement(Meta, {\n    shareTitle: withSocials && (article === null || article === void 0 ? void 0 : article.title),\n    shareUrl: false && withSocials ? location.href : HOST_URL,\n    category: article === null || article === void 0 ? void 0 : (_article$category = article.category) === null || _article$category === void 0 ? void 0 : _article$category.name,\n    date: article === null || article === void 0 ? void 0 : article.createdAt,\n    short: true\n  }), /*#__PURE__*/React.createElement(CardActions, {\n    typeText: 'статью',\n    checked: checked,\n    onEdit: onEdit && handleEdit,\n    onDelete: onDelete && handleDelete,\n    onChecked: onChecked\n  })), /*#__PURE__*/React.createElement(Name, {\n    tag: 'h4',\n    onClick: handleClick\n  }, article.title), article.body && /*#__PURE__*/React.createElement(ShortText, {\n    content: article.body\n  }), !onChecked && !preview && /*#__PURE__*/React.createElement(MoreButton, {\n    onClick: onLink,\n    withButton: true\n  })));\n};\nCard.defaultProps = {\n  appearance: 'default'\n};\nexport default Card;","map":null,"metadata":{},"sourceType":"module"}